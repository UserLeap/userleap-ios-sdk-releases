(function(X){typeof define=="function"&&define.amd?define(X):X()})(function(){"use strict";var nc=Object.defineProperty;var rc=(X,be,Ae)=>be in X?nc(X,be,{enumerable:!0,configurable:!0,writable:!0,value:Ae}):X[be]=Ae;var se=(X,be,Ae)=>(rc(X,typeof be!="symbol"?be+"":be,Ae),Ae);let X;const be=new Uint8Array(16);function Ae(){if(!X&&(X=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!X))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return X(be)}const K=[];for(let e=0;e<256;++e)K.push((e+256).toString(16).slice(1));function wi(e,t=0){return(K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]).toLowerCase()}const An={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Ee(e,t,n){if(An.randomUUID&&!t&&!e)return An.randomUUID();e=e||{};const r=e.random||(e.rng||Ae)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=r[o];return t}return wi(r)}const We="ul-app";var k=(e=>(e.Caption="ul-caption",e.CardContainer="ul-card__container",e.CardMainContent="ul-card-main-content",e.Choice="choice",e.ChoiceCheckbox="select-checkbox",e.ChoiceGroup="ul-card__choices",e.ChoiceLabel="select-label",e.ChoiceLabelContainer="choice-label-container",e.ChoiceRadio="select-radio",e.ChoiceTextEntryContainer="choice-text-entry-container",e.ChoiceTextInput="choice-text-input",e.CloseButton="close-btn",e.CloseContainer="close-container",e.ConsentLegalNameInput="ul-consent-legal__name-input",e.CustomStyle="ul-custom-style",e.DesktopSuffix="--desktop",e.FadeInTransition="fade-in-transition",e.LikertNumber="likert-number",e.LikertSmiley="likert-smiley",e.LikertStar="likert-star",e.LoadingSpinner="ul-loading-spinner",e.LoadingSpinnerContainer="ul-loading-spinner-container",e.LoadingSpinnerFirst="first",e.LoadingSpinnerFourth="fourth",e.LoadingSpinnerSecond="second",e.LoadingSpinnerThird="third",e.MobileSuffix="--mobile",e.NPSNumber="nps-number",e.OpenTextInput="ul-card-text__input",e.QuestionHeader="ul-question",e.VideoCard="ul-card--video",e.CheckmarkButton="ul-button-checkmark",e.InactiveButton="ul-button-inactive",e.LeftAlignButton="ul-button-left-align",e.ButtonDisabled="sprig-button-disabled",e))(k||{});const Bt="#e6e6e6",nt="#bd282a",bi=500,xi=1030;var xe=(e=>(e.Closed="close.click",e.Complete="survey.completed",e.PageChange="page.change",e.API="api",e.Override="override",e))(xe||{}),O=(e=>(e.SDKReady="sdk.ready",e.SurveyAppeared="survey.appeared",e.SurveyClosed="survey.closed",e.SurveyDimensions="survey.dimensions",e.SurveyFadingOut="survey.fadingOut",e.SurveyHeight="survey.height",e.SurveyPresented="survey.presented",e.SurveyLifeCycle="survey.lifeCycle",e.SurveyWillClose="survey.willClose",e.SurveyWillPresent="survey.will.present",e.CloseSurveyOnOverlayClick="close.survey.overlayClick",e.VisitorIDUpdated="visitor.id.updated",e))(O||{}),On=(e=>(e.SurveyId="survey.id",e))(On||{});const Mn={SDK_READY:"sdk.ready",SURVEY_APPEARED:"survey.appeared",SURVEY_CLOSED:"survey.closed",SURVEY_DIMENSIONS:"survey.dimensions",SURVEY_FADING_OUT:"survey.fadingOut",SURVEY_HEIGHT:"survey.height",SURVEY_PRESENTED:"survey.presented",SURVEY_LIFE_CYCLE:"survey.lifeCycle",SURVEY_WILL_CLOSE:"survey.willClose",SURVEY_WILL_PRESENT:"survey.will.present",CLOSE_SURVEY_ON_OVERLAY_CLICK:"close.survey.overlayClick",VISITOR_ID_UPDATED:"visitor.id.updated",DATA:{DISMISS_REASONS:{API:"api",CLOSED:"close.click",COMPLETE:"survey.completed",PAGE_CHANGE:"page.change",OVERRIDE:"override"},SURVEY_ID:"survey.id"}};var re=(e=>(e.VerifyViewVersion="verify.view.version",e.CurrentQuestion="survey.question",e.ViewPrototypeClick="question.prototype.click",e.ViewAgreementClick="question.agreement.click",e.RecordedTaskStart="recorded.task.start",e.RecordedTaskPermissionScreen="recorded.task.permission.screen",e.SurveyComplete="survey.complete",e))(re||{}),Oe=(e=>(e.ViewVersion="view.version",e.QuestionId="qid",e.Props="props",e))(Oe||{}),ee=(e=>(e.Preview="sprig.previewKey",e.Credentials="userleap.ids",e.PageViews="userleap.pageviews",e))(ee||{});const Nn=()=>{try{return window.parent.Intercom}catch(e){return console.error(e),null}},Vn=[Object.freeze(Object.defineProperty({__proto__:null,enable:()=>{const e=Nn();!e||(e.ul_wasVisible&&e("update",{hide_default_launcher:!1}),delete e.ul_wasVisible)},disable:()=>{const e=Nn();!e||(e.ul_wasVisible=!!document.querySelector("iframe.intercom-launcher-frame"),e.ul_wasVisible&&e("update",{hide_default_launcher:!0}))}},Symbol.toStringTag,{value:"Module"}))];class Ft{static disable(){Vn.forEach(t=>t.disable())}static enable(){Vn.forEach(t=>t.enable())}}const Ci=1,Ge=e=>e instanceof HTMLElement,ki=e=>e instanceof HTMLInputElement,rt=e=>e instanceof HTMLTextAreaElement,Bn=(e,t,n)=>{const r=e.createElement("style");n&&(r.nonce=n),r.textContent=t,r.id=k.CustomStyle,e.head.appendChild(r)},Fn=e=>{const t=e.querySelector(`.${k.CardContainer}`);let n=600,r=0;if(t){n=t.scrollHeight;const o=getComputedStyle(t),i=parseFloat(o.marginTop)+parseFloat(o.marginBottom),s=parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth);r=i+s}return n+r+Ci},Si=e=>{const t=e.querySelector(`.${k.CardContainer}`);t&&(t.scrollTop=0)};var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Li(e){var t=e.default;if(typeof t=="function"){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}var $n={},vt={},it={};Object.defineProperty(it,"__esModule",{value:!0}),it.MemoryLeakError=void 0;class Ii extends Error{constructor(t,n,r){super(`Possible EventEmitter memory leak detected. ${r} ${n.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`),this.emitter=t,this.type=n,this.count=r,this.name="MaxListenersExceededWarning"}}it.MemoryLeakError=Ii,Object.defineProperty(vt,"__esModule",{value:!0}),vt.Emitter=void 0;const Ui=it;class _t{constructor(){this.events=new Map,this.maxListeners=_t.defaultMaxListeners,this.hasWarnedAboutPotentialMemoryLeak=!1}static listenerCount(t,n){return t.listenerCount(n)}_emitInternalEvent(t,n,r){this.emit(t,n,r)}_getListeners(t){return this.events.get(t)||[]}_removeListener(t,n){const r=t.indexOf(n);return r>-1&&t.splice(r,1),[]}_wrapOnceListener(t,n){const r=(...o)=>{this.removeListener(t,r),n.apply(this,o)};return r}setMaxListeners(t){return this.maxListeners=t,this}getMaxListeners(){return this.maxListeners}eventNames(){return Array.from(this.events.keys())}emit(t,...n){const r=this._getListeners(t);return r.forEach(o=>{o.apply(this,n)}),r.length>0}addListener(t,n){this._emitInternalEvent("newListener",t,n);const r=this._getListeners(t).concat(n);if(this.events.set(t,r),this.maxListeners>0&&this.listenerCount(t)>this.maxListeners&&!this.hasWarnedAboutPotentialMemoryLeak){this.hasWarnedAboutPotentialMemoryLeak=!0;const o=new Ui.MemoryLeakError(this,t,this.listenerCount(t));console.warn(o)}return this}on(t,n){return this.addListener(t,n)}once(t,n){return this.addListener(t,this._wrapOnceListener(t,n))}prependListener(t,n){const r=this._getListeners(t);if(r.length>0){const o=[n].concat(r);this.events.set(t,o)}else this.events.set(t,r.concat(n));return this}prependOnceListener(t,n){return this.prependListener(t,this._wrapOnceListener(t,n))}removeListener(t,n){const r=this._getListeners(t);return r.length>0&&(this._removeListener(r,n),this.events.set(t,r),this._emitInternalEvent("removeListener",t,n)),this}off(t,n){return this.removeListener(t,n)}removeAllListeners(t){return t?this.events.delete(t):this.events.clear(),this}listeners(t){return Array.from(this._getListeners(t))}listenerCount(t){return this._getListeners(t).length}rawListeners(t){return this.listeners(t)}}vt.Emitter=_t,_t.defaultMaxListeners=10,function(e){var t=ot&&ot.__createBinding||(Object.create?function(r,o,i,s){s===void 0&&(s=i);var a=Object.getOwnPropertyDescriptor(o,i);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(r,s,a)}:function(r,o,i,s){s===void 0&&(s=i),r[s]=o[i]}),n=ot&&ot.__exportStar||function(r,o){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,r,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(vt,e),n(it,e)}($n);const B=new $n.Emitter;var st=(e=>(e.BottomLeft="bottomLeft",e.BottomRight="bottomRight",e.Center="center",e.TopLeft="topLeft",e.TopRight="topRight",e))(st||{}),fe=(e=>(e.Error="x-ul-error",e.EnvironmentID="x-ul-environment-id",e.InstallationMethod="x-ul-installation-method",e.PartnerAnonymousId="x-ul-anonymous-id",e.Platform="userleap-platform",e.PreviewMode="x-ul-preview-mode",e.UserID="x-ul-user-id",e.VisitorID="x-ul-visitor-id",e))(fe||{}),Me=(e=>(e.Email="email",e.Link="link",e.Web="web",e))(Me||{}),Ne=(e=>(e.Npm="web-npm",e.Gtm="web-gtm",e.Segment="web-segment",e.SegmentAndroid="android-segment",e.SegmentReactNative="react-native-segment",e.SegmentIOS="ios-segment",e.Snippet="web-snippet",e))(Ne||{});const yt=e=>new Promise(t=>{setTimeout(()=>{t()},e)}),Ke=({"userleap-platform":e})=>e!==Me.Web,W=(e,t)=>{const n=t?k.MobileSuffix:k.DesktopSuffix;return[e+n,e]},me=(e,t)=>[e,`${e}__${t}`];class Pi{constructor(t){se(this,"payload");se(this,"promise");se(this,"reject",()=>{});se(this,"resolve",()=>{});this.payload=t,this.promise=new Promise((n,r)=>{this.reject=r,this.resolve=n})}resolveRequest(t){this.resolve(t)}}const Ti={RATELIMIT_RESET_DEFAULT:10};let Hn=!1,zn="",wt=!1,bt=[];const Di=e=>e._config&&e._config.installationMethod?e._config.installationMethod:e._gtm?Ne.Gtm:e._segment?Ne.Segment:Ne.Snippet,$t=(e="")=>{Hn=!0,zn=e};function at(e={}){const t={"Content-Type":"application/json","userleap-platform":Me.Web,"x-ul-sdk-version":"2.23.0",[fe.InstallationMethod]:Di(e)};if(e.envId&&(t[fe.EnvironmentID]=e.envId),e.token&&(t.Authorization="Bearer "+e.token),e.userId&&(t[fe.UserID]=e.userId),e.visitorId&&(t[fe.VisitorID]=e.visitorId),e.partnerAnonymousId&&(t[fe.PartnerAnonymousId]=e.partnerAnonymousId),e.mobileHeadersJSON){const n=JSON.parse(e.mobileHeadersJSON);Object.assign(t,n)}return e.locale&&(t["accept-language"]=e.locale),window.previewMode&&(t[fe.PreviewMode]="1"),t}const qn=async(e,t,n)=>{if(e)return{status:429};{const r=new Pi(n);return bt.push(r),r.promise}},he=async(e,t,n=0,r=!1,o=!1)=>{const i={url:e,options:t,attempt:n,shouldDropOnRateLimit:r};if(wt&&!o)return qn(r,o,i);const s={ok:!1,reportError:!1};if(Hn)return console.info(`UserLeap - ${zn}`),s;try{t.headers=Object.assign(at(),t.headers);const a=await fetch(e,t);if(a.status===429)if(!wt&&!r||o){wt=!0;const d=a.headers.has("ratelimit-reset")?Number(a.headers.get("ratelimit-reset")):Ti.RATELIMIT_RESET_DEFAULT;return await yt(d*1e3),he(e,t,0,r,!0)}else return qn(r,!1,i);if(wt=!1,bt.length&&(bt.map(c=>{const{url:d,options:l,attempt:m,shouldDropOnRateLimit:p}=c.payload;he(d,l,m,p).then(f=>{c.resolveRequest(f)})}),bt=[]),a.ok){if(a.status===249)return $t(),s;const c=await a.text();try{return c&&c!=="OK"&&(a.json=JSON.parse(c)),a}catch{return{ok:!1,reportError:!1,error:new Error(`failed parsing response json for ${e} - ${c}`)}}}return a}catch(a){const c=n+1;return c>5?{ok:!1,reportError:!1,error:a}:(await yt(Math.pow(2,n)*1e3),he(e,t,c))}};var Wn={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(ot,function(){var n=function(i,s){if(s=s||{},typeof i!="function")throw new o("fetch must be a function");if(typeof s!="object")throw new o("defaults must be an object");if(s.retries!==void 0&&!r(s.retries))throw new o("retries must be a positive integer");if(s.retryDelay!==void 0&&!r(s.retryDelay)&&typeof s.retryDelay!="function")throw new o("retryDelay must be a positive integer or a function returning a positive integer");if(s.retryOn!==void 0&&!Array.isArray(s.retryOn)&&typeof s.retryOn!="function")throw new o("retryOn property expects an array or function");var a={retries:3,retryDelay:1e3,retryOn:[]};return s=Object.assign(a,s),function(d,l){var m=s.retries,p=s.retryDelay,f=s.retryOn;if(l&&l.retries!==void 0)if(r(l.retries))m=l.retries;else throw new o("retries must be a positive integer");if(l&&l.retryDelay!==void 0)if(r(l.retryDelay)||typeof l.retryDelay=="function")p=l.retryDelay;else throw new o("retryDelay must be a positive integer or a function returning a positive integer");if(l&&l.retryOn)if(Array.isArray(l.retryOn)||typeof l.retryOn=="function")f=l.retryOn;else throw new o("retryOn property expects an array or function");return new Promise(function(h,g){var v=function(_){var C=typeof Request<"u"&&d instanceof Request?d.clone():d;i(C,l).then(function(b){if(Array.isArray(f)&&f.indexOf(b.status)===-1)h(b);else if(typeof f=="function")try{return Promise.resolve(f(_,null,b)).then(function(E){E?w(_,null,b):h(b)}).catch(g)}catch(E){g(E)}else _<m?w(_,null,b):h(b)}).catch(function(b){if(typeof f=="function")try{Promise.resolve(f(_,b,null)).then(function(E){E?w(_,b,null):g(b)}).catch(function(E){g(E)})}catch(E){g(E)}else _<m?w(_,b,null):g(b)})};function w(_,C,b){var E=typeof p=="function"?p(_,C,b):p;setTimeout(function(){v(++_)},E)}v(0)})}};function r(i){return Number.isInteger(i)&&i>=0}function o(i){this.name="ArgumentError",this.message=i}return n})})(Wn);const Ri=Wn.exports;class ji{constructor(t){se(this,"awaitingResolvers",[]);se(this,"activeCount",0);this.capacity=t}async acquire(){if(this.activeCount<this.capacity){this.activeCount++;return}return new Promise(t=>{this.awaitingResolvers.push(t)})}release(){const t=this.awaitingResolvers.shift();t&&this.activeCount<=this.capacity?t():this.activeCount--}async execute(t){try{return await this.acquire(),await t()}finally{this.release()}}setLimit(t){this.capacity=t}}const Gn=new ji(2),Ai=e=>Gn.setLimit(e),Oi=Ri(fetch),Mi=async(e,t=3)=>Gn.execute(async()=>{const r=(await Oi(e.uploadUrl,{body:e.data,method:"PUT",retries:t,retryDelay:o=>Math.pow(2,o)*1e3})).headers.get("ETag");if(!r)throw new Error(`Upload response did not include etag for upload ${e.uploadId}, part ${e.chunkIndex}`);return r}),Ni=async({apiUrl:e,surveyId:t,uploadId:n,etags:r,headers:o,responseGroupUuid:i,replayDuration:s})=>he(`${e}/sdk/1/completeSessionReplay`,{method:"POST",body:JSON.stringify({etags:r,uploadId:n,responseGroupUuid:i,surveyId:t,replayDuration:s}),headers:o}),Vi=(e,t)=>t.some(n=>e instanceof n);let Kn,Zn;function Bi(){return Kn||(Kn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Fi(){return Zn||(Zn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Yn=new WeakMap,Ht=new WeakMap,Qn=new WeakMap,zt=new WeakMap,qt=new WeakMap;function $i(e){const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{n(Le(e.result)),o()},s=()=>{r(e.error),o()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(n=>{n instanceof IDBCursor&&Yn.set(n,e)}).catch(()=>{}),qt.set(t,e),t}function Hi(e){if(Ht.has(e))return;const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{n(),o()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});Ht.set(e,t)}let Wt={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Ht.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Qn.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Le(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function zi(e){Wt=e(Wt)}function qi(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Gt(this),t,...n);return Qn.set(r,t.sort?t.sort():[t]),Le(r)}:Fi().includes(e)?function(...t){return e.apply(Gt(this),t),Le(Yn.get(this))}:function(...t){return Le(e.apply(Gt(this),t))}}function Wi(e){return typeof e=="function"?qi(e):(e instanceof IDBTransaction&&Hi(e),Vi(e,Bi())?new Proxy(e,Wt):e)}function Le(e){if(e instanceof IDBRequest)return $i(e);if(zt.has(e))return zt.get(e);const t=Wi(e);return t!==e&&(zt.set(e,t),qt.set(t,e)),t}const Gt=e=>qt.get(e);function Gi(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=Le(s);return r&&s.addEventListener("upgradeneeded",c=>{r(Le(s.result),c.oldVersion,c.newVersion,Le(s.transaction),c)}),n&&s.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),o&&c.addEventListener("versionchange",d=>o(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Ki=["get","getKey","getAll","getAllKeys","count"],Zi=["put","add","delete","clear"],Kt=new Map;function Jn(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Kt.get(t))return Kt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=Zi.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||Ki.includes(n)))return;const i=async function(s,...a){const c=this.transaction(s,o?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),o&&c.done]))[0]};return Kt.set(t,i),i}zi(e=>({...e,get:(t,n,r)=>Jn(t,n)||e.get(t,n,r),has:(t,n)=>!!Jn(t,n)||e.has(t,n)}));var ge=(e=>(e.ReadyForUpload="ReadyForUpload",e.UploadComplete="UploadComplete",e))(ge||{}),lt=(e=>(e.After="after",e.Before="before",e.BeforeAndAfter="beforeAndAfter",e))(lt||{});const Zt="sprig.sessionId",Xn="sprig.disableReplayRecording",T={name:"sprig.replay",version:2,tables:{events:{name:"events",indices:{session_timestamp:"session_timestamp",timestamp:"timestamp"}},chunkUploads:{name:"chunkUploads",indices:{timestamp:"timestamp",upload_status:"upload_status",session_status:"session_status",session_status_upload:"session_status_upload"}},pendingCaptures:{name:"pendingCaptures",indices:{timestamp:"timestamp",session_targetTimestamp:"session_targetTimestamp"}}}},Yi=()=>{sessionStorage.setItem(Xn,"disabled")},er=()=>!!sessionStorage.getItem(Xn),Y=(()=>{const e=sessionStorage.getItem(Zt);return e?(sessionStorage.removeItem(Zt),e):Ee()})();window.addEventListener("beforeunload",()=>{sessionStorage.setItem(Zt,Y)});const Q=(async()=>Gi(T.name,T.version,{upgrade:(e,t)=>{if(!t){const n=e.createObjectStore(T.tables.events.name,{keyPath:"uuid"});n.createIndex(T.tables.events.indices.session_timestamp,["sessionId","timestamp"]),n.createIndex(T.tables.events.indices.timestamp,"timestamp");const r=e.createObjectStore(T.tables.chunkUploads.name,{keyPath:"uuid"});r.createIndex(T.tables.chunkUploads.indices.session_status,["sessionId","status"]),r.createIndex(T.tables.chunkUploads.indices.upload_status,["uploadId","status"]),r.createIndex(T.tables.chunkUploads.indices.session_status_upload,["sessionId","status","uploadId"]),r.createIndex(T.tables.chunkUploads.indices.timestamp,"timestamp")}if(!t||t<2){const n=e.createObjectStore(T.tables.pendingCaptures.name,{keyPath:"uuid"});n.createIndex(T.tables.pendingCaptures.indices.session_targetTimestamp,["sessionId","targetTimestamp"]),n.createIndex(T.tables.pendingCaptures.indices.timestamp,"timestamp")}}}))(),Qi=async()=>{const e=await Q;return Promise.all([e.clear(T.tables.events.name),e.clear(T.tables.chunkUploads.name),e.clear(T.tables.pendingCaptures.name)])},Ji=async e=>{const n=(await Q).transaction(T.tables.events.name,"readwrite");return Promise.all([...e.map(r=>n.store.put({...r,sessionId:r.sessionId||Y})),n.done])},Xi=async e=>await(await Q).getAllFromIndex(T.tables.events.name,T.tables.events.indices.session_timestamp,IDBKeyRange.bound([Y,e],[Y,Number.MAX_VALUE])),es=async(e,t)=>(await Q).getAllKeysFromIndex(t,"timestamp",IDBKeyRange.upperBound(e-1)),Yt=async(e,t)=>{if(!t||!t.length)return;const r=(await Q).transaction(e,"readwrite");return Promise.all([...t.map(async o=>{try{await r.store.delete(o)}catch{}}),r.done])},Qt=async(e,t)=>{const n=await es(e,t);await Yt(t,n)},ts=async e=>{await Qt(e,T.tables.events.name)},ns=async e=>{await Qt(e,T.tables.chunkUploads.name)},rs=async e=>{await Qt(e,T.tables.pendingCaptures.name)},os=async()=>{const e=await Q,t=await e.getAllKeysFromIndex(T.tables.events.name,T.tables.events.indices.session_timestamp,IDBKeyRange.bound([Y,Number.MIN_VALUE],[Y,Number.MAX_VALUE])),n=await e.getAllKeysFromIndex(T.tables.pendingCaptures.name,T.tables.pendingCaptures.indices.session_targetTimestamp,IDBKeyRange.bound([Y,Number.MIN_VALUE],[Y,Number.MAX_VALUE]));await Promise.all([Yt(T.tables.events.name,t),Yt(T.tables.pendingCaptures.name,n)])},is=async e=>(await Q).put(T.tables.chunkUploads.name,{...e,sessionId:e.sessionId||Y,etag:null}),ss=async(e,t)=>{const n=await Q,r=await n.get(T.tables.chunkUploads.name,e);if(r)return n.put(T.tables.chunkUploads.name,{...r,data:null,etag:t,status:ge.UploadComplete})},as=async e=>await(await Q).countFromIndex(T.tables.chunkUploads.name,T.tables.chunkUploads.indices.upload_status,IDBKeyRange.bound([e,ge.ReadyForUpload],[e,ge.ReadyForUpload]))>0,ls=async()=>{const n=(await(await Q).getAllFromIndex(T.tables.chunkUploads.name,T.tables.chunkUploads.indices.session_status,IDBKeyRange.bound([Y,ge.UploadComplete],[Y,ge.UploadComplete]))).reduce((i,s)=>(i.add(s.uploadId),i),new Set),r=Array.from(n),o=await Promise.all(r.map(async i=>as(i)));return r.filter((i,s)=>!o[s])},cs=async({status:e,uploadId:t})=>(await Q).getAllKeysFromIndex(T.tables.chunkUploads.name,t?T.tables.chunkUploads.indices.upload_status:T.tables.chunkUploads.indices.session_status,IDBKeyRange.bound([t||Y,e],[t||Y,e])),ds=async e=>(await Q).get(T.tables.chunkUploads.name,e),us=async e=>(await Q).getAllFromIndex(T.tables.chunkUploads.name,T.tables.chunkUploads.indices.upload_status,IDBKeyRange.bound([e,ge.UploadComplete],[e,ge.UploadComplete])),ps=async e=>(await Q).put(T.tables.pendingCaptures.name,{...e,sessionId:e.sessionId||Y}),fs=async e=>(await Q).delete(T.tables.pendingCaptures.name,e),ms=async()=>await(await Q).getAllFromIndex(T.tables.pendingCaptures.name,T.tables.pendingCaptures.indices.session_targetTimestamp,IDBKeyRange.bound([Y,Number.MIN_VALUE],[Y,Date.now()])),hs=async(e,t,n)=>new Promise((r,o)=>{const i=e.createElement("script");i.src=t,i.onload=r,i.onerror=o,n&&(i.nonce=n),e.head.appendChild(i)});let tr=5e3;const gs=async(e,t,n,r=2,o)=>{if(!t)return;o!=null&&o.minDuration&&(tr=o.minDuration),Ai(r),ks(),ys(t),ws();const i=window;i.rrwebRecord||await hs(e,"https://cdn.sprig.com/dependencies/rrweb-record-2.0.0-alpha.6.min.js",n);const s=i.rrwebRecord;if(!s)return;let a=!0;s({checkoutEveryNms:20*1e3,sampling:{input:"last",scroll:250,media:800},emit:(c,d)=>{if(er())return;const l=a||!!d;a=!1,vs({uuid:Ee(),event:JSON.stringify(c),isValidStart:l,timestamp:Date.now()})},...o})};let Jt=!1,Xt=[];const vs=e=>{Xt.push(e),Jt||_s()},_s=()=>{Jt=!0,setTimeout(async()=>{if(er())return;const e=Xt;Xt=[],Jt=!1;try{await Ji(e)}catch(t){nr(t)}},500)},nr=async e=>{var n,r;Yi();const t=(r=(n=window.navigator)==null?void 0:n.storage)!=null&&r.estimate?await window.navigator.storage.estimate():{};await Qi(),e instanceof Error&&window.UserLeap.reportError("Error storing replay data",e,t)},ys=(e=6*60,t=30*60,n=4*60)=>{setInterval(async()=>{const r=Date.now();await Promise.all([ts(r-e*1e3),ns(r-t*1e3),rs(r-n*1e3)])},30*1e3)},ws=async(e=5)=>{setInterval(Is,e*1e3)},bs=async e=>{const t=await Xi(Date.now()-e*1e3),n=t.findIndex(r=>r.isValidStart);return n<0?[]:t.slice(n)},xs=async e=>{const t=`[${e.map(o=>o.event).join(",")}]`,r=new TextEncoder().encode(t);try{if(window.CompressionStream===void 0)return r;const o=new CompressionStream("gzip"),i=o.writable.getWriter();return i.write(r),i.close(),new Uint8Array(await new Response(o.readable).arrayBuffer())}catch(o){return o instanceof Error&&window.UserLeap.reportError("Error compressing replay for upload",o),r}},Cs=(e,t,n)=>{const r=e.length,o=t*1024*1024,i=Math.ceil(r/n),s=Math.max(o,i),a=[];let c=0;for(;c<r;)a.push(e.slice(c,c+s)),c+=s;return a},rr=async e=>{await Promise.all(e.map(async t=>{const n=await ds(t),r=await Mi(n);await ss(n.uuid,r)}))},or=async e=>{const t=await us(e);if(!t.length)return;t.sort((o,i)=>o.chunkIndex-i.chunkIndex);const n=t.map(o=>({ETag:o.etag,PartNumber:o.chunkIndex})).filter(o=>o.ETag!==null),r=t[0];await Ni({apiUrl:r.apiUrl,surveyId:r.surveyId,uploadId:e,responseGroupUuid:r.responseGroupId,etags:n,headers:r.completeUploadHeaders,replayDuration:r.replayDuration})},ks=async()=>{const e=await cs({status:ge.ReadyForUpload});if(!e.length)return;await rr(e);const t=await ls();await Promise.all(t.map(n=>or(n)))},Ss=async(e,t)=>{await rr(t),await Promise.all(e.map(n=>or(n)))},ir=async e=>{const{surveyId:t,responseGroupId:n,visitorId:r,apiUrl:o,completeUploadHeaders:i,replayParams:s}=e;if(await Es(),s.replayDurationType===lt.After||s.replayDurationType===lt.BeforeAndAfter)return Ls(e);const a=await bs(s.replayDurationSeconds);if(!a.length)return;const c=a[a.length-1].timestamp-a[0].timestamp;if(c<=tr)return;const d=await xs(a),l=Cs(d,s.minimumChunkSizeMb,s.signedUrls.length),m=Date.now();let p=[];try{p=await Promise.all(l.map(async(f,h)=>{const g=Ee();return await is({uuid:g,chunkIndex:h+1,totalChunks:l.length,timestamp:m,surveyId:t,responseGroupId:n,status:ge.ReadyForUpload,data:f,visitorId:r,uploadId:s.uploadId,uploadUrl:s.signedUrls[h].url,apiUrl:o,completeUploadHeaders:i,replayDuration:c}),g}))}catch(f){nr(f);return}await Ss([s.uploadId],p)};let xt=null;const Es=async()=>{xt&&await xt},sr=async()=>(xt=os(),xt),Ls=async e=>{const t={...e,replayParams:{...e.replayParams}};e.replayParams.replayDurationType===lt.BeforeAndAfter&&(t.replayParams.replayDurationSeconds*=2),t.replayParams.replayDurationType=lt.Before;const n=Date.now()+e.replayParams.replayDurationSeconds*1e3;return ps({uuid:Ee(),targetTimestamp:n,timestamp:Date.now(),captureParams:t})},Is=async()=>{const e=await ms();await Promise.all(e.map(async t=>{await fs(t.uuid),await ir(t.captureParams)}))};var ct,L,ar,Ze,Ve,lr,cr,dr,Ct={},ur=[],Us=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Ce(e,t){for(var n in t)e[n]=t[n];return e}function pr(e){var t=e.parentNode;t&&t.removeChild(e)}function q(e,t,n){var r,o,i,s={};for(i in t)i=="key"?r=t[i]:i=="ref"?o=t[i]:s[i]=t[i];if(arguments.length>2&&(s.children=arguments.length>3?ct.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)s[i]===void 0&&(s[i]=e.defaultProps[i]);return dt(e,s,r,o,null)}function dt(e,t,n,r,o){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o==null?++ar:o};return o==null&&L.vnode!=null&&L.vnode(i),i}function fr(){return{current:null}}function ae(e){return e.children}function Ps(e,t,n,r,o){var i;for(i in n)i==="children"||i==="key"||i in t||kt(e,i,null,n[i],r);for(i in t)o&&typeof t[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||n[i]===t[i]||kt(e,i,t[i],n[i],r)}function mr(e,t,n){t[0]==="-"?e.setProperty(t,n==null?"":n):e[t]=n==null?"":typeof n!="number"||Us.test(t)?n:n+"px"}function kt(e,t,n,r,o){var i;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||mr(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||mr(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r||e.addEventListener(t,i?gr:hr,i):e.removeEventListener(t,i?gr:hr,i);else if(t!=="dangerouslySetInnerHTML"){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n==null?"":n;break e}catch{}typeof n=="function"||(n==null||n===!1&&t.indexOf("-")==-1?e.removeAttribute(t):e.setAttribute(t,n))}}function hr(e){Ze=!0;try{return this.l[e.type+!1](L.event?L.event(e):e)}finally{Ze=!1}}function gr(e){Ze=!0;try{return this.l[e.type+!0](L.event?L.event(e):e)}finally{Ze=!1}}function le(e,t){this.props=e,this.context=t}function ut(e,t){if(t==null)return e.__?ut(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?ut(e):null}function vr(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return vr(e)}}function Ts(e){Ze?setTimeout(e):cr(e)}function en(e){(!e.__d&&(e.__d=!0)&&Ve.push(e)&&!St.__r++||lr!==L.debounceRendering)&&((lr=L.debounceRendering)||Ts)(St)}function St(){var e,t,n,r,o,i,s,a;for(Ve.sort(function(c,d){return c.__v.__b-d.__v.__b});e=Ve.shift();)e.__d&&(t=Ve.length,r=void 0,o=void 0,s=(i=(n=e).__v).__e,(a=n.__P)&&(r=[],(o=Ce({},i)).__v=i.__v+1,tn(a,i,o,n.__n,a.ownerSVGElement!==void 0,i.__h!=null?[s]:null,r,s==null?ut(i):s,i.__h),xr(r,i),i.__e!=s&&vr(i)),Ve.length>t&&Ve.sort(function(c,d){return c.__v.__b-d.__v.__b}));St.__r=0}function _r(e,t,n,r,o,i,s,a,c,d){var l,m,p,f,h,g,v,w=r&&r.__k||ur,_=w.length;for(n.__k=[],l=0;l<t.length;l++)if((f=n.__k[l]=(f=t[l])==null||typeof f=="boolean"?null:typeof f=="string"||typeof f=="number"||typeof f=="bigint"?dt(null,f,null,null,f):Array.isArray(f)?dt(ae,{children:f},null,null,null):f.__b>0?dt(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)!=null){if(f.__=n,f.__b=n.__b+1,(p=w[l])===null||p&&f.key==p.key&&f.type===p.type)w[l]=void 0;else for(m=0;m<_;m++){if((p=w[m])&&f.key==p.key&&f.type===p.type){w[m]=void 0;break}p=null}tn(e,f,p=p||Ct,o,i,s,a,c,d),h=f.__e,(m=f.ref)&&p.ref!=m&&(v||(v=[]),p.ref&&v.push(p.ref,null,f),v.push(m,f.__c||h,f)),h!=null?(g==null&&(g=h),typeof f.type=="function"&&f.__k===p.__k?f.__d=c=yr(f,c,e):c=wr(e,f,p,w,h,c),typeof n.type=="function"&&(n.__d=c)):c&&p.__e==c&&c.parentNode!=e&&(c=ut(p))}for(n.__e=g,l=_;l--;)w[l]!=null&&(typeof n.type=="function"&&w[l].__e!=null&&w[l].__e==n.__d&&(n.__d=br(r).nextSibling),kr(w[l],w[l]));if(v)for(l=0;l<v.length;l++)Cr(v[l],v[++l],v[++l])}function yr(e,t,n){for(var r,o=e.__k,i=0;o&&i<o.length;i++)(r=o[i])&&(r.__=e,t=typeof r.type=="function"?yr(r,t,n):wr(n,r,r,o,r.__e,t));return t}function ke(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){ke(n,t)}):t.push(e)),t}function wr(e,t,n,r,o,i){var s,a,c;if(t.__d!==void 0)s=t.__d,t.__d=void 0;else if(n==null||o!=i||o.parentNode==null)e:if(i==null||i.parentNode!==e)e.appendChild(o),s=null;else{for(a=i,c=0;(a=a.nextSibling)&&c<r.length;c+=1)if(a==o)break e;e.insertBefore(o,i),s=i}return s!==void 0?s:o.nextSibling}function br(e){var t,n,r;if(e.type==null||typeof e.type=="string")return e.__e;if(e.__k){for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=br(n)))return r}return null}function tn(e,t,n,r,o,i,s,a,c){var d,l,m,p,f,h,g,v,w,_,C,b,E,A,x,D=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,a=t.__e=n.__e,t.__h=null,i=[a]),(d=L.__b)&&d(t);try{e:if(typeof D=="function"){if(v=t.props,w=(d=D.contextType)&&r[d.__c],_=d?w?w.props.value:d.__:r,n.__c?g=(l=t.__c=n.__c).__=l.__E:("prototype"in D&&D.prototype.render?t.__c=l=new D(v,_):(t.__c=l=new le(v,_),l.constructor=D,l.render=Rs),w&&w.sub(l),l.props=v,l.state||(l.state={}),l.context=_,l.__n=r,m=l.__d=!0,l.__h=[],l._sb=[]),l.__s==null&&(l.__s=l.state),D.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=Ce({},l.__s)),Ce(l.__s,D.getDerivedStateFromProps(v,l.__s))),p=l.props,f=l.state,l.__v=t,m)D.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(D.getDerivedStateFromProps==null&&v!==p&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(v,_),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(v,l.__s,_)===!1||t.__v===n.__v){for(t.__v!==n.__v&&(l.props=v,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(P){P&&(P.__=t)}),C=0;C<l._sb.length;C++)l.__h.push(l._sb[C]);l._sb=[],l.__h.length&&s.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(v,l.__s,_),l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(p,f,h)})}if(l.context=_,l.props=v,l.__P=e,b=L.__r,E=0,"prototype"in D&&D.prototype.render){for(l.state=l.__s,l.__d=!1,b&&b(t),d=l.render(l.props,l.state,l.context),A=0;A<l._sb.length;A++)l.__h.push(l._sb[A]);l._sb=[]}else do l.__d=!1,b&&b(t),d=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++E<25);l.state=l.__s,l.getChildContext!=null&&(r=Ce(Ce({},r),l.getChildContext())),m||l.getSnapshotBeforeUpdate==null||(h=l.getSnapshotBeforeUpdate(p,f)),x=d!=null&&d.type===ae&&d.key==null?d.props.children:d,_r(e,Array.isArray(x)?x:[x],t,n,r,o,i,s,a,c),l.base=t.__e,t.__h=null,l.__h.length&&s.push(l),g&&(l.__E=l.__=null),l.__e=!1}else i==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Ds(n.__e,t,n,r,o,i,s,c);(d=L.diffed)&&d(t)}catch(P){t.__v=null,(c||i!=null)&&(t.__e=a,t.__h=!!c,i[i.indexOf(a)]=null),L.__e(P,t,n)}}function xr(e,t){L.__c&&L.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){L.__e(r,n.__v)}})}function Ds(e,t,n,r,o,i,s,a){var c,d,l,m=n.props,p=t.props,f=t.type,h=0;if(f==="svg"&&(o=!0),i!=null){for(;h<i.length;h++)if((c=i[h])&&"setAttribute"in c==!!f&&(f?c.localName===f:c.nodeType===3)){e=c,i[h]=null;break}}if(e==null){if(f===null)return document.createTextNode(p);e=o?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,p.is&&p),i=null,a=!1}if(f===null)m===p||a&&e.data===p||(e.data=p);else{if(i=i&&ct.call(e.childNodes),d=(m=n.props||Ct).dangerouslySetInnerHTML,l=p.dangerouslySetInnerHTML,!a){if(i!=null)for(m={},h=0;h<e.attributes.length;h++)m[e.attributes[h].name]=e.attributes[h].value;(l||d)&&(l&&(d&&l.__html==d.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(Ps(e,p,m,o,a),l)t.__k=[];else if(h=t.props.children,_r(e,Array.isArray(h)?h:[h],t,n,r,o&&f!=="foreignObject",i,s,i?i[0]:n.__k&&ut(n,0),a),i!=null)for(h=i.length;h--;)i[h]!=null&&pr(i[h]);a||("value"in p&&(h=p.value)!==void 0&&(h!==e.value||f==="progress"&&!h||f==="option"&&h!==m.value)&&kt(e,"value",h,m.value,!1),"checked"in p&&(h=p.checked)!==void 0&&h!==e.checked&&kt(e,"checked",h,m.checked,!1))}return e}function Cr(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){L.__e(r,n)}}function kr(e,t,n){var r,o;if(L.unmount&&L.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Cr(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){L.__e(i,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&kr(r[o],t,n||typeof e.type!="function");n||e.__e==null||pr(e.__e),e.__=e.__e=e.__d=void 0}function Rs(e,t,n){return this.constructor(e,n)}function Ye(e,t,n){var r,o,i;L.__&&L.__(e,t),o=(r=typeof n=="function")?null:n&&n.__k||t.__k,i=[],tn(t,e=(!r&&n||t).__k=q(ae,null,[e]),o||Ct,Ct,t.ownerSVGElement!==void 0,!r&&n?[n]:o?null:t.firstChild?ct.call(t.childNodes):null,i,!r&&n?n:o?o.__e:t.firstChild,r),xr(i,e)}function Sr(e,t){Ye(e,t,Sr)}function js(e,t,n){var r,o,i,s=Ce({},e.props);for(i in t)i=="key"?r=t[i]:i=="ref"?o=t[i]:s[i]=t[i];return arguments.length>2&&(s.children=arguments.length>3?ct.call(arguments,2):n),dt(e.type,s,r||e.key,o||e.ref,null)}function Er(e,t){var n={__c:t="__cC"+dr++,__:e,Consumer:function(r,o){return r.children(o)},Provider:function(r){var o,i;return this.getChildContext||(o=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&o.some(function(a){a.__e=!0,en(a)})},this.sub=function(s){o.push(s);var a=s.componentWillUnmount;s.componentWillUnmount=function(){o.splice(o.indexOf(s),1),a&&a.call(s)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}ct=ur.slice,L={__e:function(e,t,n,r){for(var o,i,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&i.getDerivedStateFromError!=null&&(o.setState(i.getDerivedStateFromError(e)),s=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,r||{}),s=o.__d),s)return o.__E=o}catch(a){e=a}throw e}},ar=0,Ze=!1,le.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ce({},this.state),typeof e=="function"&&(e=e(Ce({},n),this.props)),e&&Ce(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),en(this))},le.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),en(this))},le.prototype.render=ae,Ve=[],cr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,St.__r=0,dr=0;var I=(e=>(e.ConsentLegal="consentlegal",e.Likert="likert",e.MultipleChoice="multiplechoice",e.MultipleSelect="multipleselect",e.NPS="nps",e.Open="open",e.RecordedTask="recordedtask",e.TextUrlPrompt="texturlprompt",e.Thanks="thanks",e.Uploading="uploading",e.VideoVoice="videovoice",e))(I||{}),Be=(e=>(e.Answered="answered",e.Equal="eq",e.NotEqual="neq",e.Skipped="skipped",e.LessThan="lt",e.LessThanOrEqual="lte",e.GivenUp="given_up",e.GreaterThan="gt",e.GreaterThanOrEqual="gte",e.ListAll="list_all",e.ListAtLeastOne="list_alo",e.ListExact="list_exact",e))(Be||{}),Qe=(e=>(e.Camera="camera",e.Microphone="microphone",e.Screen="screen",e))(Qe||{}),oe=(e=>(e.AvPermission="av_permission",e.ScreenPermission="screen_permission",e.StartTask="start_task",e.CompleteTask="complete_task",e))(oe||{}),Fe=(e=>(e.Number="number",e.Smiley="smiley",e.Star="star",e))(Fe||{}),ce=(e=>(e.Video="video",e.Audio="audio",e.Screen="screen",e))(ce||{}),J=(e=>(e.PermissionStatus="permission.status",e.AvPermission="av.permission",e.ScreenPermission="screen.permission",e.BeginRecording="begin.recording",e.StartTask="start.task",e.FinishTask="finish.task",e))(J||{}),de=(e=>(e.Abandoned="abandoned",e.GivenUp="given.up",e.Completed="completed",e))(de||{}),N=(e=>(e.ScreenPermissionRequested="screen.permission.requested",e.PermissionDescriptors="permission.descriptors",e.PermissionStatusCallback="permission.status.callback",e.StreamReadyCallback="stream.ready.callback",e.StreamCanceledCallback="stream.canceled.callback",e.TaskCompleteCallback="task.complete.callback",e.TaskResponse="task.response",e.TaskStatus="task.status",e.RecordingMediaTypes="recording.media.types",e.StartRecordingCallback="start.recording.callback",e.PassthroughData="passthrough.data",e.CurrentIndex="current.index",e.UploadCallback="upload.callback",e.ProgressCallback="progress.callback",e.BeginCallback="begin.callback",e))(N||{});const Lr=e=>{let t;const n=new Set,r=(c,d)=>{const l=typeof c=="function"?c(t):c;if(!Object.is(l,t)){const m=t;t=(d!=null?d:typeof l!="object")?l:Object.assign({},t,l),n.forEach(p=>p(t,m))}},o=()=>t,a={setState:r,getState:o,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return t=e(r,o,a),a},As=e=>e?Lr(e):Lr;var Ie,H,nn,Ir,Je=0,Ur=[],Et=[],Pr=L.__b,Tr=L.__r,Dr=L.diffed,Rr=L.__c,jr=L.unmount;function $e(e,t){L.__h&&L.__h(H,e,Je||t),Je=0;var n=H.__H||(H.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Et}),n.__[e]}function Z(e){return Je=1,rn(Br,e)}function rn(e,t,n){var r=$e(Ie++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Br(void 0,t),function(i){var s=r.__N?r.__N[0]:r.__[0],a=r.t(s,i);s!==a&&(r.__N=[a,r.__[1]],r.__c.setState({}))}],r.__c=H,!H.u)){H.u=!0;var o=H.shouldComponentUpdate;H.shouldComponentUpdate=function(i,s,a){if(!r.__c.__H)return!0;var c=r.__c.__H.__.filter(function(l){return l.__c});if(c.every(function(l){return!l.__N}))return!o||o.call(this,i,s,a);var d=!1;return c.forEach(function(l){if(l.__N){var m=l.__[0];l.__=l.__N,l.__N=void 0,m!==l.__[0]&&(d=!0)}}),!(!d&&r.__c.props===i)&&(!o||o.call(this,i,s,a))}}return r.__N||r.__}function ie(e,t){var n=$e(Ie++,3);!L.__s&&an(n.__H,t)&&(n.__=e,n.i=t,H.__H.__h.push(n))}function pt(e,t){var n=$e(Ie++,4);!L.__s&&an(n.__H,t)&&(n.__=e,n.i=t,H.__h.push(n))}function Ue(e){return Je=5,Lt(function(){return{current:e}},[])}function Ar(e,t,n){Je=6,pt(function(){return typeof e=="function"?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},n==null?n:n.concat(e))}function Lt(e,t){var n=$e(Ie++,7);return an(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Or(e,t){return Je=8,Lt(function(){return e},t)}function Mr(e){var t=H.context[e.__c],n=$e(Ie++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(H)),t.props.value):e.__}function on(e,t){L.useDebugValue&&L.useDebugValue(t?t(e):e)}function Os(e){var t=$e(Ie++,10),n=Z();return t.__=e,H.componentDidCatch||(H.componentDidCatch=function(r,o){t.__&&t.__(r,o),n[1](r)}),[n[0],function(){n[1](void 0)}]}function Nr(){var e=$e(Ie++,11);if(!e.__){for(var t=H.__v;t!==null&&!t.__m&&t.__!==null;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__}function Ms(){for(var e;e=Ur.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(It),e.__H.__h.forEach(sn),e.__H.__h=[]}catch(t){e.__H.__h=[],L.__e(t,e.__v)}}L.__b=function(e){H=null,Pr&&Pr(e)},L.__r=function(e){Tr&&Tr(e),Ie=0;var t=(H=e.__c).__H;t&&(nn===H?(t.__h=[],H.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Et,n.__N=n.i=void 0})):(t.__h.forEach(It),t.__h.forEach(sn),t.__h=[])),nn=H},L.diffed=function(e){Dr&&Dr(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ur.push(t)!==1&&Ir===L.requestAnimationFrame||((Ir=L.requestAnimationFrame)||Ns)(Ms)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Et&&(n.__=n.__V),n.i=void 0,n.__V=Et})),nn=H=null},L.__c=function(e,t){t.some(function(n){try{n.__h.forEach(It),n.__h=n.__h.filter(function(r){return!r.__||sn(r)})}catch(r){t.some(function(o){o.__h&&(o.__h=[])}),t=[],L.__e(r,n.__v)}}),Rr&&Rr(e,t)},L.unmount=function(e){jr&&jr(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{It(r)}catch(o){t=o}}),n.__H=void 0,t&&L.__e(t,n.__v))};var Vr=typeof requestAnimationFrame=="function";function Ns(e){var t,n=function(){clearTimeout(r),Vr&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Vr&&(t=requestAnimationFrame(n))}function It(e){var t=H,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),H=t}function sn(e){var t=H;e.__c=e.__(),H=t}function an(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Br(e,t){return typeof t=="function"?t(e):t}function Fr(e,t){for(var n in t)e[n]=t[n];return e}function ln(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function cn(e,t){return e===t&&(e!==0||1/e==1/t)||e!=e&&t!=t}function Ut(e){this.props=e}function $r(e,t){function n(o){var i=this.props.ref,s=i==o.ref;return!s&&i&&(i.call?i(null):i.current=null),t?!t(this.props,o)||!s:ln(this.props,o)}function r(o){return this.shouldComponentUpdate=n,q(e,o)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(Ut.prototype=new le).isPureReactComponent=!0,Ut.prototype.shouldComponentUpdate=function(e,t){return ln(this.props,e)||ln(this.state,t)};var Hr=L.__b;L.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Hr&&Hr(e)};var Vs=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function zr(e){function t(n){var r=Fr({},n);return delete r.ref,e(r,n.ref||null)}return t.$$typeof=Vs,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var qr=function(e,t){return e==null?null:ke(ke(e).map(t))},Wr={map:qr,forEach:qr,count:function(e){return e?ke(e).length:0},only:function(e){var t=ke(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ke},Bs=L.__e;L.__e=function(e,t,n,r){if(e.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t)}Bs(e,t,n,r)};var Gr=L.unmount;function Kr(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=Fr({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return Kr(r,t,n)})),e}function Zr(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return Zr(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function ft(){this.__u=0,this.t=null,this.__b=null}function Yr(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Qr(e){var t,n,r;function o(i){if(t||(t=e()).then(function(s){n=s.default||s},function(s){r=s}),r)throw r;if(!n)throw t;return q(n,i)}return o.displayName="Lazy",o.__f=!0,o}function Xe(){this.u=null,this.o=null}L.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),Gr&&Gr(e)},(ft.prototype=new le).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var o=Yr(r.__v),i=!1,s=function(){i||(i=!0,n.__R=null,o?o(a):a())};n.__R=s;var a=function(){if(!--r.__u){if(r.state.__a){var d=r.state.__a;r.__v.__k[0]=Zr(d,d.__c.__P,d.__c.__O)}var l;for(r.setState({__a:r.__b=null});l=r.t.pop();)l.forceUpdate()}},c=t.__h===!0;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(s,s)},ft.prototype.componentWillUnmount=function(){this.t=[]},ft.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Kr(this.__b,n,r.__O=r.__P)}this.__b=null}var o=t.__a&&q(ae,null,e.fallback);return o&&(o.__h=null),[q(ae,null,t.__a?null:e.children),o]};var Jr=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function Fs(e){return this.getChildContext=function(){return e.context},e.children}function $s(e){var t=this,n=e.i;t.componentWillUnmount=function(){Ye(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,o){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Ye(q(Fs,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Xr(e,t){var n=q($s,{__v:e,i:t});return n.containerInfo=t,n}(Xe.prototype=new le).__a=function(e){var t=this,n=Yr(t.__v),r=t.o.get(e);return r[0]++,function(o){var i=function(){t.props.revealOrder?(r.push(o),Jr(t,e,r)):o()};n?n(i):i()}},Xe.prototype.render=function(e){this.u=null,this.o=new Map;var t=ke(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Xe.prototype.componentDidUpdate=Xe.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){Jr(e,n,t)})};var eo=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Hs=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,zs=typeof document<"u",qs=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function to(e,t,n){return t.__k==null&&(t.textContent=""),Ye(e,t),typeof n=="function"&&n(),e?e.__c:null}function no(e,t,n){return Sr(e,t),typeof n=="function"&&n(),e?e.__c:null}le.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(le.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var ro=L.event;function Ws(){}function Gs(){return this.cancelBubble}function Ks(){return this.defaultPrevented}L.event=function(e){return ro&&(e=ro(e)),e.persist=Ws,e.isPropagationStopped=Gs,e.isDefaultPrevented=Ks,e.nativeEvent=e};var oo,io={configurable:!0,get:function(){return this.class}},so=L.vnode;L.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){var o=t.indexOf("-")===-1;for(var i in r={},n){var s=n[i];zs&&i==="children"&&t==="noscript"||i==="value"&&"defaultValue"in n&&s==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&s===!0?s="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!qs(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():o&&Hs.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():s===null&&(s=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=s)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=ke(n.children).forEach(function(a){a.props.selected=r.value.indexOf(a.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=ke(n.children).forEach(function(a){a.props.selected=r.multiple?r.defaultValue.indexOf(a.props.value)!=-1:r.defaultValue==a.props.value})),e.props=r,n.class!=n.className&&(io.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",io))}e.$$typeof=eo,so&&so(e)};var ao=L.__r;L.__r=function(e){ao&&ao(e),oo=e.__c};var lo={ReactCurrentDispatcher:{current:{readContext:function(e){return oo.__n[e.__c].props.value}}}},Zs="17.0.2";function co(e){return q.bind(null,e)}function dn(e){return!!e&&e.$$typeof===eo}function uo(e){return dn(e)?js.apply(null,arguments):e}function po(e){return!!e.__k&&(Ye(null,e),!0)}function fo(e){return e&&(e.base||e.nodeType===1&&e)||null}var mo=function(e,t){return e(t)},ho=function(e,t){return e(t)},go=ae;function un(e){e()}function vo(e){return e}function _o(){return[!1,un]}var yo=pt;function wo(e,t){var n=t(),r=Z({h:{__:n,v:t}}),o=r[0].h,i=r[1];return pt(function(){o.__=n,o.v=t,cn(o.__,t())||i({h:o})},[e,n,t]),ie(function(){return cn(o.__,o.v())||i({h:o}),e(function(){cn(o.__,o.v())||i({h:o})})},[e]),n}var Ys={useState:Z,useId:Nr,useReducer:rn,useEffect:ie,useLayoutEffect:pt,useInsertionEffect:yo,useTransition:_o,useDeferredValue:vo,useSyncExternalStore:wo,startTransition:un,useRef:Ue,useImperativeHandle:Ar,useMemo:Lt,useCallback:Or,useContext:Mr,useDebugValue:on,version:"17.0.2",Children:Wr,render:to,hydrate:no,unmountComponentAtNode:po,createPortal:Xr,createElement:q,createContext:Er,createFactory:co,cloneElement:uo,createRef:fr,Fragment:ae,isValidElement:dn,findDOMNode:fo,Component:le,PureComponent:Ut,memo:$r,forwardRef:zr,flushSync:ho,unstable_batchedUpdates:mo,StrictMode:go,Suspense:ft,SuspenseList:Xe,lazy:Qr,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:lo};const Qs=Object.freeze(Object.defineProperty({__proto__:null,Children:Wr,PureComponent:Ut,StrictMode:go,Suspense:ft,SuspenseList:Xe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:lo,cloneElement:uo,createFactory:co,createPortal:Xr,default:Ys,findDOMNode:fo,flushSync:ho,forwardRef:zr,hydrate:no,isValidElement:dn,lazy:Qr,memo:$r,render:to,startTransition:un,unmountComponentAtNode:po,unstable_batchedUpdates:mo,useDeferredValue:vo,useInsertionEffect:yo,useSyncExternalStore:wo,useTransition:_o,version:Zs,Component:le,Fragment:ae,createContext:Er,createElement:q,createRef:fr,useCallback:Or,useContext:Mr,useDebugValue:on,useEffect:ie,useErrorBoundary:Os,useId:Nr,useImperativeHandle:Ar,useLayoutEffect:pt,useMemo:Lt,useReducer:rn,useRef:Ue,useState:Z},Symbol.toStringTag,{value:"Module"}));var bo={exports:{}},xo={};const Co=Li(Qs);var ko={exports:{}},So={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et=Co;function Js(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xs=typeof Object.is=="function"?Object.is:Js,ea=et.useState,ta=et.useEffect,na=et.useLayoutEffect,ra=et.useDebugValue;function oa(e,t){var n=t(),r=ea({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return na(function(){o.value=n,o.getSnapshot=t,pn(o)&&i({inst:o})},[e,n,t]),ta(function(){return pn(o)&&i({inst:o}),e(function(){pn(o)&&i({inst:o})})},[e]),ra(n),n}function pn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xs(e,n)}catch{return!0}}function ia(e,t){return t()}var sa=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ia:oa;So.useSyncExternalStore=et.useSyncExternalStore!==void 0?et.useSyncExternalStore:sa,function(e){e.exports=So}(ko);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pt=Co,aa=ko.exports;function la(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ca=typeof Object.is=="function"?Object.is:la,da=aa.useSyncExternalStore,ua=Pt.useRef,pa=Pt.useEffect,fa=Pt.useMemo,ma=Pt.useDebugValue;xo.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=ua(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=fa(function(){function c(f){if(!d){if(d=!0,l=f,f=r(f),o!==void 0&&s.hasValue){var h=s.value;if(o(h,f))return m=h}return m=f}if(h=m,ca(l,f))return h;var g=r(f);return o!==void 0&&o(h,g)?h:(l=f,m=g)}var d=!1,l,m,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,o]);var a=da(e,i[0],i[1]);return pa(function(){s.hasValue=!0,s.value=a},[a]),ma(a),a},function(e){e.exports=xo}(bo);const ha=Ei(bo.exports),{useSyncExternalStoreWithSelector:ga}=ha;function va(e,t=e.getState,n){const r=ga(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return on(r),r}const Eo=e=>{const t=typeof e=="function"?As(e):e,n=(r,o)=>va(t,r,o);return Object.assign(n,t),n},Lo=e=>e?Eo(e):Eo,fn=1,mn={eq(e,t){return e==t},neq(e,t){return!this.eq(e,t)},gt(e,t){return e>t},gte(e,t){return e>=t},lt(e,t){return e<t},lte(e,t){return e<=t},list_exact(e,t){return!Array.isArray(e)||!Array.isArray(t)?!1:e.slice().sort().join(",")===t.slice().sort().join(",")},list_all(e,t){return!Array.isArray(e)||!Array.isArray(t)?!1:!t.some(n=>e.indexOf(n)===-1)},list_alo(e,t){return!Array.isArray(e)||!Array.isArray(t)?!1:t.some(n=>e.indexOf(n)!=-1)}},hn=(e,t,n)=>{switch(t){case I.VideoVoice:return Boolean(e&&e.value);case I.Open:return!!n;case I.MultipleSelect:return Boolean(n&&!!Object.keys(n).length);case I.RecordedTask:return(n==null?void 0:n.taskStatus)===de.Completed;case I.TextUrlPrompt:return!e.value;case I.ConsentLegal:return n!==null;case I.MultipleChoice:return n!==void 0;case I.NPS:return n!==null;case I.Likert:return n!==null;default:return!0}},Io=({cards:e,index:t,hasEndCard:n,selectedValue:r,hasValidAnswer:o=!0,uploadProgress:i={}})=>{if(t>=e.length||t<0)return null;const a=e[t].props.routingOptions||[];let c=null,d=null;for(let f=0;f<a.length;f++){const{comparator:h,target:g,value:v}=a[f];if(h===Be.Answered&&o){c=g;break}else if(h===Be.GivenUp&&r instanceof Object&&"taskStatus"in r&&(r==null?void 0:r.taskStatus)===de.GivenUp){c=g;break}else if(h===Be.Skipped&&!o&&!(r instanceof Object&&"taskStatus"in r&&(r==null?void 0:r.taskStatus)===de.GivenUp)){c=g;break}else if(o&&Uo(h)&&mn[h](r,v)){c=g;break}}const l=c&&parseInt(String(c),10);c&&l!==null&&!isNaN(l)&&(l===-1||l>t)&&(d=l);const m=e.findIndex(f=>f.type===I.Uploading);let p;return m>0&&n?p=e.length-3:m>0||n?p=e.length-2:p=e.length-1,t>=p||d===-1||d!==null&&d>p?m>0&&Object.values(i).some(h=>h.isSubmitted&&!h.isComplete)?m:n?e.length-1:null:d!==null?d:t+1},_a=13,ya=(e,t)=>e.reduce((n,r)=>n.concat(n.map(o=>[...o,r])),[[]]).filter(n=>t||n.length>0),wa=e=>{switch(e.type){case I.MultipleSelect:return!e||!e.props||!e.props.options?null:e.props.options.length>_a?e.props.options.map(t=>[t.value]):ya(e.props.options.map(t=>t.value),!e.props.properties.required);case I.MultipleChoice:{if(!e||!e.props||!e.props.options)return null;const t=e.props.options.map(n=>n.value);return e.props.properties.required||t.push(void 0),t}case I.Likert:return[1,2,3,4,5,...e.props.properties.required?[]:[null]];case I.NPS:return[0,1,2,3,4,5,6,7,8,9,10,...e.props.properties.required?[]:[null]];case I.VideoVoice:case I.Open:return[fn,...e.props.properties.required?[]:[""]];case I.RecordedTask:return[{taskStatus:de.Completed},{taskStatus:de.GivenUp},...e.props.properties.required?[]:[{taskStatus:de.Abandoned}]];case I.TextUrlPrompt:return[void 0,...e.props.properties.required?[]:[{skipped:!0}]];case I.ConsentLegal:return[fn,...e.props.properties.required?[]:[null]];default:return[fn]}},Uo=e=>e in mn,ba=e=>typeof e=="object"&&e!==null&&"taskStatus"in e,xa=(e,t)=>{const n=new Set([I.Thanks,I.Uploading]);if(t>=e.length||t<0||n.has(e[t].type))return 0;const r=e.filter(i=>!n.has(i.type));if(t===r.length-1)return 1;const o={[r.length-1]:1,[-1]:0};for(let i=r.length-2;i>=t;i--){const s=r[i],a=s.props.routingOptions||[];if(a.length===0){o[i]=o[i+1]+1;continue}let c=0,d=wa(s);if(d===null)return r.length-1-t;for(let l=0;l<a.length&&d.length!==0;l++){const{comparator:m,target:p,value:f}=a[l],h=d.filter(g=>{const v=hn({value:g},s.type,g);return!(v&&m===Be.Answered||!v&&m===Be.Skipped||m===Be.GivenUp&&ba(g)&&g.taskStatus===de.GivenUp||v&&Uo(m)&&mn[m](g,f))});if(h.length<d.length){const g=parseInt(String(p),10);if(g!==-1&&g<=i||g>=r.length)return r.length-1-t;c=Math.max(o[g]+1,c)}d=h}d.length>0&&(c=Math.max(o[i+1]+1,c)),o[i]=c}return o[t]},Ca=e=>!(e.type===I.Thanks||e.type===I.Uploading),z=Lo()((e,t)=>({answers:void 0,apiURL:"",border:"#000000",cards:[],close:async(n=We)=>{const r=t(),{fadeout:o,remove:i,trackHistory:s}=r;await o(n),gn(r)||s({event:"closed"}),Ft.enable(),i({initiator:xe.Closed})},configureExitOnOverlayClick:()=>{},customMetadata:{},destroy:async n=>{const{eventEmitFn:r,fadeout:o,remove:i}=t();r(re.SurveyComplete),await o(n),Ft.enable(),i({initiator:xe.Complete})},endCard:{headline:""},envId:"",eventEmitFn:B.emit.bind(B),fadeout:async n=>{const{eventEmitFn:r,headers:o,viewDocument:i}=t();return Ke(o)?Promise.resolve():(r(O.SurveyFadingOut),new Promise(s=>{const a=i.getElementById(n);a?(a.addEventListener("transitionend",()=>{s()}),a.classList.remove("ul-app--visible")):s()}))},frame:document.createElement("iframe"),handleClickEmbedButton:n=>{const{cards:r,eventEmitFn:o,index:i}=t();o(n,{[Oe.QuestionId]:r[i].name,[Oe.Props]:r[i].props}),e(()=>({hasViewedEmbed:!0}))},handleUploadUpdate:({mediaRecordingUid:n,isComplete:r,progressPct:o,isSubmitted:i})=>{var p,f,h;const{cards:s,destroy:a,index:c,uploadProgress:d}=t(),l={...d,[n]:{progressPct:o||o===0?o:(p=d[n])==null?void 0:p.progressPct,isComplete:r||((f=d[n])==null?void 0:f.isComplete),isSubmitted:i||((h=d[n])==null?void 0:h.isSubmitted)}};if(s[c].type!==I.Uploading){e({uploadProgress:l});return}const m=Object.entries(d).every(([g,v])=>!v.isSubmitted||v.isComplete||n==g&&r);if(m&&c>=s.length-1){a(We);return}e({index:m?c+1:c,uploadingCardViewed:!0,uploadProgress:l})},hasViewedEmbed:!1,headers:{Authorization:"","Content-Type":"","userleap-platform":Me.Web,"x-ul-environment-id":"","x-ul-installation-method":Ne.Snippet,"x-ul-sdk-version":"","x-ul-visitor-id":""},index:0,isPreview:!1,marketingUrl:"https://sprig.com",meta:{ch:0,cw:0,l:"",mode:null,p:"",sh:0,sw:0},mode:void 0,next:n=>{const{cards:r,eventEmitFn:o,index:i,responseGroupUid:s,submit:a,trackHistory:c,uploadProgress:d,viewedCardCount:l}=t(),m=Date.now(),p=[...r],f=p[i],{type:h}=n.data,g={...n.data},v=g.value;Ca(f)&&(f.value=v),g.answeredAt=m,delete g.type;const w={response:g,responseGroupUid:s};let _=h===I.MultipleChoice?Object.values(v).find(x=>x!==!1):v;h===I.MultipleSelect&&(_=p[i].props.options.reduce((x,D)=>(v[D.id]&&x.push(D.value),x),[]));const C=hn(g,h,_),b=Io({cards:p,index:i,selectedValue:_,hasEndCard:!!n.endCard,hasValidAnswer:C,uploadProgress:d});if(b===null){w.completedAt=m,a(w),n.completeSurvey();return}else[I.Thanks,I.Uploading].includes(p[b].type)&&(w.completedAt=m);const E=a(w);[I.Thanks,I.Uploading].includes(p[b].type)||E.finally(()=>{c({event:"seen",index:b})});const A=p[b];p[b]&&o&&o(re.CurrentQuestion,{[Oe.QuestionId]:A.name,[Oe.Props]:A.props}),e({cards:p,hasViewedEmbed:!1,index:b,viewedCardCount:l+1})},previewKey:null,recorder:()=>{},recorderEventEmitter:B,responseGroupUid:"",remove:({initiator:n})=>{const{frame:r,headers:o,eventEmitFn:i}=t();["ios","android"].includes(o["userleap-platform"])&&i(O.SurveyWillClose,{name:O.SurveyWillClose,initiator:n}),!Ke(o)&&(i(O.SurveyWillClose,{name:O.SurveyWillClose,initiator:n}),r.remove())},seen:async()=>{const{trackHistory:n}=t();return n({event:"seen",isNew:!0})},slugName:null,showStripes:!1,showSurveyBrand:!1,styleNonce:"",submit:async({completedAt:n,response:r,responseGroupUid:o})=>{const i=t();if(!o||gn(i))return;const s={responseGroupUid:o,meta:i.meta,customMetadata:i.customMetadata,responses:[r],completedAt:n,previewKey:i.previewKey},a=await he(`${i.apiURL}/sdk/1/environments/${i.envId}/visitors/${i.userId}/responses/submit`,{body:JSON.stringify(s),headers:i.headers,method:"POST"});if(!a.ok){a.reportError&&(console.warn("[Sprig] (ERR-427) Failed to submit response",a.error),await Po(i,"submitResponse",a.error));return}},surveyId:0,tabTitle:"",trackHistory:async({event:n,index:r,isNew:o=!1})=>{const i=t();if(gn(i))return;const{cards:s,index:a}=i,c=r!==void 0?s[r]:s[a],d={sid:i.surveyId,qid:c.name,action:n,vid:i.userId,eid:i.envId,isNew:o,responseGroupUid:i.responseGroupUid},l=await he(`${i.apiURL}/sdk/1/visitors/${i.userId}/surveys/${i.surveyId}/history`,{body:JSON.stringify(d),headers:i.headers,method:"POST"});!l.ok&&l.reportError&&(console.warn("[Sprig] (ERR-428) Failed to track survey event",l.error),await Po(i,"trackHistory",l.error))},update:()=>{const{headers:n,eventEmitFn:r,frame:o,viewDocument:i}=t();setTimeout(()=>{var a;const s=Fn(i);Ke(n)?r(O.SurveyHeight,{name:O.SurveyHeight,contentFrameHeight:s}):(a=o.setHeight)==null||a.call(o,s)},100)},uploadingCardViewed:!1,uploadProgress:{},useDesktopPrototype:void 0,useMobileStyling:!1,userId:"",viewDocument:window.document,viewedCardCount:0})),gn=e=>!e.userId||e.meta&&e.meta.mode==="test"||e.isPreview,Po=async(e,t,n)=>{const{mode:r,userId:o,envId:i,apiURL:s,headers:a,viewDocument:c}=e,d=c.documentElement,l={mode:r,screenWidth:window.screen.width,screenHeight:window.screen.height,clientWidth:d.clientWidth,clientHeight:d.clientHeight,location:window.location.href,language:window.navigator.language},m={action:t,err:{message:n==null?void 0:n.message,stack:n==null?void 0:n.stack},meta:l,vid:o,envId:i};(await he(`${s}/sdk/1/errors`,{method:"POST",headers:Object.assign({"x-ul-error":window.btoa(`userleap-${Date.now()}-error`)},a),body:JSON.stringify(m)})).ok||console.warn("[Sprig] (ERR-444) Failed to report error to API",n)},ka=async(e,t)=>{var r;const n=await fetch(t,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok){const o=await n.json();return(r=o==null?void 0:o.upload)==null?void 0:r.url}else return null},To=()=>MediaRecorder.isTypeSupported("video/webm")?"video/webm":"video/mp4",Do=e=>{const t={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:To()};return new MediaRecorder(e,t)},Ro=(e,t,n)=>{n[t]=[],e.ondataavailable=function(r){n[t].push(r.data)},e.currentMediaRecordingUid=t,e.start()};function jo(e,t,n,r,o,i){if(e&&e.state!=="inactive"){const{[N.BeginCallback]:s}=r,a=e.currentMediaRecordingUid;if(!a)return;s&&s(a),e.onstop=()=>Sa(t,e,n,r,a,o,i),e.stop()}}async function Sa(e,t,n,r,o,i,s){const a=z.getState().viewDocument,{[N.UploadCallback]:c,[N.ProgressCallback]:d}=r,l={mediaType:n,updatedAt:new Date().toISOString(),mediaRecordingUid:o,...r[N.PassthroughData]},m=await ka(l,e);if(!m){c&&c(null,{message:"failed to get upload url"});return}const p=new Blob(s,{type:To()});if(!a.defaultView)return;const f=new a.defaultView.File([p],`recording video ${Date.now()}`),h=i.createUpload({endpoint:m,file:f,chunkSize:5120});h.startTime=Date.now(),h.on("error",g=>{c&&c(null,g)}),h.on("progress",g=>{d&&d(o,g)}),h.on("success",()=>{c&&c(o,!0)})}const Ea={state:{...{chunks:{}}},stopRecording(e){const{uploadApiEndpoint:t,avRecorder:n,screenRecorder:r,UpChunk:o}=this.state,i=this.state.avStream&&this.state.avStream.getVideoTracks().length>0?ce.Video:ce.Audio;this.state.chunks&&t&&o&&(n!=null&&n.currentMediaRecordingUid&&jo(n,t,i,e,o,this.state.chunks[n==null?void 0:n.currentMediaRecordingUid]),r!=null&&r.currentMediaRecordingUid&&jo(r,t,ce.Screen,e,o,this.state.chunks[r==null?void 0:r.currentMediaRecordingUid]))},handleCancelledStream(e){const t=e.getVideoTracks(),n=e.getAudioTracks();let r=t.length&&t[0];r=r||n.length&&n[0],r&&r.addEventListener("ended",()=>{[this.state.avRecorder,this.state.screenRecorder].map(o=>{o&&(o.state==="recording"&&o.stop(),o.stream.getTracks().map(i=>{i.readyState==="live"&&i.stop()}))}),Object.assign(this.state,{avStream:null,captureStream:null,avRecorder:null,screenRecorder:null})})},taskDurationMillisecond(){return this.state.startTime?new Date().getTime()-this.state.startTime.getTime():0},setUpChunk(e){this.state.UpChunk=e},configure(e,t){Object.assign(this.state,t),this.state.uploadApiEndpoint=`${t.apiURL}/2/environments/integrations/upload`,this.state.chunks={},e.on(J.PermissionStatus,this.permissionStatusCallback.bind(this)),e.on(J.AvPermission,async n=>{this.avPermissionCallback(n)}),e.on(J.BeginRecording,this.beginRecordingCallback.bind(this)),e.on(J.StartTask,this.startTaskCallback.bind(this)),e.on(J.ScreenPermission,async n=>{this.screenPermissionCallback(n)}),e.on(J.FinishTask,async n=>{this.finishTaskCallback(n)})},async avPermissionCallback(e){var r,o,i;const{[N.StreamReadyCallback]:t,[N.PermissionDescriptors]:n}=e;try{(r=this.state.avStream)!=null&&r.active&&(this.state.avStream.getTracks().map(s=>s.readyState==="live"&&s.stop()),((o=this.state.captureStream)==null?void 0:o.getAudioTracks().length)===1&&this.state.captureStream.removeTrack(this.state.captureStream.getAudioTracks()[0])),this.state.avStream=await navigator.mediaDevices.getUserMedia({video:n.includes(Qe.Camera),audio:!0}),((i=this.state.captureStream)==null?void 0:i.getAudioTracks().length)===0&&this.state.captureStream.addTrack(this.state.avStream.getAudioTracks()[0]),this.handleCancelledStream(this.state.avStream)}catch(s){console.warn("Error: failed to get permissions: "+s),t&&t(null,null);return}t&&t(this.state.avStream,this.state.captureStream)},async screenPermissionCallback(e){const{[N.ScreenPermissionRequested]:t,[N.StreamReadyCallback]:n}=e;t==null||t(!0);try{this.state.captureStream=await navigator.mediaDevices.getDisplayMedia({video:!0,cursor:"always",displaySurface:"browser",preferCurrentTab:!0})}catch(r){t==null||t(!1),console.warn("Error: failed to get permissions: "+r),n&&n(null,null);return}t==null||t(!1),this.state.avStream&&this.state.avStream.getAudioTracks().length>0&&this.state.captureStream.addTrack(this.state.avStream.getAudioTracks()[0]),this.handleCancelledStream(this.state.captureStream),n&&n(this.state.avStream||null,this.state.captureStream)},beginRecordingCallback(e){const{[N.RecordingMediaTypes]:t,[N.StartRecordingCallback]:n}=e;if(!t)return;const r=[];if(t.includes(ce.Video)&&this.state.avStream){this.state.avRecorder=Do(this.state.avStream);const o=Ee();Ro(this.state.avRecorder,o,this.state.chunks),r.push(o)}if(t.includes(ce.Screen)&&this.state.captureStream){this.state.screenRecorder=Do(this.state.captureStream);const o=Ee();Ro(this.state.screenRecorder,o,this.state.chunks),r.push(o)}r&&n&&n(r)},async finishTaskCallback(e){const{[N.CurrentIndex]:t,[N.TaskResponse]:n,[N.TaskCompleteCallback]:r}=e;await this.stopRecording(e),r&&r(this.taskDurationMillisecond()),this.state.cards&&this.state.hasEndCard!==void 0&&this.lookAheadAndStopStream(t,n,this.state.cards,this.state.hasEndCard)},startTaskCallback(){this.state.startTime=new Date},permissionStatusCallback(e){var r;const{[N.PermissionStatusCallback]:t}=e,n=this.state.avStream;t&&t(n,n?(n==null?void 0:n.getVideoTracks().length)>0:!1,!!((r=this.state.captureStream)!=null&&r.active),this.state.captureStream)},lookAheadAndStopStream(e,t,n,r){const{avRecorder:o,screenRecorder:i}=this.state,s=Io({cards:n,index:e,selectedValue:t.value,hasEndCard:r,hasValidAnswer:hn(t,t.type,t.value)});s!==null&&n[s].type===I.RecordedTask||[o,i].map(a=>{a&&(a.state==="recording"&&a.stop(),a.stream.getTracks().map(c=>{c.readyState==="live"&&c.stop()}))})}},Tt=Object.create(Ea);Object.freeze(Tt);function Ao(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Ao(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function R(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=Ao(e))&&(r&&(r+=" "),r+=t);return r}var La=0;function u(e,t,n,r,o,i){var s,a,c={};for(a in t)a=="ref"?s=t[a]:c[a]=t[a];var d={type:e,props:c,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--La,__source:o,__self:i};if(typeof e=="function"&&(s=e.defaultProps))for(a in s)c[a]===void 0&&(c[a]=s[a]);return L.vnode&&L.vnode(d),d}const te=e=>u("button",{...e,className:R("ul-card-text__button",e.className),id:"ul-card-text__button"}),ve=({message:e,properties:t})=>{const n=t==null?void 0:t.captionText;return u(ae,{children:[e&&u("h1",{className:k.QuestionHeader,id:k.QuestionHeader,...n?{}:{style:{marginBottom:"15px"}},children:e}),n&&u("p",{className:k.Caption,id:k.Caption,children:n})]})},Oo=({buttonText:e="View Prototype",handleClick:t})=>u("button",{className:"prototype-button",onClick:t,children:e},"prototype-btn"),Pe=({defaultBody:e,embeddedType:t="prototype",properties:n})=>{var m;const{handleClickEmbedButton:r,hasViewedEmbed:o,headers:i,useDesktopPrototype:s}=z(p=>({handleClickEmbedButton:p.handleClickEmbedButton,hasViewedEmbed:p.hasViewedEmbed,headers:p.headers,useDesktopPrototype:p.useDesktopPrototype})),a=(n==null?void 0:n.conceptUrl)||((m=n==null?void 0:n.consentDocument)==null?void 0:m.url),c=window.innerWidth<xi,d=i["userleap-platform"],l=(p,f)=>{p.preventDefault(),r(f)};if(!s&&c&&!o&&a&&["email","link"].includes(d)){if(t==="prototype")return u(Oo,{handleClick:p=>{l(p,re.ViewPrototypeClick)}});if(t==="pdf")return u(Oo,{buttonText:(n==null?void 0:n.viewDocumentText)||"View Document",handleClick:p=>{l(p,re.ViewAgreementClick)}})}return e()},Mo=(e,t)=>{const n=Ue(0),r=()=>{if(e.current){const o=e.current;o.style.height="1px";const i=o.scrollHeight,s=o.offsetHeight-o.clientHeight,a=i+s,c=parseInt(window.getComputedStyle(o).getPropertyValue("max-height")),d=a<=c?a:c;n.current!==d&&t(),n.current=d,o.style.height=`${d}px`}};return ie(r,[]),r},No=({border:e,label:t,isSelected:n,value:r,text:o,id:i,isRadio:s,useMobileStyling:a,error:c,allowTextEntry:d,promptText:l,onUserInputChanged:m})=>{const{styleNonce:p,viewDocument:f}=z(P=>({styleNonce:P.styleNonce,viewDocument:P.viewDocument})),[h,g]=Z(!1);Pa(f,e,p);const v=({isSelected:P,userText:V})=>{m&&m({id:i||"",selected:P,value:r,userText:V})},w=P=>{P.stopPropagation(),v({isSelected:s||!n,userText:o}),g(!1)},_=()=>{h||g(!0)},C=()=>{h&&g(!1)},b=P=>{rt(P.target)||(P.key==="Enter"||P.key===" ")&&w(P)},E={onClick:P=>w(P),onKeyPress:P=>b(P)};"ontouchstart"in f.documentElement?(E.onTouchStart=C,E.onTouchCancel=C,E.onTouchEnd=C):(E.onMouseDown=_,E.onMouseLeave=C);const A=s?`radio-${i}`:`checkbox-${i}`,x=n||h?[Dt]:[],D=[...c?[Bo]:[],...x];return u("div",{className:R([...W(k.Choice,a),...D]),id:`choice-div-${i}`,style:c?{borderColor:nt}:{},...E,children:[u("div",{className:R([k.ChoiceLabelContainer]),children:[s?u("div",{"aria-labelledby":`label-${i}`,className:R([k.ChoiceRadio,...x]),id:A,role:"radio",tabIndex:0}):u("div",{"aria-checked":n,"aria-labelledby":`label-${i}`,className:k.ChoiceCheckbox,id:A,role:"checkbox",style:n?{backgroundColor:e,borderColor:e,boxShadow:"none"}:{},tabIndex:0,children:n&&u("svg",{fill:"none",height:"10",viewBox:"0 0 10 10",width:"10",xmlns:"http://www.w3.org/2000/svg",children:u("path",{d:"M9.15377 1.30774L4.07685 8.23082L1.30762 5.00005",stroke:"white",strokeLinecap:"round",strokeWidth:"2"})})}),u("label",{className:R(W(k.ChoiceLabel,a)),htmlFor:A,id:`label-${i}`,children:t})]}),d&&n&&u("div",{className:R([k.ChoiceTextEntryContainer,...x]),children:u(Ia,{onTextChange:P=>v({isSelected:n,userText:P}),promptText:l||"Please specify",textValue:o,useMobileStyling:a})})]})},Ia=({promptText:e,textValue:t,onTextChange:n,useMobileStyling:r})=>{const o=Ue(null),{update:i}=z(a=>({update:a.update})),s=Mo(o,()=>i());return ie(()=>{o.current&&o.current.focus()},[]),u("textarea",{"aria-label":e,"aria-multiline":"true","aria-placeholder":e,className:R(W(k.ChoiceTextInput,r)),"data-gramm":"false",maxLength:5e3,name:"text",onChange:a=>{s(),rt(a.target)&&(a.stopPropagation(),n(a.target.value))},onClick:a=>{a.stopPropagation()},onKeyPress:a=>{a.stopPropagation()},placeholder:e,ref:o,role:"textbox",rows:1,value:t})},Vo="ul-select-style-element",Dt="ul-select-active-dynamic-style",Bo="ul-select-error-dynamic-style",Ua=e=>e.tagName.toLowerCase()==="style",Pa=(e,t,n)=>{let r=e.getElementById(Vo),o=!1;r||(r=e.createElement("style"),o=!0),Ua(r)&&(r.id=Vo,n&&(r.nonce=n),r.textContent=Ta(t),o&&e.head.appendChild(r))},Ta=e=>`
    .${Dt} {
      border-color: ${e};
    }
    .${Dt} .${k.ChoiceRadio}, .${Dt}.${k.ChoiceRadio} {
      border: 6px solid ${e};
      box-shadow: none;
    }
    .${Bo} {
      border-color: ${nt};
    }
  `,tt=e=>(e==null?void 0:e.buttonText)||"Next",vn=e=>(e==null?void 0:e.skipButtonText)||"Skip",Da=({className:e,message:t,next:n,properties:r,questionId:o,type:i})=>{const{headers:s,useMobileStyling:a,border:c}=z(S=>({headers:S.headers,useMobileStyling:S.useMobileStyling,border:S.border})),[d,l]=Z(!1),[m,p]=Z(""),[f,h]=Z(!1),g=s["userleap-platform"],v=r==null?void 0:r.collectName,w=(r==null?void 0:r.nameLabelText)||"Full Name",_=(r==null?void 0:r.consentText)||"I agree to the stated conditions",C=(r==null?void 0:r.submitButtonText)||"Submit",b=!!m.trim(),E=d&&(!v||b),A=(S,$=!1)=>{S.preventDefault(),S.stopPropagation();let y=null;if(!$){if(!E){h(!0);return}y={submitted:!0},v&&(y.name=m)}n({value:y,questionId:o,type:i})},x=S=>{ki(S.target)&&(S.preventDefault(),S.stopPropagation(),p(S.target.value))},D=S=>{Ge(S.target)&&(S.target.style.borderColor=f&&!b?nt:c)},P=S=>{Ge(S.target)&&(S.target.style.borderColor=f&&!b?nt:Bt)},V=()=>u("div",{children:[u(No,{allowTextEntry:!1,border:c,error:f&&!d,index:0,isRadio:!1,isSelected:d,label:_,onUserInputChanged:({selected:S})=>{S!==d&&l(!d)},useMobileStyling:a}),v&&u("input",{"aria-label":w,"aria-placeholder":w,className:R(W(k.ConsentLegalNameInput,a)),"data-gramm":"false",maxLength:250,name:"name",onBlur:P,onFocus:D,onInput:x,placeholder:w,style:f&&!b?{borderColor:nt}:{},tabIndex:0,value:m}),u("div",{className:"ul-card__button-wrapper ul-card-vertical__button-wrapper",children:[u(te,{className:E?"":k.ButtonDisabled,onClick:A,children:C}),r.required===!1&&u("button",{className:"ul-card-skip__button",onClick:S=>A(S,!0),children:vn(r)})]})]});return u("div",{className:R(me(k.CardMainContent,g)),children:u("div",{className:R([e,"ul-card__consent-legal",k.FadeInTransition]),children:[u(ve,{message:t}),u("div",{className:"ul-rich-text-body",dangerouslySetInnerHTML:r&&r.richTextBody?{__html:r&&r.richTextBody}:void 0,id:"ul-card__consent-legal-body-container"}),u(Pe,{properties:r,defaultBody:V,embeddedType:"pdf"})]},o)})},Ra=({activeValue:e,border:t,icon:n,isPressed:r,onSubmit:o,range:i,scaleLabelType:s,setActiveValue:a,setIsPressed:c,useMobileStyling:d,value:l})=>{const m=`option-${l}`,p=s===Fe.Number,f=s===Fe.Star,h=p&&l===e,[g,v]=(()=>l<=e&&f||l===e?r?[t,1]:[t,.3]:["",1])(),w=()=>{switch(s){case Fe.Star:return R([...W(k.LikertStar,d),...W(`${k.LikertStar}-${l}`,d)]);case Fe.Smiley:return R([...W(k.LikertSmiley,d),...W(`${k.LikertSmiley}-${l}`,d)]);default:return R(l===i?[...W(k.LikertNumber,d),...W(`${k.LikertNumber}-${l}`,d),...W("likert-last-option",d)]:[...W(k.LikertNumber,d),...W(`${k.LikertNumber}-${l}`,d)])}},_=()=>{a(-1),c(!1)};return u("div",{"aria-label":p?void 0:String(l),className:w(),dangerouslySetInnerHTML:{__html:n},id:m,onClick:()=>o(),onPointerDown:()=>c(!0),onPointerEnter:()=>a(l),onPointerLeave:_,role:"radio",style:{color:p?"":g,borderColor:h?g:"",fillOpacity:h?"":v,zIndex:h?3:"auto"},tabIndex:0})},ja=({className:e,labels:t,message:n,next:r,properties:o,questionId:i,type:s})=>{const{border:a,headers:c,useMobileStyling:d}=z(V=>({border:V.border,headers:V.headers,useMobileStyling:V.useMobileStyling})),[l,m]=Z(-1),[p,f]=Z(!1),h=c["userleap-platform"],g=t&&t.left,v=t&&t.right;let w;const{range:_,scaleLabelType:C,ratingIcons:b}=o;_&&(w=Number(_));const E=w||5,A=V=>{var S,$;switch(C){case Fe.Star:return(S=b[0])==null?void 0:S.svg;case Fe.Smiley:return($=b[V])==null?void 0:$.svg;default:return String(V+1)}},x=[...Array(E)].map((V,S)=>{const $=S+1;return u(Ra,{activeValue:l,border:a,icon:A(S),isPressed:p,onSubmit:()=>r({value:$,questionId:i,type:s}),range:E,scaleLabelType:C,setActiveValue:m,setIsPressed:f,useMobileStyling:d,value:$},S)}),D=V=>{V.preventDefault(),V.stopPropagation(),r({value:null,questionId:i,type:s})},P=()=>u(ae,{children:[u("div",{"aria-label":`Rating (1 - ${E})`,className:"ul-card--likert__numbers",role:"radiogroup",children:x}),u("div",{className:"ul-card--likert__labels",children:[u("span",{children:g}),u("span",{children:v})]}),!o.required&&u("div",{className:"ul-vertical-centered-container",children:u(te,{onClick:D,children:tt(o)})})]});return u("div",{className:R(me(k.CardMainContent,h)),children:u("form",{className:R([e,"ul-card--likert",k.FadeInTransition]),children:[u(ve,{message:n,properties:o}),u(Pe,{properties:o,defaultBody:P})]},i)})},Fo=({className:e,message:t,onSubmit:n,options:r=[],properties:o,questionId:i,type:s})=>{const{border:a,headers:c,useMobileStyling:d}=z(x=>({border:x.border,headers:x.headers,useMobileStyling:x.useMobileStyling})),l=r.reduce((x,D)=>(x[D.id]={isSelected:!1},x),{}),[m,p]=Z(l),f=c["userleap-platform"],h=s===I.MultipleChoice,g=o.required,v=Object.entries(m).some(([x,D])=>{var S;const P=r.find($=>`${$.id}`===x),V=D.userText===void 0||D.userText.trim()==="";return((S=P==null?void 0:P.optionProperties)==null?void 0:S.allowsTextEntry)&&V&&D.isSelected}),w=Object.values(m).some(x=>x.isSelected),_=v||g&&!w,C=r.map(({id:x,label:D,value:P,optionProperties:V},S)=>{var F,M;const $=`${x}`,{allowsTextEntry:y}=V||{allowsTextEntry:!1};return u(No,{allowTextEntry:y,border:a,error:!1,id:$,index:S,isRadio:h,isSelected:!!((F=m[$])!=null&&F.isSelected),label:D,onUserInputChanged:pe=>E(pe.id,pe.selected,pe.userText),promptText:"Please specify",text:(M=m[x])==null?void 0:M.userText,useMobileStyling:d,value:P},$)}),b=x=>{x.preventDefault(),x.stopPropagation(),n(m)},E=(x,D,P)=>{const V=Object.assign({},m);if(h&&D)for(const S of Object.values(V))S.isSelected=!1,delete S.userText;V[x]={isSelected:D,userText:P},p(V)},A=()=>u("div",{children:[u("div",{className:R(W(k.ChoiceGroup,d)),role:h?"radiogroup":"group",children:C}),u("div",{className:"ul-card__button-wrapper",children:u(te,{disabled:_,onClick:b,children:tt(o)})})]});return u("div",{className:R(me(k.CardMainContent,f)),children:u("form",{className:R([e,"ul-card--multiple",k.FadeInTransition]),id:"text-form",onSubmit:b,children:[u(ve,{message:t,properties:o}),u(Pe,{properties:o,defaultBody:A})]},i)})},Aa=e=>{const{questionId:t,type:n,next:r,options:o}=e;return u(Fo,{...e,onSubmit:s=>{const a=Object.entries(s).find(([,p])=>p.isSelected)||[void 0,void 0],[c,d]=a,l=o.find(p=>`${p.id}`===c),m=d!=null&&d.userText?{[c]:{userText:d.userText}}:null;r({value:l&&c?{[c]:l.value}:{},secondaryValue:m,questionId:t,type:n})}})},Oa=e=>{const{questionId:t,type:n,next:r}=e;return u(Fo,{...e,onSubmit:i=>{const s={},a=Object.entries(i).reduce((d,[l,m])=>(d[l]=m.isSelected,d),s),c=Object.entries(i).reduce((d,[l,m])=>{if(!m.userText)return d;const p=d||{};return p[l]={userText:m.userText},p},null);r({value:a,secondaryValue:c,questionId:t,type:n})}})},Ma=({className:e,props:{labels:t,message:n,properties:r},next:o,questionId:i,type:s})=>{const{border:a,headers:c,useMobileStyling:d}=z(v=>({border:v.border,headers:v.headers,useMobileStyling:v.useMobileStyling})),l=c["userleap-platform"],m=t&&t.left,p=t&&t.right,f=[...Array(11)].map((v,w)=>u("div",{className:R([...W(k.NPSNumber,d),...W(`${k.NPSNumber}-${w}`,d)]),id:`option-${w}`,onClick:()=>o({value:w,questionId:i,type:s}),onKeyPress:_=>{_.preventDefault(),(_.key==="Enter"||_.key===" ")&&o({value:w,questionId:i,type:s})},onPointerDown:_=>{Ge(_.target)&&(_.target.style.zIndex="2",_.target.style.borderColor=a)},onPointerLeave:_=>{Ge(_.target)&&(_.target.style.zIndex="auto",_.target.style.borderColor=Bt)},role:"radio",tabIndex:0,children:w},w)),h=v=>{v.preventDefault(),v.stopPropagation(),o({value:null,questionId:i,type:s})},g=()=>u("div",{children:[u("div",{className:"ul-card--nps__numbers",children:f}),u("div",{className:"ul-card--nps__labels",children:[u("span",{children:m}),u("span",{children:p})]}),!r.required&&u("div",{className:"ul-vertical-centered-container",children:u(te,{onClick:h,children:tt(r)})})]});return u("div",{className:R(me(k.CardMainContent,l)),children:u("form",{className:R([e,"ul-card--nps",k.FadeInTransition]),children:[u(ve,{message:n,properties:r}),u(Pe,{properties:r,defaultBody:g})]},i)})},Na=({className:e,message:t,next:n,properties:r,questionId:o,type:i})=>{const{border:s,headers:a,useMobileStyling:c,update:d}=z(x=>({border:x.border,headers:x.headers,useMobileStyling:x.useMobileStyling,update:x.update})),[l,m]=Z(""),p=Ue(null),f=a["userleap-platform"],h=l.trim(),g=r.required===!0&&!h,v=Mo(p,()=>d()),w=x=>{v(),x.preventDefault(),x.stopPropagation(),rt(x.target)&&m(x.target.value)},_=x=>{x.preventDefault(),x.stopPropagation(),n({value:l,questionId:o,type:i})},C=r&&r.openTextPlaceholder?r.openTextPlaceholder:"",b=x=>{rt(x.target)&&(x.target.style.borderColor=s)},E=x=>{rt(x.target)&&(x.target.style.borderColor=Bt)},A=()=>u("div",{className:"ul-card-text",children:[u("div",{className:"ul-card-text__container",children:u("textarea",{"aria-label":C,"aria-labelledby":k.QuestionHeader,"aria-multiline":"true","aria-placeholder":C,className:R(W(k.OpenTextInput,c)),"data-gramm":"false",maxLength:5e3,name:"text",onBlur:E,onChange:w,onFocus:b,placeholder:C,ref:p,role:"textbox",tabIndex:0})}),u(te,{disabled:g,onClick:_,style:{backgroundColor:g?"":s},children:tt(r)})]});return u("div",{className:R(me(k.CardMainContent,f)),children:u("form",{className:R([e,"ul-card--text",k.FadeInTransition]),id:"text-form",children:[u(ve,{message:t,properties:r}),u(Pe,{defaultBody:A,properties:r})]},o)})};var Te=(e=>(e[e.RequestNeeded=1]="RequestNeeded",e[e.TryAgain=2]="TryAgain",e[e.Ready=3]="Ready",e))(Te||{});const Rt=e=>e.type===oe.AvPermission,$o=e=>e.type===oe.ScreenPermission,Va=(e,t)=>!(Rt(t)?t.permissionDescriptors:[]).includes(Qe.Camera)||e.getVideoTracks().length>0,Ho=(e,t)=>{if(e===void 0)return Te.RequestNeeded;if(e){if(!Va(e,t))return Te.RequestNeeded}else return Te.TryAgain;return Te.Ready},zo={avStream:null,currentPage:null,mediaRecordingUids:null,nextQuestion:()=>{},passthroughData:void 0,recordingMediaTypes:void 0,screenPermissionRequested:!1,type:void 0},_e=Lo(e=>({...zo,reset:()=>{e(zo)},updatePage:t=>{e(t)}}));function _n({currentPage:e,pages:t}){const{avStream:n,recordingMediaTypes:r,updatePage:o}=_e.getState(),{recorderEventEmitter:i}=z.getState();i.emit(J.AvPermission,{[N.PermissionDescriptors]:e.permissionDescriptors,[N.StreamReadyCallback]:(s,a)=>{if(n===s)return;let c=e;if(s&&!e.permissionDescriptors.includes(Qe.Camera)){const d=t.indexOf(e),l=a!=null&&a.active?d+2:d+1;(a==null?void 0:a.active)&&r&&i.emit(J.BeginRecording,{[N.RecordingMediaTypes]:r,[N.StartRecordingCallback]:m=>o({mediaRecordingUids:m})}),c=t[l]}o({currentPage:c,avStream:s})}})}function Ba({pages:e,userId:t,responseGroupUid:n,surveyId:r,questionId:o,next:i}){const{updatePage:s}=_e.getState(),{eventEmitFn:a,recorderEventEmitter:c}=z.getState(),d={questionId:o,surveyId:r,visitorId:t,responseGroupUid:n};let l=0;c.emit(re.RecordedTaskPermissionScreen),a(re.RecordedTaskPermissionScreen),c.emit(J.PermissionStatus,{[N.PermissionStatusCallback]:(p,f,h,g)=>{const v=e[l],{type:w}=v,_=[ce.Screen];if(Rt(v)){const{permissionDescriptors:C}=v,b=C==null?void 0:C.includes(Qe.Microphone),E=C==null?void 0:C.includes(Qe.Camera);b&&_.push(ce.Audio),E&&_.push(ce.Video);const A=(p==null?void 0:p.active)&&!E,x=(p==null?void 0:p.active)&&f;(A||x)&&l++}$o(e[l])&&h&&(l++,c.emit(J.BeginRecording,{[N.RecordingMediaTypes]:_,[N.StartRecordingCallback]:C=>s({mediaRecordingUids:C})})),s({currentPage:e[l],avStream:p,screenPermissionRequested:h,nextQuestion:i,type:w,passthroughData:d,recordingMediaTypes:_,captureStream:g})}});const m=e[l];return m.type===oe.AvPermission&&_n({currentPage:m,pages:e}),m}function yn({status:e}){const{nextQuestion:t,passthroughData:n,mediaRecordingUids:r,reset:o}=_e.getState(),{recorderEventEmitter:i,handleUploadUpdate:s,index:a}=z.getState(),c={value:{taskStatus:e},type:I.RecordedTask,questionId:(n==null?void 0:n.questionId)||1};!n||i.emit(J.FinishTask,{[N.BeginCallback]:d=>{s({mediaRecordingUid:d,isSubmitted:!0,progressPct:0,isComplete:!1})},[N.ProgressCallback]:(d,l)=>{s({mediaRecordingUid:d,progressPct:l.detail,isSubmitted:!1,isComplete:!1})},[N.UploadCallback]:d=>{d&&s({mediaRecordingUid:d,isComplete:!0,isSubmitted:!0,progressPct:100})},[N.PassthroughData]:n,[N.CurrentIndex]:a,[N.TaskResponse]:c,[N.TaskCompleteCallback]:d=>{c.value.taskDurationMillisecond=d,r&&(c.value.mediaRecordingUids=r),o(),t(c)}})}function wn({pages:e,setIsRequestingPermission:t}){const{recorderEventEmitter:n,eventEmitFn:r}=z.getState(),{updatePage:o,currentPage:i,recordingMediaTypes:s,screenPermissionRequested:a}=_e.getState();if(!i)return;const c=e.indexOf(i);switch(i.type){case oe.AvPermission:{const d=a?c+2:c+1;a&&s&&n.emit(J.BeginRecording,{[N.RecordingMediaTypes]:s,[N.StartRecordingCallback]:l=>{o({mediaRecordingUids:l})}}),o({currentPage:e[d]});return}case oe.ScreenPermission:n.emit(J.ScreenPermission,{[N.ScreenPermissionRequested]:t,[N.StreamReadyCallback]:(d,l)=>{const m=l?e[c+1]:i;l&&s&&n.emit(J.BeginRecording,{[N.RecordingMediaTypes]:s,[N.StartRecordingCallback]:p=>{o({captureStream:l,mediaRecordingUids:p})}}),o({currentPage:m,screenPermissionRequested:!0,captureStream:l})}});return;case oe.StartTask:r(re.RecordedTaskStart),n.emit(re.RecordedTaskStart),n.emit(J.StartTask),o({currentPage:e[c+1],screenPermissionRequested:!0});return;case oe.CompleteTask:return}}const qo="ul-permission-graphics-container",Wo="ul-permission-body",Go=R([qo,"ul_recorded-task-inset-spacing"]),jt=R(["ul-horizontal-button-container","ul-horizontal-button-container-left"]),Ko=({richTextBody:e})=>u("div",{className:"ul-rich-text-body",dangerouslySetInnerHTML:{__html:e},id:"ul-task-detail-container"}),At=({required:e,skipButtonText:t,bottom:n=!1})=>e?null:u(te,{className:R([n&&"ul-skip-button-below",k.InactiveButton]),onClick:yn.bind(null,{status:de.Abandoned}),children:t||"Skip"}),bn=e=>{const{avStream:t,captureStream:n,recordingMediaTypes:r,updatePage:o}=_e.getState(),i=(r==null?void 0:r.includes(ce.Audio))||(r==null?void 0:r.includes(ce.Video));ie(()=>{const s=setInterval(()=>{i&&t&&!t.active?o({avStream:null,currentPage:e[0]}):(!n||!n.active)&&o({captureStream:void 0,currentPage:e[i?1:0]})},1e3);return()=>clearInterval(s)},[t,n,i,e,r,o])},Fa=({content:e,pages:t,required:n})=>{const{buttonText:r,skipButtonText:o,taskDetail:i}=e;return bn(t),u("div",{className:"ul-task-page",children:[u(Ko,{richTextBody:i}),u("div",{className:jt,children:[u(te,{onClick:wn.bind(null,{pages:t}),children:r}),u(At,{required:n,skipButtonText:o})]})]},"start-task")},$a=({content:e,pages:t,properties:n})=>{const{buttonText:r,skipButtonText:o}=e;bn(t);const s=u(Pe,{properties:n,defaultBody:()=>u("div",{className:jt,children:[u(te,{className:"ul-complete-task-button",onClick:yn.bind(null,{status:de.Completed}),children:r}),u(te,{className:R([k.InactiveButton]),onClick:yn.bind(null,{status:de.GivenUp}),children:o})]})});return u("div",{className:"ul-task-page",children:[u(Ko,{richTextBody:e.taskDetail}),s]},"complete-task")},Ha=({content:e,pages:t,required:n})=>{const{buttonText:r,skipButtonText:o}=e,[i]=z(c=>[c.tabTitle]),[s,a]=Z(!1);return u("div",{children:[u("div",{className:Go,children:[u("p",{style:{marginTop:"auto"},children:e.selectTabText}),u("div",{className:"ul-select-tab-container",children:u("p",{className:Wo,children:i})})]}),u("div",{className:n?"":jt,children:[u(te,{disabled:s,onClick:wn.bind(null,{pages:t,setIsRequestingPermission:a}),children:r}),u(At,{required:n,skipButtonText:o})]})]})},za=({content:e})=>u("div",{className:R([qo,"ul_permission_svg_container","ul_recorded-task-inset-spacing","ul-center-horizontally"]),dangerouslySetInnerHTML:{__html:e.svg}},"ul-permission-request-graphic"),qa=({content:e,pages:t,required:n})=>{const{permissionDeniedHeadline:r,permissionDeniedBody:o,skipButtonText:i,tryAgainButtonText:s}=e,a=Rt(t[0])?t[0]:null;return ie(()=>{const c=setInterval(()=>{a!==null&&_n({currentPage:a,pages:t})},1e3);return()=>clearInterval(c)},[a,t]),a?u("div",{children:[u("div",{className:Go,children:u("p",{className:"ul-av-permission-denied-paragraph",children:[u("span",{className:"ul-av-permission-denied-headline",children:r}),u("span",{className:Wo,children:o})]})}),u("div",{className:jt,children:[u(te,{onClick:_n.bind(null,{currentPage:a,pages:t}),children:s}),u(At,{required:n,skipButtonText:i})]})]}):null},Wa=({stream:e})=>u("video",{autoPlay:!0,className:R(["ul_recorded-task-inset-spacing"]),id:"ul-record-task-video-preview",muted:!0,ref:t=>{t&&(t.srcObject=e||null)}}),Ga=({content:e,pages:t,required:n})=>{const{skipButtonText:r}=e,{avStream:o}=_e.getState();return bn(t),u("div",{children:[u(Wa,{stream:o}),u("div",{className:"ul-vertical-button-container-center",children:[u(te,{onClick:wn.bind(null,{pages:t}),children:e.buttonText}),u(At,{bottom:!0,required:n,skipButtonText:r})]})]})},Ka=({properties:e})=>{const{pages:t,required:n}=e,{avStream:r,currentPage:o}=_e.getState();if(o===void 0)return null;switch(o==null?void 0:o.type){case oe.AvPermission:{const i=Ho(r,o);return i===Te.RequestNeeded?u(za,{content:o}):i===Te.TryAgain?u(qa,{content:o,pages:t,required:n}):u(Ga,{content:o,pages:t,required:n})}case oe.ScreenPermission:return u(Ha,{content:o,pages:t,required:n});case oe.StartTask:return u(Fa,{content:o,pages:t,required:n});case oe.CompleteTask:return u($a,{content:o,pages:t,properties:e});default:return null}},Za=({className:e,properties:t,next:n,questionId:r})=>{const o=z(),{headers:i,surveyId:s,responseGroupUid:a,userId:c}=o,d=_e(),{screenPermissionRequested:l}=d,m=_e(v=>v.avStream);let p=_e(v=>v.currentPage);p||(p=Ba({questionId:r,surveyId:s,next:v=>{n(v)},pages:t.pages,responseGroupUid:a,userId:c}));let f=p.headline,h=p.captionText;const g=Ho(m,p);return $o(p)&&l&&(f=p.permissionDeniedHeadline,h=p.permissionDeniedCaptionText),Rt(p)&&g===Te.Ready&&(f=p.permissionGrantedHeadline,h=p.permissionGrantedCaptionText),u("div",{className:R([...me(k.CardMainContent,i["userleap-platform"])]),children:u("div",{className:R([e,"ul-center-horizontally",k.FadeInTransition]),children:[u(ve,{message:f,properties:{captionText:h}}),u(Ka,{properties:t})]})})},Ya={"{{user_id}}":"externalUserId","{{email}}":"email"},Qa=(e=void 0,t={})=>{if(!e)return e;let n=e;const r=[];for(const[c,d]of Object.entries(Ya))if(n.toLowerCase().includes(c))if(t[d]){const l=new RegExp(c,"gi");n=n.replace(l,t[d])}else r.push(c);if(r.length===0||!n.includes("?"))return n;const o=n.slice(0,n.indexOf("?")),s=n.slice(n.indexOf("?")+1).split("&").map(c=>c.split("=")).filter(c=>!r.includes(c[1]));if(s.length===0)return o;const a=s.map(c=>c.join("=")).join("&");return`${o}?${a}`},Ja=({className:e,message:t,next:n,properties:r,questionId:o,type:i})=>{const{headers:s,visitorAttributes:a}=z(f=>({headers:f.headers,visitorAttributes:f.visitorAttributes})),c=s["userleap-platform"],d=(f,h=!1)=>{n({value:h?{skipped:!0}:void 0,questionId:o,type:i})},l=f=>{(f.key==="Enter"||f.key===" ")&&n({value:void 0,questionId:o,type:i})},m=()=>u("div",{className:"ul-card-button-group",children:[u("a",{className:"ul-card-text__button ul-card__text-url-prompt-button",href:Qa(r&&r.buttonUrl,a),id:"ul-card-text__button",onClick:d,onKeyPress:l,rel:"noreferrer",role:"button",tabIndex:0,target:"_blank",children:tt(r)}),r.required===!1&&u("button",{className:"ul-card-skip__button",onClick:f=>d(f,!0),children:vn(r)})]}),p=(f,h)=>f?u("div",{className:"ul-rich-text-body",dangerouslySetInnerHTML:{__html:f},id:"ul-card__text-url-body-container"}):u("div",{className:"ul-rich-text-body",id:"ul-card__text-url-body-container",children:(h?h.split(/\n\s*\n/g):[]).map((g,v)=>u("p",{children:g},v))});return u("div",{className:R(me(k.CardMainContent,c)),children:u("div",{className:R([e,"ul-card__text-url-prompt",k.FadeInTransition]),children:[u(ve,{message:t}),p(r&&r.richTextBody,r&&r.body),u(Pe,{defaultBody:m,properties:r})]},o)})},Xa=({className:e,questionId:t})=>{const{border:n,destroy:r,endCard:o,headers:i}=z(c=>({border:c.border,endCard:c.endCard,destroy:c.destroy,headers:c.headers}));ie(()=>{setTimeout(()=>{r(We)},2e3)},[r]);const s=o&&o.subheader?u("p",{className:k.Caption,children:o.subheader}):null,a=o&&o.headline?o.headline:"";return u("div",{className:R(me(k.CardMainContent,i["userleap-platform"])),children:u("div",{className:R([e,"ul-card--thanks",k.FadeInTransition]),children:u("div",{children:u("div",{className:"ul-card--thanks-content",children:[u("div",{className:"ul-thanks-check",children:u("svg",{"aria-labelledby":"title",fill:"none",height:"99",viewBox:"0 0 81 99",width:"81",xmlns:"http://www.w3.org/2000/svg",children:[u("path",{clipRule:"evenodd",d:"M40.5 77C60.9345 77 77.5 60.4345 77.5 40C77.5 19.5655 60.9345 3 40.5 3C20.0655 3 3.5 19.5655 3.5 40C3.5 60.4345 20.0655 77 40.5 77ZM80.5 40C80.5 62.0914 62.5914 80 40.5 80C18.4086 80 0.5 62.0914 0.5 40C0.5 17.9086 18.4086 0 40.5 0C62.5914 0 80.5 17.9086 80.5 40Z",fill:n,fillRule:"evenodd"}),u("path",{clipRule:"evenodd",d:"M55.025 22.9046C55.6299 23.4705 55.6616 24.4198 55.0956 25.0247C54.8724 25.2634 54.6109 25.5285 54.3157 25.8277C52.2547 27.9168 48.5549 31.667 44.8135 39.6658C43.2818 42.9406 42.0864 45.8386 41.0823 48.2729C40.6539 49.3116 40.2603 50.2659 39.8902 51.129C39.287 52.5359 38.7248 53.7508 38.1744 54.625C37.8997 55.0613 37.5806 55.4905 37.2017 55.8245C36.8201 56.1607 36.2613 56.5 35.5457 56.5C34.6742 56.5 34.0892 55.9692 33.7774 55.6083C33.4502 55.2296 33.1752 54.7511 32.9396 54.301C32.7305 53.9013 32.5088 53.4367 32.2797 52.9565C32.2429 52.8794 32.2059 52.8019 32.1688 52.7243C31.8942 52.1499 31.5959 51.534 31.2537 50.8868C29.8886 48.305 27.8539 45.2878 24.2343 43.1382C23.522 42.7152 23.2875 41.7949 23.7105 41.0826C24.1335 40.3703 25.0539 40.1358 25.7662 40.5588C30.0556 43.1062 32.4149 46.6647 33.9058 49.4845C34.2776 50.1876 34.5973 50.8487 34.8753 51.4302C34.9147 51.5124 34.9529 51.5926 34.9902 51.6707C35.2222 52.1567 35.4164 52.5637 35.5978 52.9102C35.6151 52.9434 35.6321 52.9754 35.6485 53.0061C36.0565 52.3531 36.5341 51.3434 37.133 49.9468C37.4781 49.1418 37.8572 48.2229 38.2761 47.2074C39.2886 44.7532 40.5339 41.7347 42.0961 38.3948C46.0591 29.9221 50.0641 25.8648 52.1535 23.7482C52.4423 23.4556 52.6944 23.2002 52.9048 22.9753C53.4708 22.3703 54.42 22.3387 55.025 22.9046ZM35.1994 53.5892C35.1994 53.5892 35.2 53.5888 35.2012 53.5879C35.2 53.5889 35.1994 53.5893 35.1994 53.5892ZM36.0666 53.6682C36.0732 53.674 36.0765 53.6775 36.0765 53.6777C36.0765 53.678 36.0732 53.6751 36.0666 53.6682Z",fill:n,fillRule:"evenodd"}),u("path",{d:"M69.5 97C69.5 98.1046 56.2924 99 40 99C23.7076 99 10.5 98.1046 10.5 97C10.5 95.8954 23.7076 95 40 95C56.2924 95 69.5 95.8954 69.5 97Z",fill:"black",fillOpacity:"0.2"})]})}),u(ve,{message:a}),s]})})},t)})},He="https://cdn.sprig.com",U={document:void 0,videojs:void 0},el=`/* progress control styles */
.video-js .vjs-control {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
}

.video-js .vjs-progress-control .vjs-progress-holder {
  margin: 0 0px;
}

.video-js .vjs-progress-control {
  position: absolute;
  height: 3px;
  width: 100%;
}
/* position and align the buttons and button texts */
.ul-control-panel {
  bottom: 0;
  width: 100%;
  flex-direction: column;
  background-color: white;
  height: fit-content;
  z-index: 2;
}

.ul-buttons-panel {
  color: black;
  display: flex;
  gap: 20px;
  height: 50px;
  justify-content: center;
  margin: 10px;
  padding: 2px 14px 0;
}

.video-js .vjs-volume-panel {
  height: 30px;
  width: 40px;
}

.ul-inactive {
  opacity: 0.3;
  cursor: default;
  pointer-events: none;
}

/* buttons */
.ul-buttons-panel > .vjs-button {
  background-color: rgba(0, 0, 0, 0.05);
  border-radius: 50%;
  display: flex;
  height: 3em;
  justify-content: center;
  width: 3em;
}

.vjs-button>.vjs-icon-placeholder:before {
  align-items: center;
  display: flex;
  font-size: unset;
  line-height: 0.5;
  justify-content: center;
}

span.ul-button-text {
  align-self: flex-end;
  position: relative;
  top: 14px;
}

#ul-camera-button {
  white-space: nowrap;
}

.video-js .vjs-volume-control.vjs-volume-horizontal {
  background-color: #fff;
  z-index: 1;
}

.vjs-volume-bar.vjs-slider-horizontal .vjs-volume-level {
  background-color: black;
}

.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-hover,
.video-js .vjs-volume-panel.vjs-volume-panel-horizontal.vjs-slider-active,
.video-js .vjs-volume-panel.vjs-volume-panel-horizontal:active {
  width: 40px;
}

.video-js .vjs-volume-panel .vjs-volume-control.vjs-slider-active,
.video-js .vjs-volume-panel .vjs-volume-control:active,
.video-js .vjs-volume-panel.vjs-hover .vjs-mute-control ~ .vjs-volume-control,
.video-js .vjs-volume-panel.vjs-hover .vjs-volume-control,
.video-js .vjs-volume-panel:active .vjs-volume-control,
.video-js .vjs-volume-panel:focus .vjs-volume-control {
  visibility: visible;
  left: 40px;
  position: absolute;
  transition: visibility 0.1s, opacity 0.1s, height 0.1s, width 0.1s, left 0s, top 0s;
}

/* play button customization */
.video-js .vjs-play-control {
  color: black;
}

.video-js .vjs-play-control .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5363 6.40226L1.93958 10.7006C1.64037 10.8502 1.28833 10.6326 1.28833 10.2981V1.7014C1.28833 1.36688 1.64037 1.14931 1.93958 1.29891L10.5363 5.59727C10.868 5.76311 10.868 6.23642 10.5363 6.40226Z' stroke='black' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
}

/* position and style the current timer */
.ul-time-panel {
  position: absolute;
  bottom: 80px;
  left: 10px;
  height: 22px;
  color: black;
  border: 1px solid #e0e0eb;
  border-radius: 23px;
  background-color: white;
  width: fit-content;
}

.video-js .vjs-current-time,
.vjs-no-flex .vjs-current-time {
  display: flex;
  align-items: center;
  text-align: center;
}

/* remove the dot progress indicator */
.video-js .vjs-play-progress:before,
.video-js .vjs-volume-level:before,
.vjs-icon-circle:before,
.vjs-seek-to-live-control .vjs-icon-placeholder:before {
  content: none;
}

.video-js .vjs-mute-control .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='19' height='14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.825.324A.75.75 0 019.25 1v11.667a.75.75 0 01-1.219.585l-3.96-3.169H1a.75.75 0 01-.75-.75v-5a.75.75 0 01.75-.75h3.07L8.031.414a.75.75 0 01.794-.09zM7.75 2.56L4.802 4.92a.75.75 0 01-.469.164H1.75v3.5h2.583a.75.75 0 01.469.165l2.948 2.358V2.56zM14.911.47a.75.75 0 011.061 0 9.084 9.084 0 010 12.844.75.75 0 01-1.06-1.06 7.584 7.584 0 000-10.724.75.75 0 010-1.06zM11.97 3.41a.75.75 0 011.06 0 4.917 4.917 0 010 6.953.75.75 0 11-1.06-1.06 3.417 3.417 0 000-4.832.75.75 0 010-1.06z' fill='%23262136'/%3E%3C/svg%3E");
}

.video-js .vjs-mute-control.vjs-vol-0 .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='19' height='14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8.5 1.167L4.333 4.5H1v5h3.333L8.5 12.833V1.167zM17.17 4.5l-5 5M12.17 4.5l5 5' stroke='%23262136' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
}

.video-js .vjs-mute-control.vjs-vol-1 .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='19' height='14' viewBox='0 0 19 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.82489 0.32403C9.08474 0.44892 9.25 0.711703 9.25 1.00001V12.6667C9.25 12.955 9.08474 13.2178 8.82489 13.3427C8.56504 13.4675 8.25661 13.4324 8.03148 13.2523L4.07025 10.0833H1C0.585786 10.0833 0.25 9.74755 0.25 9.33334V4.33334C0.25 3.91913 0.585786 3.58334 1 3.58334H4.07025L8.03148 0.414355C8.25661 0.234253 8.56504 0.19914 8.82489 0.32403ZM7.75 2.56048L4.80185 4.91899C4.66887 5.02538 4.50364 5.08334 4.33333 5.08334H1.75V8.58334H4.33333C4.50364 8.58334 4.66887 8.6413 4.80185 8.74769L7.75 11.1062V2.56048Z' fill='%23262136'/%3E%3C/svg%3E%0A");
}

.video-js .vjs-mute-control.vjs-vol-2 .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='19' height='14' viewBox='0 0 19 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.82489 0.32403C9.08474 0.44892 9.25 0.711703 9.25 1.00001V12.6667C9.25 12.955 9.08474 13.2178 8.82489 13.3427C8.56504 13.4675 8.25661 13.4324 8.03148 13.2523L4.07025 10.0833H1C0.585786 10.0833 0.25 9.74755 0.25 9.33334V4.33334C0.25 3.91913 0.585786 3.58334 1 3.58334H4.07025L8.03148 0.414355C8.25661 0.234253 8.56504 0.19914 8.82489 0.32403ZM7.75 2.56048L4.80185 4.91899C4.66887 5.02538 4.50364 5.08334 4.33333 5.08334H1.75V8.58334H4.33333C4.50364 8.58334 4.66887 8.6413 4.80185 8.74769L7.75 11.1062V2.56048Z' fill='%23262136'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.9698 3.41124C12.2627 3.11839 12.7376 3.11846 13.0304 3.4114C13.9521 4.33341 14.4699 5.58376 14.4699 6.88748C14.4699 8.19121 13.9521 9.44156 13.0304 10.3636C12.7376 10.6565 12.2627 10.6566 11.9698 10.3637C11.6768 10.0709 11.6767 9.596 11.9696 9.30307C12.6101 8.66235 12.9699 7.79346 12.9699 6.88748C12.9699 5.98151 12.6101 5.11262 11.9696 4.4719C11.6767 4.17896 11.6768 3.70409 11.9698 3.41124Z' fill='%23262136'/%3E%3C/svg%3E%0A");
}

.video-js .vjs-volume-control:hover .vjs-mouse-display {
  display: none !important;
}

.video-js .vjs-play-progress {
  background-color: black;
}

/* position video player inside the container */
.video-js .vjs-tech {
  position: static;
}

.video-js .vjs-time-tooltip {
  padding: 0.25em 0.75em;
  align-items: center;
  color: #333;
  background: #FCFCFD;
  border-radius: 99px;
  text-align: center;
  border: 1px solid #E0E0EB;
  display: flex;
  align-items: center;
  justify-content: center;
  top: -25px;
  font-size: 12px !important;
  width: 50px !important;
}

.video-js .vjs-play-progress.vjs-slider-bar .vjs-time-tooltip {
  visibility: hidden !important;
}

.video-js .vjs-progress-control .vjs-mouse-display {
  z-index: 2;
}

.ul-video-player {
  width: 100%;
  display: flex;
  flex-direction: column;
  height: auto;
  border: 1px solid #E6E6E6;
  background-color: white;
  box-sizing: border-box;
  border-radius: 4px;
  background-clip: border-box;
  overflow: hidden;
}

.video-js.vjs-fullscreen:not(.vjs-ios-native-fs) {
  border: none;
}

#video-response-player-secondary-video-player {
  max-width: 200px;
  margin-right: 20px;
  background-color: transparent;
}

#ul-card-video__player_recorder-video-recorder.vjs-fullscreen {
  display: table;
}

.video-js div.vjs-progress-control {
  margin-top: -3px;
}

.video-js .vjs-progress-control .vjs-slider {
  background-color: #B2BBBD;
}

.vjs-record.video-js .vjs-control.vjs-button.vjs-fullscreen-control {
  position:relative;
}

.video-js .vjs-fullscreen-control .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.82143 2.54004L12.2614 2.54004C12.9242 2.54004 13.4614 3.0773 13.4614 3.74004L13.4614 6.18004' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M6.17955 13.46L3.73955 13.46C3.07681 13.46 2.53955 12.9227 2.53955 12.26L2.53955 9.81996' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M12.7772 3.22266L9.36475 6.63516' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M6.29434 9.70605L2.88184 13.1186' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
}

.video-js.vjs-fullscreen .vjs-fullscreen-control .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1.583 9.813H5.25a1 1 0 011 1v3.666M5.375 10.688L1 15.061M14.917 5.813H11.25a1 1 0 01-1-1V1.146M15.063 1l-4.376 4.375' stroke='%23262136' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
}

.video-js .vjs-play-control.vjs-ended .vjs-icon-placeholder:before, .video-js .vjs-icon-replay:before {
  content: url("data:image/svg+xml,%3Csvg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5363 6.40226L1.93958 10.7006C1.64037 10.8502 1.28833 10.6326 1.28833 10.2981V1.7014C1.28833 1.36688 1.64037 1.14931 1.93958 1.29891L10.5363 5.59727C10.868 5.76311 10.868 6.23642 10.5363 6.40226Z' stroke='black' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
}

.video-js .vjs-play-control.vjs-playing .vjs-icon-placeholder:before, .vjs-icon-pause:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Crect x='3.61885' y='2.06074' width='3.16185' height='11.88' rx='0.9' fill='black' stroke='%23EDEDED' stroke-width='0.6' stroke-linecap='round'/%3E%3Crect x='9.21797' y='2.06074' width='3.16185' height='11.88' rx='0.9' fill='black' stroke='%23EDEDED' stroke-width='0.6' stroke-linecap='round'/%3E%3C/svg%3E%0A");
  padding: 2px;
}

.vjs-error-display {
  display: none;
}

.ul-video-player-video {
  position: relative;
  top: 0;
  left: 0;
  width: 100%;
}

.ul-video-container {
  width: 100%;
  height: auto;
  left: 0px;
  top: 0px;

  background-color: transparent;
  border-radius: 4px;

  align-items: start;
  display: flex;
  flex-direction: column;

  /* Inside Auto Layout */

  flex: none;
  order: 0;
  flex-grow: 0;
  margin: 10px 0px;
  position: relative;
}

.vjs-record button.vjs-device-button.vjs-control {
  background: rgba(255, 255, 255, 96);
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
  margin: 0;
  border-radius: 0;
  line-height: 0.6;
  padding: 10px;
  display: flex;
  align-items: center;
  flex-direction: column;
  justify-content: center;
  z-index: 3;
}

.vjs-record .vjs-device-button.vjs-control:before {
  font-size: 14px !important;
  color: #333;
  content: "Your browser needs to access your camera and microphone for video recording";
  line-height: 135%;
}

.vjs-record .vjs-device-button.vjs-control.permission-denied:before {
  font-size: 16px !important;
  color: #262136;
  content: "Unable to access your camera and microphone";
}

.vjs-record .vjs-device-button.vjs-control:after {
  display: inline-block;
  background: #F0F0F5;
  font-size: 13px;
  border-radius: 4px;
  content: "Request Permissions";
  padding: 1em 2em;
  color: #333;
  margin-top: 20px;
}

.vjs-record .vjs-device-button.vjs-control.permission-denied:after {
  display: inline-block;
  background: white;
  font-size: 13px;
  content: "Please go to your browser settings and update permissions to enable recording";
  padding: 1em;
  color: #4B575D;
  margin: 5px;
  line-height: 135%;
  text-align: center;
}

.vjs-control.vjs-button.ul-video-recorder-delete-button, .vjs-control.vjs-button.ul-video-recorder-toggle-button, .vjs-control.vjs-button.ul-video-recorder-camera-off-button-audio-only, .vjs-control.vjs-button.ul-video-recorder-camera-off-button {
  cursor: pointer;
}

.ul-video-recorder-delete-button .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.21234 7.37549V11.1193M2.53931 4.25595H13.4593H2.53931ZM5.57234 4.25595V3.00833C5.57222 2.84433 5.60354 2.68192 5.6645 2.53038C5.72546 2.37884 5.81488 2.24115 5.92762 2.12519C6.04037 2.00922 6.17424 1.91726 6.32158 1.85456C6.46892 1.79185 6.62683 1.75964 6.78628 1.75977H9.21234C9.37179 1.75964 9.5297 1.79185 9.67703 1.85456C9.82437 1.91726 9.95824 2.00922 10.071 2.12519C10.1837 2.24115 10.2732 2.37884 10.3341 2.53038C10.3951 2.68192 10.4264 2.84433 10.4263 3.00833V4.25595H5.57234ZM12.2463 4.25595V12.9912C12.2463 13.3223 12.1184 13.6399 11.8907 13.8741C11.6631 14.1082 11.3543 14.2398 11.0323 14.2398H4.96628C4.64432 14.2398 4.33555 14.1082 4.10789 13.8741C3.88023 13.6399 3.75234 13.3223 3.75234 12.9912V4.25595H12.2463ZM6.78628 7.37549V11.1193V7.37549Z' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E%0A");
}

.ul-video-recorder-toggle-button .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0Z' fill='%23D15153'/%3E%3C/svg%3E");
}

.ul-video-recorder-toggle-button.ul-recording-in-session .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 10L12 2C12 0.89543 11.1046 -4.85396e-07 10 -4.37114e-07L2 -8.74228e-08C0.89543 -3.91405e-08 -4.85396e-07 0.895431 -4.37114e-07 2L-8.74228e-08 10C-3.91405e-08 11.1046 0.895431 12 2 12L10 12C11.1046 12 12 11.1046 12 10Z' fill='%23D15153'/%3E%3C/svg%3E%0A");
}

.ul-video-recorder-camera-off-button .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_2645_4654)'%3E%3Cpath d='M15.1491 4.75L10.5991 8L15.1491 11.25V4.75Z' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M9.29912 3.4502H2.14912C1.43115 3.4502 0.849121 4.03223 0.849121 4.7502V11.2502C0.849121 11.9682 1.43115 12.5502 2.14912 12.5502H9.29912C10.0171 12.5502 10.5991 11.9682 10.5991 11.2502V4.7502C10.5991 4.03223 10.0171 3.4502 9.29912 3.4502Z' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_2645_4654'%3E%3Crect width='15.6' height='15.6' fill='white' transform='translate(0.199951 0.200195)'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E");
}

.ul-video-recorder-camera-off-button-audio-only .vjs-icon-placeholder:before {
  content: url("data:image/svg+xml,%3Csvg width='22' height='15' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M.75 3A2.75 2.75 0 013.5.25h9.081A2.75 2.75 0 0115.331 3v9a2.75 2.75 0 01-2.75 2.75H3.5A2.75 2.75 0 01.75 12V3zM3.5 1.75c-.69 0-1.25.56-1.25 1.25v9c0 .69.56 1.25 1.25 1.25h9.081c.69 0 1.25-.56 1.25-1.25V3c0-.69-.56-1.25-1.25-1.25H3.5z' fill='%23262136'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.53 2.03l-12 12-1.06-1.06 12-12 1.06 1.06zM20.87 1.525a.75.75 0 01.38.652v10.588a.75.75 0 01-1.134.644l-5.92-3.53a.75.75 0 01-.365-.643v-3.53a.75.75 0 01.366-.644l5.919-3.53a.75.75 0 01.754-.007zm-5.539 4.607V8.81l4.419 2.635V3.497l-4.419 2.635z' fill='%23262136'/%3E%3C/svg%3E");
  transform: scale(0.75);
}

.ul-upload-progress-label {
  padding: 0.15em 0.75em;
  align-items: center;
  font-size: 12px;
  color: #333;
  background: #FCFCFD;
  border-radius: 99px;
  text-align: center;
  border: 1px solid #E0E0EB;
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  bottom: 75px;
  left: calc(50% - 65px);
  width: 130px;
  z-index: 5;
}

.ul-upload-progress-label__time {
  display: inline-flex;
  margin-left: 0.8em;
  align-items: center;
}

.ul-upload-progress-label__time:before {
  content: "";
  display: inline-flex;
  width: 1px;
  height: 12px;
  background-color: #E0E0EB;
  margin-right: 0.8em;
}

@keyframes grow {
  0% {
    transform: scale(1);
    background-color: #EEECFC;
  }
  50%  {
    transform: scale(1.2);
    background-color: #E1DFF4;
  }
  100% {
    transform: scale(1);
    background-color: #EEECFC;
  }
}

.ul-audio-recorder-placeholder:before {
  width: 80px;
  height: 80px;
  border-radius: 120px;
  background-color: #EEECFC;
  content: "";
  position: absolute;
  left: calc(50% - 40px);
  top: calc(50% - 40px);
  animation: 6s infinite grow;
  transform-origin: 50% 60%;
}

.ul-audio-recorder-placeholder:after {
  content: url("data:image/svg+xml,%3Csvg width='98' height='98' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cmask id='a' maskUnits='userSpaceOnUse' x='0' y='0' width='98' height='98'%3E%3Ccircle cx='49' cy='49' r='49' fill='%23EDECF8'/%3E%3C/mask%3E%3Cg mask='url(%23a)'%3E%3Ccircle cx='49' cy='49' r='50' fill='%23645CC2'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.422 81.812c5.405-15.547 20.187-26.706 37.576-26.706 17.39 0 32.172 11.159 37.577 26.707-9.164 10.43-22.601 17.013-37.576 17.013-14.976 0-28.414-6.583-37.577-17.014z' fill='%23fff' fill-opacity='.6'/%3E%3Ccircle cx='49' cy='29' r='17' fill='%23fff' fill-opacity='.7'/%3E%3C/g%3E%3C/svg%3E");
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform: translate(-50%, -50%) scale(0.6);
}

.ul-audio-recorder-placeholder {
  min-height: 150px;
  width: 100%;
  background-color: #fcfcfd;
  display: block;
  position: relative;
}

.vjs-fullscreen .ul-audio-recorder-placeholder {
  vertical-align: middle;
  display: table-cell;
}

.vjs-fullscreen .ul-control-panel {
  height: 80px;
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  max-width: 100%;
  background-color: #F8F8F8;
}

.vjs-playback-rate .vjs-playback-rate-value {
  align-items: center;
  display: flex;
  font-size: 12px;
  justify-content: center;
}

.vjs-playback-rate .vjs-menu {
  left: -5px;
  bottom: 3px;
}

.vjs-menu-button-popup .vjs-menu .vjs-menu-content {
  background-color: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-sizing: border-box;
  border-radius: 4px;
}

.vjs-menu li {
  font-size: 12px;
  padding: 5px 0;
}

.vjs-menu li.vjs-selected {
  color: lightgray;
}

.vjs-menu li.vjs-menu-item:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.vjs-fullscreen .ul-buttons-panel {
  top: calc(50% - 30px);
  position: relative;
}

.vjs-fullscreen .vjs-record-indicator.vjs-control {
  bottom: 90px !important;
}

.vjs-record.video-js div.vjs-control.vjs-record-indicator {
  padding: 0.3em 0.75em 0.15em 15px;
  align-items: center;
  font-size: 12px;
  color: #333;
  background: #FCFCFD;
  border-radius: 99px;
  text-align: center;
  border: 1px solid #E0E0EB;
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 75px;
  top: auto;
  left: calc(50% - 21px);
  width: 43px;
  height: 16px;
  z-index: 4;
}

.vjs-record.video-js div.vjs-control.vjs-record-indicator:after {
  content: "";
  background-color: #EB5757;
  width: 6px;
  height: 6px;
  border-radius: 8px;
  animation: none;
  top: 4px;
  left: 5px;
}

.vjs-record.video-js div.vjs-control.vjs-record-indicator:before {
  position: relative;
  font-size: 9px;
  animation: none;
  opacity: 1;
  color: #333;
  top: auto;
  left: auto;
}

.ul-video-player-loading {
  display: inline-block;
  position: relative;
  width: 6rem;
  height: 6rem;

}
.ul-video-player-loading div {
  box-sizing: border-box;
  position: absolute;
  display: block;
  width: 80%;
  height: 80%;
  margin: 5px;
  border: 5px solid #666;
  border-radius: 50%;
  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
  border-color: #666 transparent transparent transparent;
}

.first {
  animation-delay: -0.45s;
}
.second {
  animation-delay: -0.3s;
}
.third {
  animation-delay: -0.15s;
}

@keyframes lds-ring {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.ul-video-btn {
  width: 100%;
  border: 1px solid #E6E6E6;
  border-radius: 4px;
  background-color: rgba(0, 0, 0, 0.02);
  padding: 8px;
  font-weight: 500;
  font-size: 15px;
}

.ul-record-response-btn:before, .ul-record-response-btn:after, .ul-back-question-btn:before, .ul-back-question-btn:after {
  margin: 0 5px;
  vertical-align: middle;
}

.ul-record-response-btn:before {
  content: url("data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_2645_4654)'%3E%3Cpath d='M15.1491 4.75L10.5991 8L15.1491 11.25V4.75Z' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M9.29912 3.4502H2.14912C1.43115 3.4502 0.849121 4.03223 0.849121 4.7502V11.2502C0.849121 11.9682 1.43115 12.5502 2.14912 12.5502H9.29912C10.0171 12.5502 10.5991 11.9682 10.5991 11.2502V4.7502C10.5991 4.03223 10.0171 3.4502 9.29912 3.4502Z' stroke='black' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_2645_4654'%3E%3Crect width='15.6' height='15.6' fill='white' transform='translate(0.199951 0.200195)'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E");
  display: inline-block;
  transform: translate(0px, 2px);
}

.ul-record-response-btn:after {
  content: 'Record your Response';
}

.ul-back-question-btn:before {
  content: url("data:image/svg+xml,%3Csvg width='15' height='16' viewBox='0 0 15 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13.8757 8.22361L1.1118 14.6056C0.945578 14.6887 0.75 14.5678 0.75 14.382V1.61803C0.75 1.43219 0.945579 1.31131 1.1118 1.39443L13.8757 7.77639C14.06 7.86852 14.06 8.13148 13.8757 8.22361Z' stroke='black' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
  display: inline-block;
  transform: scale(0.85) translate(0, 1px);
  -moz-transform: scale(0.85) translate(0, 2px);
}

.ul-back-question-btn:after {
  content: 'Back to Question';
}

.hidden {
  display: none !important;
  opacity: 0;
  visibility: hidden;
}

.visible {
  visibility: visible;
  opacity: 1;
  animation: fade 0.3s;
}

@keyframes fade {
  0% {
      opacity: 0;
  }

  100% {
      opacity: 1;
  }
}

#ul-recording-countdown-screen {
  width: 100%;
  height: 100%;
  color: black;
  background-color: rgba(255, 255, 255, 0.8);
  position: absolute;
  text-align: center;
  font-size: 15px;
  z-index: 1;
  display: table;
}

.ul-countdown-text {
  vertical-align: middle;
  display: table-cell;
  transform: translate(0, -25px);
}

.vjs-fullscreen > #ul-recording-countdown-screen {
  font-size: 25px;
  transform: unset;
}

.vjs-poster {
  background-size: cover;
}
`,tl=e=>{const t=U.document.createElement("div");return t.className="ul-video-player-loading",t.id=xn(e),["first","second","third","fourth"].map(n=>{const r=U.document.createElement("div");r.className=n,t.appendChild(r)}),t},xn=e=>e+"-loading-spiner",G="hidden",Zo=".m3u8",Cn="questionId",kn="ul-video-recorder-camera-off-button",Sn="ul-recording-in-session",nl=[{type:"link",content:`${He}/dependencies/videojs-record-4.5.0.min.css`},{type:"script",content:`${He}/dependencies/RecordRTC-5.6.2.js`},{type:"script",content:`${He}/dependencies/adapter.8.0.0.min.js`},{type:"script",content:`${He}/dependencies/videojs-record-4.5.0.min.js`},{type:"script",content:`${He}/userleap-web-upchunk-v2.2.2.js`}],Yo=[{type:"link",content:`${He}/dependencies/video-js-7.18.0.min.css`},{type:"script",content:`${He}/dependencies/video-js-7.18.0.min.js`},{type:"style",content:el}],Qo="-video-player",Jo="-secondary-video-player",Xo="-video-recorder";let ye,ei;const De=async({event:e,apiBase:t,headers:n,visitorId:r,envId:o,metadata:i})=>{const s=U.document.documentElement;if(!r||!o)return;const a={event:`SDK - ${e}`,visitorId:r,environmentId:o,metadata:{...i||{},screenWidth:window.screen.width,screenHeight:window.screen.height,clientWidth:s.clientWidth,clientHeight:s.clientHeight,location:window.location.href,language:navigator.language}};(await fetch(`${t}/sdk/1/visitors/${r}/analytics`,{method:"POST",cache:"no-cache",headers:n,body:JSON.stringify(a)})).ok||console.warn("[Sprig] (ERR-444) Failed to track analytics",e)},Se=async(e,t,n,r,o,i)=>{De({event:`Video Error ${t}`,apiBase:n,headers:r,visitorId:o,envId:i,metadata:{errorMessage:e.message}});const s=U.document.documentElement,a={screenWidth:window.screen.width,screenHeight:window.screen.height,clientWidth:s.clientWidth,clientHeight:s.clientHeight,location:window.location.href,language:navigator.language},c={action:t,err:{message:e.message,stack:e.stack},meta:a,vid:o,envId:i};(await fetch(`${n}/sdk/1/errors`,{method:"POST",cache:"no-cache",headers:{...r,"userleap-platform":"video_recorder","x-ul-error":window.btoa(`userleap-${Date.now()}-error`)},body:JSON.stringify(c)})).ok||console.warn("[Sprig] (ERR-444) Failed to report error to API",e)},rl=(e,{type:t,content:n})=>new Promise(function(r,o){let i;t==="script"?(i=U.document.createElement("script"),i.src=n):t==="link"?(i=U.document.createElement("link"),i.rel="stylesheet",i.href=n,i.type="text/css"):(i=U.document.createElement("style"),i.innerHTML=n),i.onload=function(){r(n)},i.onerror=function(){o(n)},i.async=!1,i.id=btoa(n),e.appendChild(i)}),ti=(e,t)=>{if(e.length===0)return t&&t();Promise.all(e.reduce((n,r)=>(n.push(rl(U.document.head,r)),n),[])).then(()=>{U.videojs=U.document.defaultView.videojs,t&&t()}).catch(function(n){console.log(n+" failed to load")})},ni=(e,t,n)=>{if(t==="start"&&(e.style.visibility="visible"),t==="none")e.style.visibility=G;else if(t==="success")e.style.visibility=G,e.innerHTML="Upload succeeded!";else{const r=Math.round(parseFloat(n));e.innerHTML=`Uploading <span class="ul-upload-progress-label__time">${r}%</span>`,e.style.background=`linear-gradient(to right, #E0E0EB 0%, #E0E0EB ${r}%, #FCFCFD ${r}%, #FCFCFD 100%)`}},En=(e,t)=>{const n=U.videojs(e.id());return n==null?void 0:n.payload[t]},ol=(e,t,n,r,o)=>{const{surveyId:i,responseGroupUid:s,visitorId:a,envId:c}=e.payload;e.on("deviceError",function(){console.warn("device error: ",e.deviceErrorCode),e.deviceErrorCode.message==="Permission denied"?(e.deviceButton.addClass("permission-denied"),n&&n(j.ERROR,{type:j.PERMISSION_DENIED}),De({event:"Video Permission Denied",apiBase:t,headers:o,visitorId:a,envId:c,metadata:{questionId:En(e,Cn),responseGroupUid:s,surveyId:i}})):(n&&n(j.ERROR,{type:j.OTHER}),Se(new Error(e.deviceErrorCode.message),"recorderDeviceError",t,o,a,c))}),e.on("error",function(d,l){Se(l||e.error(),"recorderError",t,o,a,c)}),e.on("startRecord",function(d,l){r(e.uploadProgressLabel,"none"),De({event:"Video Record Start",apiBase:t,headers:o,visitorId:a,envId:c,metadata:{questionId:En(e,Cn),responseGroupUid:s,surveyId:i}})}),e.on("finishRecord",async function(){r(e.uploadProgressLabel,"start",0);const d=En(e,Cn);if(!i){const g="internal error: missing fields in payload";return n&&n(j.ERROR,{type:j.OTHER}),Se(new Error(g),"finishRecord",t,o,a,c),null}e.record().stopDevice();const l=e.cameraOff?j.MEDIA_TYPE_AUDIO:j.MEDIA_TYPE_VIDEO,m=Ee();De({event:"Video Record Finish",apiBase:t,headers:o,visitorId:a,envId:c,metadata:{mediaRecordingUid:m,questionId:d,responseGroupUid:s,surveyId:i,mediaType:l}});const p={surveyId:i,updatedAt:new Date().toISOString(),mediaType:l,mediaRecordingUid:m};d&&(p.questionId=d),s&&(p.responseGroupUid=s),a&&(p.visitorId=a);const h=await(async()=>{const g=await fetch(`${t}/2/environments/integrations/upload`,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(g.ok){const v=await g.json();return n&&n(j.UPLOAD_STARTED,{[j.UPLOAD_ID]:v.upload.id,[j.MEDIA_TYPE]:l,[j.MEDIA_RECORDING_UID]:m}),v.upload.url}else return n&&n(j.ERROR,{type:j.OTHER,response:g}),Se(new Error("failed to get upload response with url"),"finishRecord",t,o,a,c),null})();!h||(ye=U.document.defaultView.UpChunk.createUpload({endpoint:h,file:new U.document.defaultView.File([e.recordedData],`recording ${l} ${Date.now()}`),chunkSize:5120}),ye.startTime=Date.now(),De({event:"Video Upload Start",apiBase:t,headers:o,visitorId:a,envId:c,metadata:{mediaRecordingUid:m,questionId:d,responseGroupUid:s,surveyId:i,mediaType:l,url:h}}),ye.on("error",g=>{r(e.uploadProgressLabel,"none"),n&&n(j.UPLOAD_FINISHED,{[j.MEDIA_RECORDING_UID]:m}),Se(g,"finishRecord",t,o,a,c)}),ye.on("progress",g=>{n&&n(j.UPLOAD_PROGRESS,{[j.MEDIA_RECORDING_UID]:m,[j.UPLOAD_PROGRESS_PCT]:g.detail}),r(e.uploadProgressLabel,"progress",g.detail)}),ye.on("success",()=>{r(e.uploadProgressLabel,"success"),n&&n(j.UPLOAD_FINISHED,{[j.MEDIA_RECORDING_UID]:m}),De({event:"Video Upload Success",apiBase:t,headers:o,visitorId:a,envId:c,metadata:{mediaRecordingUid:m,questionId:d,responseGroupUid:s,surveyId:i,mediaType:l,url:h,elapsedMs:ye.startTime&&Date.now()-ye.startTime}})}))})},ri=(e,t)=>{const n=new(U.videojs.getComponent("Component"))(e);return n.addClass("ul-buttons-panel"),t.map(r=>{n.addChild(r)}),il(n),n},il=e=>{e.children().forEach(t=>{if(ue[t.name_]){const n=Ot(ue[t.name_],`ul-${ue[t.name_]}`);t.el_.appendChild(n)}})},Ot=(e,t="")=>{const n=U.document.createElement("span");return n.className="ul-button-text",n.innerHTML=e,n.id=t,n},oi=(e,t,n,r,o=!1,i)=>{e.addClass("ul-video-player");const s=new(U.videojs.getComponent("Component"))(e);s.addClass("ul-control-panel"),e.progressBar=s.addChild("ProgressControl"),n&&e.src(n),e.audioPlayerPlaceholder=new(U.videojs.getComponent("Component"))(e),e.audioPlayerPlaceholder.addClass("ul-audio-recorder-placeholder");const a=n&&n.src?fl(n.src):null;n&&(o||!a)?(e.children()[0].classList.add("vjs-hidden"),U.document.getElementById(`${e.id()}_html5_api`).style.height="0px"):(e.audioPlayerPlaceholder.hide(),U.document.getElementById(`${e.id()}_html5_api`).style.height="100%",a&&e.poster(a)),e.on("play",()=>{!o&&n&&!a&&ll(e,!1),i==null||i.play()}),e.on("pause",()=>{i==null||i.pause()}),e.on("seeked",()=>{i==null||i.currentTime(e.currentTime())}),e.on("ratechange",()=>{i==null||i.playbackRate(e.playbackRate())}),e.addChild(e.audioPlayerPlaceholder,{},1),s.addChild(t),e.addChild(s),r&&r(e)},sl=(e,t,n)=>{e.addClass(`ul${Jo}`);const r=new(U.videojs.getComponent("Component"))(e);t&&e.src(t),e.addChild(r),n&&n(e)},al=(e,t,n,r,o,i,s,a=!1)=>{ei=Date.now();const d=Mt(t,{controls:!1,bigPlayButton:!1,fluid:!1,width:1280,height:720,playsinline:!0,plugins:{record:{audio:!0,video:{mandatory:{minWidth:1280,minHeight:720}},frameWidth:1280,frameHeight:720,maxLength:600,autoMuteDevice:!0}}});if(!d)return;d.payload=n;const{surveyId:l,questionId:m,responseGroupUid:p,visitorId:f,envId:h}=n;let g;const v=S=>{const $=kn,y=kn+"-audio-only";ni(d.uploadProgressLabel,"none"),ye&&ye.startTime>=ei&&ye.abort();const F=U.document.getElementById("ul-camera-button");S?(d.children()[0].classList.add("vjs-hidden"),b.removeClass($),b.addClass(y),F.innerHTML=ue.TurnOnCamera,d.audioPlayerPlaceholder.removeClass("vjs-hidden"),g==null||g.getTracks().forEach(M=>{M.stop()}),window.navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(M=>{g=M,M.getVideoTracks().forEach(pe=>{pe.enabled=!1}),d.record().onDeviceReady(M)}).catch(d.record().onDeviceError.bind(d.record()))):(g==null||g.getVideoTracks().forEach(M=>{M.enabled=!0}),d.children()[0].classList.remove("vjs-hidden"),d.record().getDevice(),b.removeClass(y),b.addClass($),F.innerHTML=ue.TurnOffCamera,d.audioPlayerPlaceholder.addClass("vjs-hidden"))},w=new(U.videojs.getComponent("Button"))(d,{clickHandler:()=>{w.hasClass(G)||(De({event:"Video Delete Button Clicked",apiBase:r,headers:s,visitorId:f,envId:h,metadata:{questionId:m,responseGroupUid:p,surveyId:l}}),v(d.cameraOff),o(j.DELETE,{}),b.removeClass(G),w.addClass(G))}});w.addClass("ul-video-recorder-delete-button"),w.el_.appendChild(Ot(ue.DeleteButton,"ul-delete-button"));const _=U.document.getElementById(t),C=()=>{_.classList.contains("vjs-fullscreen")&&d.cameraOff?_.style.display="table":_.style.display="flex"};C();const b=new(U.videojs.getComponent("Button"))(d,{clickHandler:()=>{d.record().isRecording()||(d.cameraOff=!d.cameraOff,De({event:"Video Camera Button Clicked",apiBase:r,headers:s,visitorId:n.visitorId,envId:n.envId,metadata:{questionId:m,responseGroupUid:p,surveyId:l,cameraOff:d.cameraOff}}),v(d.cameraOff),!w.hasClass(G)&&w.addClass(G),o(j.DELETE,{}),C())}});b.addClass(kn),b.el_.appendChild(Ot(ue.TurnOffCamera,"ul-camera-button"));const E=new(U.videojs.getComponent("Button"))(d,{clickHandler:()=>{const S=U.document.getElementById("ul-recorder-toggle");if(d.record().isRecording())d.record().stop(),S&&(S.innerHTML=ue.RecordButton),E.removeClass(Sn),w.removeClass(G);else{const $=U.document.getElementById("ul-recording-countdown-screen");if($)$.remove(),S&&(S.innerHTML=ue.RecordButton),v(d.cameraOff),o(j.DELETE,{}),b.removeClass(G),w.addClass(G),E.removeClass(Sn),D.show();else{E.addClass(Sn),D.hide(),b.addClass(G),w.addClass(G),S&&(S.innerHTML=ue.StopButton);const y=U.document.createElement("div");y.id="ul-recording-countdown-screen",_.insertBefore(y,_.children[1]),y.style.height=`${_.offsetHeight}px`,ii(d,3)}}}});E.addClass("ul-video-recorder-toggle-button"),E.el_.appendChild(Ot(ue.RecordButton,"ul-recorder-toggle"));const A=U.document.createElement("p");A.style.visibility="hidden",A.className="ul-upload-progress-label",e.appendChild(A),d.uploadProgressLabel=A;const x=ri(d,[w,b,"PlayToggle",E,"FullscreenToggle"]),D=x.children().find(S=>S.name_==="FullscreenToggle");D.hasClass("vjs-disabled")&&D.hide();const P=x.children().find(S=>S.name_==="PlayToggle");P.hide(),i&&b.addClass(G),!i&&w.addClass(G),oi(d,x,i,!1,a),d.on("stopRecord",()=>{E.hide(),P.show(),D.show(),w.removeClass(G)}),d.on("deviceReady",()=>{E.show(),P.hide(),w.addClass(G)}),ol(d,r,o,ni,s),i&&(d.deviceButton&&d.deviceButton.hide(),d.src(i),P.show(),E.hide(),w.removeClass(G));const V=[{name:"microphone"}];!d.cameraOff&&V.push({name:"camera"}),Promise.all(V.map(S=>{var $;return($=navigator==null?void 0:navigator.permissions)==null?void 0:$.query(S)})).then(S=>{S.reduce((y,F)=>y&F.state==="granted",!0)&&d&&(d.deviceButton&&d.deviceButton.hide(),!i&&d.record().getDevice())}).catch(S=>{})},ii=(e,t=3)=>{const n=U.document.getElementById("ul-recording-countdown-screen");n&&t===0?(n.remove(),e.record().start()):n&&(n.innerHTML=`<span class='ul-countdown-text'>Recording in... ${t}</span>`,setTimeout(()=>{ii(e,t-1)},1e3))},si=e=>{const t=U.document.createElement("div");return t.className="ul-video-container",t.appendChild(tl(e)),t},Ln=(e,t)=>{const n=U.document.createElement("video");n.id=e,n.className="video-js vjs-default-skin ul-video-player-video";const r=U.document.createElement("p");r.className="vjs-no-js",r.innerHTML="To view this video please enable JavaScript, and consider upgrading to a web browser that";const o=U.document.createElement("a");return o.href="https://videojs.com/html5-video-support/",o.target="_blank",o.innerHTML="supports HTML5 video",r.appendChild(o),n.appendChild(r),t.appendChild(n),t},ll=(e,t)=>{t?(e.children()[0].classList.add("vjs-hidden"),e.audioPlayerPlaceholder.show(),U.document.getElementById(`${e.id()}_html5_api`).style.height="0px"):(e.children()[0].classList.remove("vjs-hidden"),e.audioPlayerPlaceholder.hide(),U.document.getElementById(`${e.id()}_html5_api`).style.height="100%")},Mt=(e,t)=>U.document.getElementById(e)?t?U.videojs(e,t):U.videojs(e):(console.error(`Error in finding player element with ID, ${e}`),null),cl=(e,t,n,r=!1,o="https://api.sprig.com",i=document,s=null,a=null)=>{U.document=i;const c=e+Qo,d=si(c);return U.document.addEventListener("securitypolicyviolation",l=>{Se(new Error(`Voice & Video feature violates ${l.violatedDirective} web page CSP policies for the question player.`),"playerDeviceError",o,{})}),ti(Yo,()=>{U.document.getElementById(xn(c)).remove(),Ln(c,d);const l={playsinline:!0,playbackRates:[.5,1,1.5,2],fill:!0};try{const m=e+Jo;Ln(m,d);const p=Mt(c,l),f=Mt(m,{muted:!0,...l});if(!p||!f)return;sl(f,s,a),s||f.addClass(G);const h=ri(p,["PlaybackRateMenuButton","PlayToggle","FullscreenToggle"]),g=h.children().find(v=>v.name_==="FullscreenToggle");g.hasClass("vjs-disabled")&&g.hide(),oi(p,h,t,n,r,f)}catch(m){Se(new Error(`Error when creating video player object ${m}`),"playerDeviceError",o,{});return}}),d},dl=(e,t={},n="https://api.userleap.com",r,o,i,s=!1,a=document)=>{U.document=a;const c=e+Xo,d=si(c);return U.document.addEventListener("securitypolicyviolation",l=>{Se(new Error(`Voice & Video feature violates ${l.violatedDirective} web page CSP policies for the recorder player.`),"recorderDeviceError",n,i,t.visitorId,t.envId)}),ti(Yo.concat(nl),()=>{Ln(c,d),U.document.getElementById(xn(c)).remove();try{al(d,c,t,n,r,o,i,s)}catch(l){Se(new Error(`Error when creating video recorder player object ${l}`),"recorderDeviceError",n,i,t.visitorId,t.envId);return}}),d},ul=e=>{const t=e+Xo;if(!!U.document.getElementById(t)&&!!U.videojs){try{if(!U.videojs(t).record().stream)return}catch{return}U.videojs(t).record().stop(),U.videojs(t).record().stopDevice()}},pl=e=>{const t=Mt(e+Qo);t==null||t.pause()},fl=e=>{if(!e)return null;const t=e.match(/https:\/\/stream.mux.com\/(.*)/);let n=t?t[1]:null;return n.includes(Zo)&&(n=n.replace(Zo,"")),n?`https://image.mux.com/${n}/thumbnail.jpg?time=0`:null},j={UPLOAD_STARTED:"upload.started",UPLOAD_PROGRESS:"upload.progress",UPLOAD_FINISHED:"upload.finished",DELETE:"delete",ERROR:"error",MEDIA_TYPE:"media.type",PERMISSION_DENIED:"permission_denied",OTHER:"other",UPLOAD_ID:"upload.id",UPLOAD_PROGRESS_PCT:"upload.progress.pct",MEDIA_RECORDING_UID:"media.recording.uid",MEDIA_TYPE_VIDEO:"video",MEDIA_TYPE_AUDIO:"audio"},ue={PlaybackRateMenuButton:"Speed",PlayToggle:"Play",FullscreenToggle:"Expand",TurnOnCamera:"Turn on",TurnOffCamera:"Turn off",DeleteButton:"Delete",RecordButton:"Record",StopButton:"Stop",PauseButton:"Pause"},mt="ul-card-video__player_recorder",ml="ul-card-video__skip_button",hl="ul-video-interview-form",ai="ul-video-btn",gl=({className:e,message:t,next:n,properties:r,questionId:o,type:i})=>{const{apiURL:s,envId:a,handleUploadUpdate:c,headers:d,responseGroupUid:l,surveyId:m,viewDocument:p,visitorId:f}=z(y=>({apiURL:y.apiURL,envId:y.envId,handleUploadUpdate:y.handleUploadUpdate,headers:y.headers,responseGroupUid:y.responseGroupUid,surveyId:y.surveyId,viewDocument:y.viewDocument,visitorId:y.userId})),[h,g]=Z(!1),[v,w]=Z(null),[_,C]=Z(null),[b,E]=Z(0),A=d["userleap-platform"],x=r&&r.videoUrl,D=(y,F)=>{y===j.UPLOAD_STARTED?(w(F[j.UPLOAD_ID]),C(F[j.MEDIA_RECORDING_UID]),g(!0)):y===j.DELETE?(w(null),C(null),g(!1)):y===j.UPLOAD_PROGRESS?isNaN(F[j.UPLOAD_PROGRESS_PCT])?c({mediaRecordingUid:F[j.MEDIA_RECORDING_UID],isComplete:!0}):c({mediaRecordingUid:F[j.MEDIA_RECORDING_UID],progressPct:F[j.UPLOAD_PROGRESS_PCT]}):y===j.UPLOAD_FINISHED&&c({mediaRecordingUid:F[j.MEDIA_RECORDING_UID],isComplete:!0})},P=y=>{if(y&&y.children.length===0){const F=cl(mt,{src:x,type:"application/x-mpegURL"},void 0,r.mediaType===j.MEDIA_TYPE_AUDIO,s,p);y.appendChild(F)}},V=y=>{if(y&&y.children.length===0){const F=dl(mt,{surveyId:m,responseGroupUid:l,questionId:o,visitorId:f,envId:a},s,D,void 0,{...d,"x-ul-video-recorder-origin":"sdk"},r.mediaType===j.MEDIA_TYPE_AUDIO,p);y.appendChild(F)}},S=y=>{y.preventDefault(),y.stopPropagation(),ul(mt),v&&_?(c({mediaRecordingUid:_,isSubmitted:!0}),n({value:{mediaRecordingUid:_},questionId:o,type:i})):n({value:null,questionId:o,type:i})},$=()=>u(Pe,{defaultBody:()=>u("button",{className:`${ai} ul-record-response-btn`,onClick:y=>{y.preventDefault(),y.stopPropagation(),pl(mt),E(1)}}),properties:r});return u("div",{className:R(me(k.CardMainContent,A)),style:{marginTop:"unset"},children:u("form",{className:R([e,k.VideoCard,k.FadeInTransition]),id:hl,children:[u(ve,{message:t,properties:r}),u("div",{id:"ul-card-voice__video",children:[u("div",{children:[u("div",{id:"ul-question-player-container",style:{display:b===0?"":"none"},children:[u("div",{id:mt,ref:P}),$()]}),u("div",{style:{display:b===1?"block":"none"},children:[u("button",{className:`${ai} ul-back-question-btn`,onClick:y=>{y.preventDefault(),y.stopPropagation(),E(0)}}),u("div",{id:"ul-recorder-player-container",ref:V})]})]}),u(te,{disabled:!h,onClick:S,children:tt(r)}),u("button",{className:`ul-card-text__button ${k.InactiveButton}`,id:ml,onClick:S,style:{display:r.required?"none":"block",...h?{display:"none"}:{}},children:vn(r)})]})]})})},vl=({className:e})=>{const{headers:t,uploadProgress:n}=z(s=>({headers:s.headers,uploadProgress:s.uploadProgress}));let r,o;Object.values(n).filter(s=>s.isSubmitted).length>1?(r="Your responses are processing",o="Please keep this tab open until your responses are fully processed."):(r="Your response is processing",o="Please keep this tab open until your response is fully processed.");const i=Math.round(Math.min(99,...Object.values(n).filter(s=>s.isSubmitted).map(s=>s.progressPct)));return u("div",{className:R(me(k.CardMainContent,t["userleap-platform"])),children:u("div",{className:R([e,"ul-card--uploading",k.FadeInTransition]),children:[u("div",{"aria-busy":"true","aria-label":"Processing...","aria-live":"polite",className:k.LoadingSpinnerContainer,role:"progressbar",children:u("div",{className:k.LoadingSpinner,children:[u("div",{className:k.LoadingSpinnerFirst}),u("div",{className:k.LoadingSpinnerSecond}),u("div",{className:k.LoadingSpinnerThird}),u("div",{className:k.LoadingSpinnerFourth})]})}),u(ve,{message:`${r} (${i}% complete)`}),u("p",{className:k.Caption,children:o})]})})},li=()=>u("svg",{alt:"Powered by Sprig",fill:"none",height:"13",viewBox:"0 0 100 13",width:"100",xmlns:"http://www.w3.org/2000/svg",children:[u("path",{d:"M3.0369 0.839981H0.0249023V8.99998H1.3209V6.53998H2.8569C4.8969 6.53998 6.2409 5.37598 6.2409 3.62398C6.2409 1.95598 4.9689 0.839981 3.0369 0.839981ZM3.0009 5.35198H1.3209V2.02798H3.0009C4.1769 2.02798 4.9689 2.67598 4.9689 3.62398C4.9689 4.65598 4.1769 5.35198 3.0009 5.35198Z",fill:"#5D696F"}),u("path",{d:"M9.90653 3.21598C8.15453 3.21598 6.90653 4.45198 6.90653 6.17998C6.90653 7.90798 8.15453 9.14398 9.90653 9.14398C11.6585 9.14398 12.9065 7.90798 12.9065 6.17998C12.9065 4.45198 11.6585 3.21598 9.90653 3.21598ZM9.90653 8.01598C8.88653 8.01598 8.15453 7.23598 8.15453 6.17998C8.15453 5.11198 8.88653 4.34398 9.90653 4.34398C10.9265 4.34398 11.6585 5.11198 11.6585 6.17998C11.6585 7.23598 10.9265 8.01598 9.90653 8.01598Z",fill:"#5D696F"}),u("path",{d:"M20.9631 3.35998L19.7391 7.11598L18.3951 3.35998H17.3271L15.9831 7.12798L14.7591 3.35998H13.4151L15.4431 8.99998H16.5351L17.8671 5.08798L19.1871 8.99998H20.2791L22.3071 3.35998H20.9631Z",fill:"#5D696F"}),u("path",{d:"M25.7246 3.21598C24.0086 3.21598 22.8206 4.51198 22.8206 6.17998C22.8206 7.85998 24.0206 9.14398 25.7966 9.14398C27.0206 9.14398 28.0166 8.54398 28.3766 7.52398H27.0086C26.7806 7.88398 26.3606 8.05198 25.8086 8.05198C24.7526 8.05198 24.2126 7.40398 24.0926 6.55198H28.5206C28.7606 4.64398 27.5966 3.21598 25.7246 3.21598ZM25.7366 4.27198C26.6126 4.27198 27.2126 4.76398 27.2846 5.68798H24.1166C24.2606 4.89598 24.8006 4.27198 25.7366 4.27198Z",fill:"#5D696F"}),u("path",{d:"M31.1297 4.12798V3.35998H29.8817V8.99998H31.1297V5.44798C31.6337 4.78798 32.3177 4.45198 33.2177 4.41598V3.23998C32.3537 3.23998 31.6457 3.56398 31.1297 4.12798Z",fill:"#5D696F"}),u("path",{d:"M36.8222 3.21598C35.1062 3.21598 33.9182 4.51198 33.9182 6.17998C33.9182 7.85998 35.1182 9.14398 36.8942 9.14398C38.1182 9.14398 39.1142 8.54398 39.4742 7.52398H38.1062C37.8782 7.88398 37.4582 8.05198 36.9062 8.05198C35.8502 8.05198 35.3102 7.40398 35.1902 6.55198H39.6182C39.8582 4.64398 38.6942 3.21598 36.8222 3.21598ZM36.8342 4.27198C37.7102 4.27198 38.3102 4.76398 38.3822 5.68798H35.2142C35.3582 4.89598 35.8982 4.27198 36.8342 4.27198Z",fill:"#5D696F"}),u("path",{d:"M45.4886 0.47998V3.80398C45.0086 3.43198 44.3966 3.21598 43.6766 3.21598C42.0926 3.21598 40.8206 4.53598 40.8206 6.16798C40.8206 7.82398 42.0926 9.14398 43.6766 9.14398C44.3966 9.14398 45.0086 8.92798 45.4886 8.54398V8.99998H46.7246V0.47998H45.4886ZM43.8566 8.01598C42.8246 8.01598 42.0686 7.17598 42.0686 6.16798C42.0686 5.17198 42.8246 4.34398 43.8566 4.34398C44.4806 4.34398 45.0686 4.55998 45.4886 5.15998V7.18798C45.0686 7.79998 44.4806 8.01598 43.8566 8.01598Z",fill:"#5D696F"}),u("path",{d:"M54.6797 3.21598C53.9597 3.21598 53.3477 3.43198 52.8797 3.79198V0.47998H51.6317V8.99998H52.8797V8.55598C53.3477 8.92798 53.9597 9.14398 54.6797 9.14398C56.2637 9.14398 57.5477 7.82398 57.5477 6.16798C57.5477 4.53598 56.2637 3.21598 54.6797 3.21598ZM54.4997 8.01598C53.8757 8.01598 53.2997 7.79998 52.8797 7.21198V5.13598C53.2997 4.54798 53.8757 4.34398 54.4997 4.34398C55.5437 4.34398 56.2997 5.17198 56.2997 6.16798C56.2997 7.17598 55.5437 8.01598 54.4997 8.01598Z",fill:"#5D696F"}),u("path",{d:"M63.3347 3.34798L61.3907 7.76398L59.2667 3.34798H57.9347L60.8147 9.08398L59.6267 11.784H60.9347L64.6547 3.34798H63.3347Z",fill:"#5D696F"}),u("path",{d:"M71.1466 4.34661C69.8092 4.05038 69.131 3.53001 69.131 2.80065C69.131 2.04705 69.8546 1.47822 70.8142 1.47822C71.8034 1.47822 72.5496 2.10339 72.5496 2.9321V2.99813H73.9165V2.9321C73.9165 1.41764 72.5883 0.272705 70.8271 0.272705C69.9784 0.272705 69.2009 0.533191 68.6379 1.0057C68.3584 1.23619 68.1339 1.52487 67.9805 1.8511C67.8271 2.17733 67.7486 2.53303 67.7506 2.89273C67.7451 3.22255 67.8137 3.54949 67.9515 3.84994C68.0894 4.15038 68.293 4.41686 68.5478 4.63012C69.0218 5.04266 69.6945 5.34798 70.5463 5.5388C71.9806 5.85502 72.7078 6.39296 72.7078 7.13686C72.7078 7.94316 71.9156 8.55076 70.8682 8.55076C69.7804 8.55076 68.9599 7.87531 68.9599 6.97996V6.91393H67.5918V6.97996C67.5918 8.56348 68.9942 9.75688 70.8535 9.75688C71.7426 9.75688 72.5588 9.48731 73.1518 8.99662C73.446 8.75831 73.6827 8.4581 73.8445 8.1179C74.0063 7.7777 74.0891 7.40611 74.087 7.03024C74.087 5.6854 73.0991 4.78217 71.1466 4.34661Z",fill:"#5D696F"}),u("path",{d:"M78.7986 2.50806C78.2874 2.50175 77.7823 2.6176 77.3263 2.84576C76.8703 3.07391 76.4768 3.40759 76.1795 3.81837V2.66738H74.8789V12.0752H76.1795V8.48716C76.4768 8.8979 76.8703 9.23152 77.3263 9.45957C77.7824 9.68763 78.2875 9.80335 78.7986 9.79687C80.8167 9.79687 82.3381 8.23031 82.3381 6.15246C82.3381 4.07462 80.8167 2.50806 78.7986 2.50806ZM80.9835 6.42264C80.9316 6.9629 80.6921 7.46879 80.3056 7.8544C79.919 8.24001 79.4093 8.48156 78.863 8.53804C78.1369 8.61074 77.4605 8.40295 76.9583 7.95407C76.4561 7.50518 76.1795 6.86365 76.1795 6.15246C76.1795 4.7846 77.2122 3.75295 78.5815 3.75295C79.2904 3.75295 79.9306 4.02191 80.3776 4.51018C80.8387 5.01116 81.054 5.69025 80.9835 6.42264Z",fill:"#5D696F"}),u("path",{d:"M98.2908 2.6692V3.80747C97.6776 2.97875 96.7302 2.50806 95.6583 2.50806C93.6482 2.50806 92.1323 4.04615 92.1323 6.08582C92.1323 8.1255 93.6482 9.66299 95.6583 9.66299C96.7345 9.66299 97.6819 9.19714 98.2908 8.37691V8.55198C98.2908 9.96891 97.3906 10.8843 95.9974 10.8843C95.0561 10.8843 94.2718 10.4766 93.8996 9.79384L93.8806 9.7587H92.5389L92.5695 9.84654C92.7961 10.514 93.2392 11.0889 93.8303 11.4822C94.4233 11.8723 95.1726 12.0783 95.9974 12.0783C97.0552 12.0783 97.9554 11.7451 98.6017 11.1157C99.2481 10.4862 99.5915 9.6012 99.5915 8.56773V2.6692H98.2908ZM97.5611 7.842C97.0092 8.36418 96.2225 8.58348 95.4001 8.44294C94.9132 8.35796 94.4664 8.12184 94.1245 7.76889C93.7827 7.41593 93.5636 6.96452 93.4992 6.48019C93.3833 5.66541 93.631 4.89364 94.1786 4.36418C94.6383 3.92741 95.2542 3.68788 95.8919 3.69782C96.0464 3.69795 96.2006 3.71031 96.3531 3.73477C97.3459 3.89349 98.1314 4.70403 98.2632 5.71024C98.3749 6.53835 98.1179 7.31436 97.5611 7.842Z",fill:"#5D696F"}),u("path",{d:"M90.705 0.0995975C90.4602 0.046773 90.2043 0.0911971 89.9925 0.223269C89.7806 0.35534 89.6299 0.564452 89.5729 0.805409C89.5159 1.04637 89.5571 1.29982 89.6877 1.51098C89.8183 1.72215 90.0277 1.87407 90.2708 1.93391C90.3415 1.94954 90.4136 1.95747 90.486 1.95754C90.72 1.9579 90.9458 1.87325 91.1206 1.71973C91.2955 1.5662 91.407 1.35452 91.4341 1.125C91.4611 0.89547 91.4017 0.664135 91.2673 0.475046C91.1329 0.285958 90.9327 0.152325 90.705 0.0995975V0.0995975Z",fill:"#5D696F"}),u("path",{d:"M89.8366 8.39143H88.715C87.9178 8.39143 87.4389 7.85531 87.4389 6.95693C87.4389 6.08096 87.8681 5.03659 88.7432 3.76444L88.7548 3.74748V3.38825L85.0271 2.86727C85.0284 2.71553 84.9886 2.56622 84.9118 2.43478C84.8351 2.30335 84.7241 2.19458 84.5905 2.11973C84.2563 1.938 83.8908 1.938 83.5879 2.11368C83.4361 2.2023 83.3122 2.33077 83.23 2.4848C83.1477 2.63884 83.1103 2.8124 83.1219 2.98618C83.1336 3.15996 83.1938 3.32714 83.2958 3.46914C83.3979 3.61114 83.5379 3.72238 83.7001 3.79049L82.5405 9.63753H83.8283L84.8977 4.08551L86.9115 4.42111C86.3701 5.38007 86.0953 6.27421 86.0953 7.07869C86.0953 8.56347 87.0041 9.53576 88.4734 9.62965V9.63753H91.1341V2.69099H89.8366V8.39143Z",fill:"#5D696F"})]}),_l=()=>{const{border:e,cards:t,headers:n,index:r,marketingUrl:o,showSurveyBrand:i,slugName:s,surveyId:a,viewedCardCount:c}=z(g=>({border:g.border,cards:g.cards,headers:g.headers,index:g.index,marketingUrl:g.marketingUrl,showSurveyBrand:g.showSurveyBrand,slugName:g.slugName,surveyId:g.surveyId,viewedCardCount:g.viewedCardCount})),d=Ue(null),l=t.filter(g=>g.type!==I.Uploading&&g.type!==I.Thanks),m=xa(t,r),p=c+1,f=p/(p+m);ie(()=>{d.current&&(d.current.style.width=`${f*100}%`)},[f]);const h=()=>i?u("a",{href:`${o}?utm_source=survey_branding&utm_medium=website&utm_campaign=${s}&utm_content=${a}`,rel:"noreferrer",style:{display:"block",margin:"5px 0"},target:"_blank",children:u(li,{})}):null;return!l||l.length===1?u("footer",{className:"ul-footer",style:i?{}:{marginBottom:"10px"},children:h()}):u("footer",{className:`ul-footer ${n["userleap-platform"]==="link"?"ul-footer__link":""}`,children:[l.length>1&&u("div",{id:"ul-progress-bar-container",children:u("div",{id:"ul-progress-bar-current",ref:d,style:{border:`1px solid ${e||"#000"}`}})}),i&&u("a",{href:`${o}?utm_source=survey_branding&utm_medium=website&utm_campaign=${s}&utm_content=${a}`,rel:"noreferrer",style:{display:"block",margin:"5px 0"},target:"_blank",children:u(li,{})})]})},yl=()=>{const{answers:e,border:t,cards:n,close:r,configureExitOnOverlayClick:o,destroy:i,endCard:s,eventEmitFn:a,fontFamily:c,headers:d,index:l,next:m,showStripes:p,update:f,useMobileStyling:h,viewDocument:g}=z(y=>({answers:y.answers,border:y.border,cards:y.cards,close:y.close,configureExitOnOverlayClick:y.configureExitOnOverlayClick,destroy:y.destroy,endCard:y.endCard,eventEmitFn:y.eventEmitFn,fontFamily:y.fontFamily,headers:y.headers,index:y.index,next:y.next,showStripes:y.showStripes,update:y.update,useMobileStyling:y.useMobileStyling,viewDocument:y.viewDocument})),v=Ue(null),w=Ue(!1),{props:_,type:C,name:b}=n[l],E=n.length;ie(()=>{v.current&&(v.current.classList.contains("ul-app--visible")||v.current.classList.add("ul-app--visible"),!w.current&&a&&(w.current=!0,a(O.SurveyAppeared)))},[a]),ie(()=>{f()},[l,f]),ie(()=>{o(()=>r())},[r,o]);const A=()=>r(We),x=y=>{y.key==="Enter"&&A()},D=async function(y){m({data:y,completeSurvey:()=>{i(We)},endCard:s}),Si(g)};if(e){for(const y of e)if(y.questionId===b){let F;if(C===I.MultipleChoice){const M=_.options.find(({value:pe})=>pe===y.value);if(!M)break;F={[M.id]:M.value}}else F=y.value;D({value:F,type:C,questionId:y.questionId});break}}const P=()=>[Me.Email,Me.Link].includes(d["userleap-platform"])?!1:!s||l+1!==E,V=()=>h?{borderColor:t}:{borderColor:t,margin:"15px"},S=()=>{const y={className:"ul-card",next:D,questionId:b,type:C};switch(C){case I.ConsentLegal:return q(Da,{...y,..._,key:b});case I.Likert:return q(ja,{...y,..._,key:b});case I.MultipleChoice:return q(Aa,{...y,..._,key:b});case I.MultipleSelect:return q(Oa,{...y,..._,key:b});case I.NPS:return q(Ma,{...y,key:b,props:_});case I.Open:return q(Na,{...y,..._,key:b});case I.RecordedTask:return q(Za,{...y,..._,key:b});case I.TextUrlPrompt:return q(Ja,{...y,..._,key:b});case I.Thanks:return q(Xa,{...y,..._,key:b});case I.Uploading:return q(vl,{...y,..._,key:b});case I.VideoVoice:return q(gl,{...y,..._,key:b});default:return null}},$=y=>{var yi;const F=window.sprigAPI,M=y.target;if(!F||!M)return;const pe=[M,M.parentElement];for(const Vt of pe)if(((yi=Vt==null?void 0:Vt.tagName)==null?void 0:yi.toLowerCase())==="a"){y.preventDefault(),F==null||F.openUrl(Vt.href);return}};return u("div",{className:R("ul-app",Ke(d)?"ul-app--visible":"ul-app--overlay"),id:We,onClick:$,ref:v,style:{"--theme":t,...c?{fontFamily:c.replace(";","")}:{}},children:u("div",{className:"ul-app__container",children:[u("div",{className:R(W(k.CardContainer,h)),style:V(),children:[p&&u("div",{className:"ul-header__container",children:u("div",{className:"ul-header",children:"For development purposes only"})}),S(),u(_l,{})]}),P()&&u("div",{className:R(W(k.CloseContainer,h)),children:u("div",{"aria-label":"Close button",className:k.CloseButton,onClick:A,onKeyPress:x,role:"button",tabIndex:0,children:u("svg",{fill:"none",height:"18px",viewBox:"0 0 13 13",width:"18px",xmlns:"http://www.w3.org/2000/svg",children:u("path",{d:"M2.54964 1.78369L1.78369 2.54964L5.73405 6.5L1.78369 10.4504L2.54964 11.2163L6.5 7.26595L10.4504 11.2163L11.2163 10.4504L7.26595 6.5L11.2163 2.54964L10.4504 1.78369L6.5 5.73405L2.54964 1.78369Z",fill:"#262136"})})})})]})})},wl=`html,body,p,ol,ul,li,dl,dt,dd,blockquote,figure,fieldset,legend,textarea,pre,iframe,hr,h1,h2,h3,h4,h5,h6{margin:0;padding:0}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:400}button,input,select,textarea{margin:0}html{box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}.ul-card{flex:1 1 auto;border-radius:2px;display:flex;flex-direction:column;font-size:17px;line-height:19px;text-align:left;margin:auto}.ul-card__container--desktop{border:2px solid #fff;box-shadow:0 0 15px #00000026}.ul-card__container--mobile{border-width:0;box-shadow:0 0 5px #00000040;margin-top:5px}.ul-card__container{background:#ffffff;border-radius:6px;display:flex;flex-direction:column;flex-grow:1;flex:1 1 auto;font-size:17px;line-height:23px;overflow:auto;padding:20px 20px 5px;position:relative;text-align:center;word-break:break-word}.ul-card-vertical__button-wrapper{flex-direction:column;align-items:center}.ul-card__button-wrapper{margin-top:4px;margin-bottom:3px;display:flex;gap:16px;justify-content:center}.ul-rich-text-body{min-height:2em}.ul-rich-text-body,.ul-rich-text-body p{margin-top:10px;margin-bottom:10px}.ul-rich-text-body li{margin:5px 0 5px 20px}.ul-rich-text-body p,.ul-rich-text-body li{font-size:15px;line-height:130.35%;letter-spacing:.02em;color:#343442;text-align:left;white-space:pre-line}.ul-rich-text-body:last-child,.ul-rich-text-body li:last-child{margin-bottom:15px}.ul-card-main-content__link,.ul-card-main-content__email{flex-grow:55;display:flex}.ul-card-main-content__web,.ul-card-main-content__android,.ul-card-main-content__ios{padding-top:15px;margin-bottom:5px}.ul-question{color:#343442;display:block;font-size:20px;line-height:125%;font-weight:500;cursor:default;text-align:left}.ul-caption{flex:1 0 auto;margin-top:8px;margin-bottom:15px;font-size:15px;line-height:130.35%;letter-spacing:.02em;color:#6c6c6e;text-align:left}.ul-card__choices{margin:5px 0 0;flex:1 0}.choice--mobile{border:2px solid #e6e6e6}.choice--desktop{border:1px solid #e6e6e6}.choice{align-items:flex-start;color:#262136;cursor:pointer;display:flex;justify-content:flex-start;flex-direction:column;box-sizing:border-box;border-radius:3px;margin-bottom:7px;font-size:15px;line-height:20px;padding:10px 20px 10px 15px;background-color:#00000003}.choice--desktop:hover,.choice--desktop:active,.choice--mobile:active{background-color:#0000000d}.choice-label-container{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;width:100%;height:fit-content;flex:0 0 fit-content}.choice-text-entry-container{width:100%;height:fit-content;flex:0 1 fit-content;overflow:hidden}.choice .choice-text-input--mobile{max-height:63px}.choice .choice-text-input--desktop{max-height:150px}.choice .choice-text-input{box-sizing:border-box;background-color:transparent;color:#343442;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;min-height:20px;max-height:60px;padding:0;margin-top:8px;resize:none;width:100%;font-size:14px;line-height:20px;outline:none;border:none;overflow-wrap:break-word}.choice .choice-text-input::placeholder{color:#6c6c6e80}.ul-thanks-check{text-align:center;margin-bottom:20px}.ul-card--thanks-content{padding:20px 0 10px}.ul-card--thanks .ul-question{padding-top:0;text-align:center}.ul-card--thanks .ul-caption{padding-top:0;text-align:center;overflow-wrap:break-word;hyphens:auto;hyphenate-limit-lines:no-limit}.ul-card--uploading .ul-question{padding-top:15px;text-align:center}.ul-card--uploading .ul-caption{padding-top:5px;text-align:center;overflow-wrap:break-word}.ul-loading-spinner-container{font-size:1.8rem;flex-grow:1;width:100%;height:100%;display:flex;align-items:center;justify-content:center}.ul-loading-spinner{display:inline-block;position:relative;width:6rem;height:6rem}.ul-loading-spinner div{box-sizing:border-box;display:block;position:absolute;width:80%;height:80%;margin:5px;border:5px solid #152e3e;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:#152e3e transparent transparent transparent}.ul-loading-spinner .first{animation-delay:-.45s}.ul-loading-spinner .second{animation-delay:-.3s}.ul-loading-spinner .third{animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.select-checkbox{height:16px;width:16px;border-radius:3px;border:1px solid #323232;display:flex;box-sizing:border-box;box-shadow:inset 3px 3px #0000001a;background-color:"transparent";align-items:center;justify-content:center}.select-radio{height:16px;width:16px;border-radius:16px;border:1px solid #323232;display:flex;box-sizing:border-box;box-shadow:inset 2px 2px #0000001a;background-color:"transparent";align-items:center;justify-content:center}.fade-in-transition{animation:fadeIn .4s ease-in;-webkit-animation:fadeIn .4s ease-in;-moz-animation:fadeIn .4s ease-in;-o-animation:fadeIn .4s ease-in;-ms-animation:fadeIn .4s ease-in}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-ms-keyframes fadeIn{0%{opacity:0}to{opacity:1}}[class^=CenteredSurveyLayout] .ul-header__container,[class^=QuestionConceptTestLayout] .ul-header__container,.ul-websurvey-frame .ul-card__container,.ul-websurvey-frame-mobile .ul-card__container{margin-bottom:unset}[class^=CenteredSurveyLayout] .ul-card__container,[class^=QuestionConceptTestLayout] .ul-card__container,.ul-websurvey-frame .ul-card__container,.ul-websurvey-frame-mobile .ul-card__container{box-shadow:unset;border-radius:unset;border:none!important;position:unset}@media only screen and (min-height: 600px) and (width: 600px){.ul-card{position:relative;top:-20px}}.ul-vertical-centered-container{display:flex;flex-direction:column;align-items:center}.ul-consent-legal__name-input--mobile{border:2px solid #e6e6e6}.ul-consent-legal__name-input--desktop{border:1px solid #e6e6e6}.ul-consent-legal__name-input{background:rgba(0,0,0,.01);box-sizing:border-box;color:#343442;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;padding:10px 20px 10px 15px;border-radius:3px;font-size:15px;line-height:20px;margin-bottom:7px;width:100%}.ul-consent-legal__name-input::placeholder{color:#6c6c6e80}.ul-consent-legal__name-input:focus{outline:none;background:white}.ul-consent-legal__name-input--desktop:hover:not(:focus){background-color:#0000000d}.ul-card__consent-legal .choice{font-size:15px;padding:10px 15px;background-color:#00000003}.ul-card__consent-legal .choice--desktop:hover,.ul-card__consent-legal .choice--desktop:active,.ul-card__consent-legal .choice--mobile:active{background-color:#0000000d}.ul-card--likert__numbers{align-items:center;border-radius:5px;display:flex;flex-direction:row;flex:1 0;justify-content:center;margin:5px 0 0}.likert-number--mobile{border:2px solid #e6e6e6;margin-left:-2px}.likert-number--desktop{border:1px solid #e6e6e6;margin-left:-1px}.likert-number{align-items:center;cursor:pointer;display:flex;justify-content:center;flex:1 0;background-color:#00000003;font-size:18px;line-height:24px;height:67px}.likert-number:active,.likert-number--desktop:hover{background-color:#0000000d;font-weight:500}.likert-number-1{border-top-left-radius:5px;border-bottom-left-radius:5px}.likert-last-option{border-top-right-radius:5px;border-bottom-right-radius:5px}.likert-star--mobile{margin-left:-2px}.likert-star--desktop{margin-left:-1px}.likert-star{align-items:center;cursor:pointer;display:flex;justify-content:space-between;flex:1 0;color:transparent;font-size:18px;line-height:24px;height:67px}.likert-smiley--mobile{margin-left:-2px}.likert-smiley--desktop{margin-left:-1px}.likert-smiley{align-items:center;cursor:pointer;display:flex;justify-content:space-between;flex:1 0;color:transparent;line-height:24px;height:67px}.likert-smiley circle:not(:first-child){fill-opacity:1}.ul-card--likert__labels{align-items:center;color:#262136;display:flex;flex-direction:row;flex:1 0;font-weight:500;font-size:13px;line-height:15px;justify-content:space-between;margin:7px 0 10px}.ul-card--likert__labels span:last-child{text-align:right}.select-label{flex:1;overflow-wrap:anywhere;cursor:pointer;padding-left:15px}.ul-card--nps__numbers{align-items:center;border-radius:5px;display:flex;flex-direction:row;flex:1 0;justify-content:center;margin:5px 0 0}.nps-number--mobile{border:2px solid #e6e6e6;margin-left:-2px}.nps-number--desktop{border:1px solid #e6e6e6;margin-left:-1px}.nps-number{align-items:center;cursor:pointer;display:flex;justify-content:center;flex:1 0;background-color:#00000003;font-size:18px;line-height:24px;height:67px}.nps-number:active,.nps-number--desktop:hover{background-color:#0000000d;font-weight:500}.nps-number-0{border-top-left-radius:5px;border-bottom-left-radius:5px}.nps-number-10{border-top-right-radius:5px;border-bottom-right-radius:5px}.ul-card--nps__labels{align-items:center;color:#262136;display:flex;flex-direction:row;flex:1 0;font-weight:500;font-size:13px;line-height:15px;justify-content:space-between;margin:7px 0 10px}.ul-card--nps__labels span:last-child{text-align:right}.ul-card-text{flex:1 0 auto;margin-top:2px;margin-bottom:3px;align-items:center;display:flex;flex-wrap:wrap;justify-content:center;padding:0}.ul-card-text__container{align-items:center;box-sizing:border-box;border-radius:3px;display:flex;justify-content:center;margin-bottom:12px;flex:1 0 100%}.ul-card-text__input--mobile{border:2px solid #e6e6e6;max-height:63px}.ul-card-text__input--desktop{border:1px solid #e6e6e6;max-height:150px}.ul-card-text__input{background:rgba(0,0,0,.01);box-sizing:border-box;color:#343442;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;min-height:63px;overflow:auto;padding:12px;resize:none;width:100%;border-radius:3px;font-size:15px;line-height:20px;overflow-wrap:break-word}.ul-card-text__input::placeholder{color:#6c6c6e80}.ul-card-text__input:focus{outline:none;background:white}.ul-card-text__input--desktop:hover:not(:focus){background-color:#0000000d}.ul-card__text-url-prompt-button{text-decoration:none;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}#ul-card-voice__video{align-items:center;display:flex;flex-direction:column}#ul-card-voice__video>div{margin-bottom:10px;width:100%}#ul-card-video__player_recorder{width:100%;width:-moz-available;width:-webkit-fill-available;width:fill-available}.ul-card-record__task{flex:1 0 auto;margin-top:2px;margin-bottom:3px;align-items:center;display:flex;flex-wrap:wrap;justify-content:center;padding:0}#ul-record-task-upload-progress,#ul-record-task-video-preview{width:100%;height:150px}.ul-permission-graphics-container{width:100%;height:150px;background-color:#0000000d;text-align:center;flex-direction:column;margin-left:auto;margin-right:auto;border-radius:5px;display:flex;align-items:center;font-size:15px;color:#000000b3}.ul-av-permission-denied-paragraph{margin:auto 15px;font-size:12px}.ul-av-permission-denied-headline{font-size:14px;color:#262136;text-decoration:underline;font-size:12px}.ul-permission-body{color:#000;margin:5px auto 5px 5px;line-height:135%;text-align:center}.ul-select-tab-container{width:240px;height:46px;background:#ffffff;border-radius:5px;text-align:left;align-items:center;display:flex;padding:0 5px;margin-top:20px;margin-bottom:auto}.ul-select-tab-text{color:#4b575d;margin:5px;line-height:135%;text-align:center}button.ul-task-skip-button{color:#000;background-color:#fff}#ul-task-detail-container{margin-top:0;margin-bottom:0;overflow:auto}#ul-task-detail-container.ul-rich-text-body p,#ul-task-detail-container.ul-rich-text-body li,#ul-task-detail-container.ul-rich-text-body{color:#4c4c4c}#ul-task-detail-container :first-child{margin-top:0}#ul-task-detail-container :last-child{margin-bottom:20px}.ul-horizontal-button-container{width:100%;display:flex;flex-direction:row}.ul-skip-button-below{margin-top:5px}.ul-horizontal-button-container-center{justify-content:center}.ul-vertical-button-container-center{display:flex;flex-direction:column;align-items:center}.ul-horizontal-button-container-left{justify-content:flex-start}.ul_recorded-task-inset-spacing{margin-top:5px;margin-bottom:24px}.ul_permission_svg_container{justify-content:center}.ul-card-text__button{background-color:var(--theme);border-radius:3px;border:none;color:#fff;cursor:pointer;font-size:15px;font-weight:500;line-height:18px;padding:10.5px 21px}.ul-card-text__button:disabled,.ul-card-text__button.sprig-button-disabled{background-color:#0000001a;color:#0003}.ul-card-text__button.ul-button-inactive{background-color:#fff!important;color:#5d696f!important}.ul-card-skip__button{color:#00000080;background:none;border:none;font-size:15px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;cursor:pointer}.ul-card-button-group{align-items:center;display:flex;gap:30px}html,body{cursor:default;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;height:100%;overflow:hidden;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-webkit-touch-callout:none}b{font-weight:500}#ul-app{opacity:0;width:100%;flex-grow:2;display:flex}#ul-app.ul-app--overlay{position:absolute;bottom:0;transition:opacity .1s ease-out;transition-delay:.1s}#ul-app.ul-app--visible{opacity:1;bottom:0}.ul-app__container{width:100%;display:flex;flex-direction:column;max-height:100vh}.ul-header__container{margin-bottom:15px}.ul-header{align-items:center;background:repeating-linear-gradient(120deg,#ebebeb,#ebebeb 24px,#fff 24px,#fff 48px);border-bottom:2px solid #ebebeb;display:flex;font-size:14px;font-weight:500;height:40px;justify-content:center;left:0;position:absolute;top:0;width:100%}.ul-footer{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:auto;flex-grow:1;width:100%}.ul-footer-bubble{display:inline-block;margin:0 3px;width:7px;height:7px;border-radius:3px;border:1px solid transparent}.close-container--desktop,.close-container--mobile{height:22px;width:22px;border-radius:22px;background-color:#fff;align-items:center;justify-content:center}.close-container--desktop{top:25px;right:25px}.close-container--mobile{top:15px;right:10px}.close-container{background:transparent;box-sizing:border-box;display:flex;position:absolute}.close-btn{height:18px;width:18px;align-items:center;justify-content:center;display:flex;cursor:pointer}.ul-app__container{transition:opacity .3s ease-out}.ul-center-horizontally{text-align:center}#ul-progress-bar-container{width:100%;height:2px;background-color:#0000001a;border-radius:2px;max-width:250px;margin:25px 0}#ul-progress-bar-current{transition:width 1s ease;width:0%;height:0;border-radius:2px}.prototype-button{width:100%;background:rgba(0,0,0,.01);border:1.5px solid #e6e6e6;border-radius:4px 0 0 4px;flex:none;flex-grow:1;margin:0;padding:20px 0;font-size:14px;font-family:inherit;text-decoration:underline}.prototype-button:hover{cursor:pointer}
`,bl=(e,t)=>{const n=[...e],r=new Set([I.VideoVoice,I.RecordedTask]);return e.some(o=>r.has(o.type))&&n.push({name:-2,props:{routingOptions:[]},type:I.Uploading}),t&&n.push({name:-1,props:{routingOptions:[]},type:I.Thanks}),n},xl=({mode:e=null,viewWindow:t,viewDocument:n})=>{const r=n.documentElement;return{mode:e,sw:t.screen.width,sh:t.screen.height,cw:r.clientWidth,ch:r.clientHeight,p:t.location.href,l:t.navigator.language}};function Cl(e,t=!0){var b,E,A;const{answers:n,apiURL:r,customStyles:o,endCard:i,eventEmitFn:s,fontFamilyURL:a,frame:c,UpChunk:d,viewDocument:l,viewWindow:m}=e,p=Ke(e.headers)?e.frame:l.body,f=B,h=bl(e.cards,!!i);Tt.configure(f,{cards:h,hasEndCard:!!i,apiURL:r,UpChunk:d}),z.setState({apiURL:r,answers:n,border:e.border,index:e.startingQuestionIdx||0,cards:h,configureExitOnOverlayClick:e.configureExitOnOverlayClick,customMetadata:e.customMetadata,endCard:e.endCard,envId:e.envId,eventEmitFn:s,fontFamily:e.fontFamily,frame:c,headers:e.headers,hasViewedEmbed:!1,isPreview:e.isPreview,marketingUrl:"https://sprig.com",meta:xl({mode:e.mode,viewWindow:m,viewDocument:l}),mode:e.mode,previewKey:(b=window.UserLeap)!=null&&b.localStorageAvailable?(E=window.localStorage)==null?void 0:E.getItem(ee.Preview):null,recorder:Tt,recorderEventEmitter:f,responseGroupUid:e.responseGroupUid,showStripes:e.showStripes,showSurveyBrand:e.showSurveyBrand,slugName:e.slugName,styleNonce:e.styleNonce,surveyId:e.surveyId,tabTitle:e.tabTitle,uploadingCardViewed:!1,uploadProgress:{},useMobileStyling:e.useMobileStyling,useDesktopPrototype:e.useDesktopPrototype,userId:e.userId,viewDocument:e.viewDocument,visitorAttributes:e.visitorAttributes,viewedCardCount:e.startingQuestionIdx||0});const{seen:g}=z.getState();g();const{head:v}=l,w=l.createElement("style");if(w.id="sprig-style",w.textContent=wl,w.nonce=e.styleNonce,v.appendChild(w),e.fontFamily&&a&&parent){const x=l.createElement("link");x.rel="stylesheet",x.href=a,v.appendChild(x)}if(e.customStyles&&Bn(l,o,e.styleNonce),!d)if(e.installationMethod!==Ne.Npm){const x=l.createElement("script");x.src="https://cdn.sprig.com/userleap-web-upchunk-v2.2.2.js",x.onload=()=>{Tt.setUpChunk(m.UpChunk)},x.onerror=()=>{console.warn("[Sprig] - recording functionality not configured due to UpChunk library load failure")},v.appendChild(x)}else console.warn("[Sprig] - recording functionality not configured due to missing UpChunk dependency");const _="2.23.0",C=s||((A=c.eventEmitter)==null?void 0:A.emit);C==null||C(re.VerifyViewVersion,{[Oe.ViewVersion]:_}),p&&t&&Ye(u(yl,{}),p)}const kl={configure:Cl};window.UserLeap&&window.Sprig&&(window.Sprig._gtm?window.Sprig=window.UserLeap:window.UserLeap=window.Sprig),window.UserLeap||(window.UserLeap=window.Sprig),window.Sprig||(window.Sprig=window.UserLeap);const Sl="rgba(255,255,255, 0.95)",El="rgba(0,0,0,0.9)",Ll="360px",In="0px",ci=()=>{window.UserLeap.container=document.createElement("div"),window.UserLeap.container.className="ul-container",document.body.appendChild(window.UserLeap.container)},di=e=>{const t=window.UserLeap.container;if(!!t)try{document.body.removeChild(t),window.UserLeap.container=null,ne("trackStartUrl",null),B.emit(O.SurveyLifeCycle,{state:"dismissed"}),B.emit(O.SurveyClosed,{name:O.SurveyClosed,initiator:e})}catch(n){console.warn(`[Sprig] (ERR-412) Error removing UserLeap container by ${e} `+t),n instanceof Error&&window.UserLeap.reportError("dismissActiveSurvey",n)}},ui=()=>{B.on(O.SurveyWillClose,({initiator:e})=>{di(e)})},Il=(e,t)=>{const r={...{position:"fixed",overflow:"auto",top:"0px",left:"0px",display:"none",height:"100%",width:"100%",transition:"background-color 0.3s ease-out",zIndex:2147483646}},o=t?e.overlayStyleMobile:e.overlayStyle;r["background-color"]=o==="light"?Sl:El,t||(r.margin="auto"),window.UserLeap.container&&Object.assign(window.UserLeap.container.style,r)},Ul=(e,t,n)=>{var a,c;const r={position:"fixed",bottom:"0px",right:In,border:0,backgroundColor:"rgba(0,0,0,0)",zIndex:2147483646},o=Object.assign({},t,window.UserLeap);let i,s=!1;return n?((a=window.UserLeap.windowDimensions)!=null&&a.width?r.width=`${window.UserLeap.windowDimensions.width}px`:r.width="100%",(c=window.UserLeap.windowDimensions)!=null&&c.height?r.maxHeight=`${window.UserLeap.windowDimensions.height-20}px`:window.UserLeap.maxHeight?r.maxHeight=window.UserLeap.maxHeight:r.maxHeight=`${document.body.clientHeight-20}px`,["light","dark"].includes(o.overlayStyleMobile)&&(s=!0)):(r.width=Ll,r.maxHeight=window.UserLeap.maxHeight||"66vh",o.framePosition===st.BottomLeft?i={left:In}:o.framePosition===st.TopLeft?i={left:In,top:"0px"}:o.framePosition===st.TopRight?i={top:"0px"}:o.framePosition===st.Center&&(s=!0,i={margin:"auto",position:"static"},r.maxHeight=null)),s&&Il(o,n),Object.assign(e.style,r,i),s},Pl=(e,t)=>{var a,c;const n="ul-frame";ci();const r=document.createElement("iframe");r.id=n,r.setAttribute("title","Sprig User Feedback Dialog");const o=Ul(r,e,t);B.on(O.SurveyFadingOut,()=>{window.UserLeap.container&&Object.assign(window.UserLeap.container.style,{"background-color":"rgba(0,0,0,0)"})}),ui(),r.setHeight=d=>{parseInt(r.style.height)!=d&&(r.style.height=`${d}px`,B.emit(O.SurveyHeight,{name:O.SurveyHeight,contentFrameHeight:d}))},(a=window.UserLeap.container)==null||a.appendChild(r),e&&(t?e.exitOnOverlayClickMobile:e.exitOnOverlayClick)&&window.UserLeap.container&&(window.UserLeap.container.onclick=()=>{B.emit(O.CloseSurveyOnOverlayClick)}),B.emit(O.SurveyLifeCycle,{state:"presented"}),B.emit(O.SurveyPresented,{name:O.SurveyPresented});const i=(c=r.contentWindow)==null?void 0:c.document;i&&(i.open("text/html","replace"),i.write("<!doctype html><head></head><body></body></html>"),i.close());const s=i==null?void 0:i.head;return{frameId:n,contentWinDocHead:s,contentWindow:r.contentWindow,hasOverlay:o,iframe:r}},Tl="!launch_darkly_";class Dl{constructor(){se(this,"_ldData",{})}getAllLaunchDarklyVariations(){return this._ldData}setLDFlagsVariations(t){try{return!t||typeof t!="object"||Array.isArray(t)?!1:(Object.keys(this._ldData).forEach(n=>{delete this._ldData[n]}),Object.keys(t).forEach(n=>this._ldData[`${Tl}${n}`]=t[n]+1),!0)}catch(n){return n instanceof Error&&window.UserLeap.reportError("setAllLDFlagsVariations",n),console.warn("[Sprig] An issue had occured when setting LaunchDarkly flags and variations."),!1}}}const Un=new Dl;Object.freeze(Un);const Rl="!optimizely_experiments_";class jl{constructor(){se(this,"_optimizelyData",{})}setOptimizelyExperiment(t){if(!t||typeof t!="object")return!1;const{experiments:n}=t;try{return Object.keys(this._optimizelyData).map(r=>{delete this._optimizelyData[r]}),n&&n.map(r=>{const{id:o,variation:i}=r,s=this.transformExperimentId(o);i&&typeof i=="string"&&(this._optimizelyData[s]=i)}),!0}catch(r){return r instanceof Error&&window.UserLeap.reportError("setOptimizelyExperiment",r),!1}}getAllOptimizelyExperiments(){return this._optimizelyData}getOptimizelyVariationName(t){return this._optimizelyData[this.transformExperimentId(t)]}transformExperimentId(t){return Rl+t}getAndSetWebOptimizelyExperiments(){var t;try{if(window&&window.optimizely&&typeof window.optimizely.get=="function"){const n=(t=window.optimizely.get("state"))==null?void 0:t.getExperimentStates({isActive:!0});if(n){const r=Object.keys(n).map(o=>{var i,s;return(i=n[o].variation)!=null&&i.name?{id:o,variation:(s=n[o].variation)==null?void 0:s.name}:{id:o,variation:"Original"}});return this.setOptimizelyExperiment({experiments:r}),!0}return!1}return!1}catch(n){return n instanceof Error&&window.UserLeap.reportError("getAndSetWebOptimizely",n),!1}}}const Nt=new jl;Object.freeze(Nt);class Al{constructor(t,n){se(this,"paused");se(this,"queue");se(this,"ul");this.ul=t,this.paused=!1,this.queue=[],this.flush(n)}flush(t){const n=t.length;if(n)for(let r=0;r<n;r++)this.push(t[r])}isPaused(){return this.paused}pause(){this.paused=!0}unpause(){this.paused=!1;const t=this.queue.slice();this.empty(),this.flush(t)}push(t){if(this.paused)this.queue.push(t);else if(t instanceof Function)t();else{const n=Array.prototype.slice.call(t,1),r=t[0],o=this.ul[r];o instanceof Function?o.apply(this.ul,n):r&&console.warn("[Sprig] (ERR-100) No valid UserLeap action called",r)}}perform(t){if(this.paused){let n=()=>{};const r=new Promise(function(o){n=function(){o(t())}});return this.queue.push(n),r}else return t()}empty(){this.queue.length=0}}const Ol=["popState","pushState","replaceState"],Ml={test:"test"},ht="!email",Nl=["ios","android"],Re="environments",Pn="pageUrl",ze="visitors",pi="ul-view-sdk-script",fi=Object.freeze({contains:(e,t)=>t.includes(e),notContains:(e,t)=>!t.includes(e),exactly:(e,t)=>t===e,notExactly:(e,t)=>t!==e,startsWith:(e,t)=>t.startsWith(e),endsWith:(e,t)=>t.endsWith(e),regex:(e,t)=>new RegExp(e).test(t),legacy:(e,t)=>new RegExp(e,"i").test(t)});function Tn(e,t){const{matchType:n,pattern:r}=e,o=n?fi[n]:fi.legacy;let i=!1;try{i=o(r,t)}catch(s){const a=`[Sprig] (ERR-445) Failed to check url match with pattern ${r}`;s instanceof Error&&(console.warn(a,s),s.stack=JSON.stringify(e),window.UserLeap.reportError(a,s))}return i}function Vl(e,t){const{pageUrlEvents:n,interactiveEvents:r,dismissOnPageChange:o}=window.UserLeap._config;if(!o)return!0;const i=[];n&&n.length&&i.push(...n),r&&r.length&&i.push(...r);const s=e&&i.find(a=>a.id===e);return s?Tn(s,window.location.href):t===window.location.href}function gt(e){const{pageUrlEvents:t,interactiveEvents:n,dismissOnPageChange:r,platform:o}=window.UserLeap._config;if(o&&o!==Me.Web)return;const i=qe("trackStartUrl"),s=i?String(i):null;t&&ql(window.location.href),n&&(hi(),Bl()),r&&s&&s!==window.location.href&&e&&Ol.includes(e.type)&&window.UserLeap("dismissActiveSurvey",xe.PageChange)}const mi={capture:!0},Bl=()=>{const t=window.UserLeap._config.interactiveEvents.filter(r=>Tn(r,window.location.href)).map(r=>{const{name:o,properties:i}=r,{selector:s,innerText:a}=i;return s?c=>{if(Ge(c.target))try{c.target.closest(s)&&window.UserLeap("track",o)}catch{}return!1}:c=>(Ge(c.target)&&c.target.innerText===a&&window.UserLeap("track",o),!1)}),n=r=>t.forEach(o=>o(r));window.UserLeap._config.interactiveEventsHandler=n,window.addEventListener("click",n,mi)},hi=()=>{window.UserLeap._config.interactiveEventsHandler&&window.removeEventListener("click",window.UserLeap._config.interactiveEventsHandler,mi),delete window.UserLeap._config.interactiveEventsHandler};function Fl(){["hashchange","popstate"].forEach(e=>window.addEventListener(e,gt,!0))}function $l(){["hashchange","popstate"].forEach(e=>window.removeEventListener(e,gt,!0)),window.UserLeap._config.interactiveEvents&&hi()}function we(e,t,n){const r=[window.UserLeap._API_URL,"sdk",e];return t&&t.forEach(o=>{r.push(o),o===Re?r.push(window.UserLeap.envId):o===ze&&r.push(Dn())}),n&&r.push(n),r.join("/")}function Hl(e,t){let n=we("1",[Re],"questions?");return e!=null&&(n+=`&vid=${e}`),t&&(t.surveyId&&(n+=`&surveyid=${t.surveyId}`),t.surveyTemplateId&&(n+=`&surveytemplateid=${t.surveyTemplateId}`)),n}function zl(){try{if(typeof localStorage<"u"&&(localStorage.setItem("is_available","yes"),localStorage.getItem("is_available")==="yes"))return localStorage.removeItem("is_available"),!0}catch{return!1}return!1}function qe(e){if(!window.UserLeap.localStorageAvailable)return null;const t=localStorage.getItem(ee.Credentials);if(t)try{const r=JSON.parse(t)[window.UserLeap.envId];return r&&r[e]||null}catch(n){n instanceof Error&&(n.stack=t,window.UserLeap.reportError("Failed to parse local storage credentials",n)),console.warn("[Sprig] (ERR-427) Failed to lookup saved ids",n)}return null}function ne(e,t){if(!window.UserLeap.localStorageAvailable)return;const n=localStorage.getItem(ee.Credentials);let r={};if(n)try{r=JSON.parse(n)}catch(i){i instanceof Error&&(i.stack=n,window.UserLeap.reportError("Failed to parse local storage credentials",i)),console.warn("[Sprig] (ERR-427) Failed to lookup saved ids",i)}let o=r[window.UserLeap.envId];o?o[e]=t:o={[e]:t},r[window.UserLeap.envId]=o;try{localStorage.setItem(ee.Credentials,JSON.stringify(r))}catch(i){i instanceof Error&&console.warn(`[Sprig] (ERR-426) Unable to write to Local Storage:: ${i.message}`)}}function gi(){window.previewMode||(window.UserLeap.visitorId=Ee(),ne("vid",window.UserLeap.visitorId),B.emit(O.VisitorIDUpdated,{visitorId:window.UserLeap.visitorId}))}function Dn(){return window.previewMode?"0":window.UserLeap.visitorId||""}function ql(e){if(!window.UserLeap.localStorageAvailable||e.endsWith("mock_snippet.html"))return;const t=window.UserLeap._config.pageUrlEvents;if(t&&t.length){let a=!1;for(let c=0;c<t.length&&(a=Tn(t[c],e),!a);c++);if(!a)return}window.UserLeap.debugMode&&console.info("[DEBUG] Sprig trackPageView",e);const n=10,r=1;let o=[];const i={viewedAt:Date.now(),location:e},s=localStorage.getItem(ee.PageViews);try{if(o=s?JSON.parse(s):[],Array.isArray(o)||(o=[]),o.length>0){const a=o[o.length-1],c=(Date.now()-a.viewedAt)/1e3;(a.location!=e&&c>r||c>n)&&(window.UserLeap._queue.push(["track",Pn,null,{url:e}]),o.push(i))}else window.UserLeap._queue.push(["track",Pn,null,{url:e}]),o.push(i);o.length>5&&o.splice(0,o.length-5);try{localStorage.setItem(ee.PageViews,JSON.stringify(o))}catch(a){a instanceof Error&&console.warn(`[Sprig] Unable to write to Local Storage: ${a.message}`)}}catch(a){a instanceof Error&&(a.stack=s||"",window.UserLeap.reportError("trackPageView",a)),console.warn("[Sprig] (ERR-425) Failed to update page views in local storage")}}function Wl(){const e="Backbone"in window&&window.Backbone&&window.Backbone.history?window.Backbone.history:window.history;"pushState"in e&&(e.pushState=(t=>function(...r){const o=t.apply(this,r),i=new Event("pushState");return window.dispatchEvent(i),gt(i),o})(e.pushState)),"replaceState"in e&&(e.replaceState=(t=>function(...r){const o=t.apply(this,r),i=new Event("replaceState");return window.dispatchEvent(i),gt(i),o})(e.replaceState)),Fl()}async function Rn(e,t){const n=Dn();e&&!t&&(window.UserLeap._config.mode=Ml.test);const r=await je(Hl(n,e),{},0,!0);return r.ok?(r.json.delay&&await yt(r.json.delay),vi(r.json)):(r.reportError&&r.error&&(console.warn("[Sprig] (ERR-414) Failed to request questions from the server",r.error),window.UserLeap.reportError("getQuestions",r.error)),{success:!1,surveyState:"no survey"})}const vi=async(e,t)=>{var y,F;const{context:n,endCard:r,locale:o,productConfig:i,questions:s,responseGroupUid:a,surveyId:c,uuid:d,vid:l,sessionReplay:m}=e,p=at(window.UserLeap),f=jn(p),h=Gl(p);if(m&&ir({responseGroupId:a,surveyId:c,visitorId:l,replayParams:m,completeUploadHeaders:p,apiUrl:window.UserLeap._API_URL}),l==null||!s||!s.length)return{success:!1,message:"[Sprig] no survey found",surveyState:"no survey"};if(window.UserLeap.container){const M="[Sprig] (ERR-409) Found an existing Survey container, aborting rendering of this survey";return console.warn(M),{success:!1,message:M,surveyState:"no survey"}}if(l!==window.UserLeap.visitorId&&d!==window.UserLeap.visitorId&&!window.previewMode){const M="Attempted to display survey to a different visitor";return window.UserLeap.reportError("DisplaySurvey",new Error(M)),{success:!1,message:M,surveyState:"no survey"}}if(!(t?await t(c):!0))return{success:!1,message:"[Sprig] Callback returned false, aborting rendering of survey",surveyState:"no survey"};Ft.disable(),B.emit(O.SurveyWillPresent,{name:O.SurveyWillPresent,[On.SurveyId]:c});let v,w=document.createElement("div"),_,C,b;const E=M=>{const{[Oe.ViewVersion]:pe}=M;pe!==p["x-ul-sdk-version"]&&di(),B.removeListener(re.VerifyViewVersion,E)};B.on(re.VerifyViewVersion,E),Ke(p)?(v="ul-direct-embeded-frame",_=document.head,C=window,b=!1,f&&(ci(),w.id=v,window.UserLeap.container.appendChild(w),ui(),B.emit(O.SurveyLifeCycle,{state:"presented"}),B.emit(O.SurveyPresented,{name:O.SurveyPresented}))):{frameId:v,contentWinDocHead:_,contentWindow:C,hasOverlay:b,iframe:w}=Pl(i,h),window.UserLeap.frameId=v,window.UserLeap.useMobileStyling=h;const A=M=>{B.on(O.CloseSurveyOnOverlayClick,M)},x=Object.assign({frame:w,envId:window.UserLeap.envId,surveyId:c,userId:d,visitorAttributes:{externalUserId:window.UserLeap.userId,email:window.UserLeap.email},cards:s,context:n,locale:o,fontFamily:window.UserLeap.fontFamily,fontFamilyURL:window.UserLeap.fontFamilyURL,apiURL:window.UserLeap._API_URL,responseGroupUid:a,headers:p,endCard:r,useMobileStyling:h,mobileSDKVersion:window.UserLeap.mobileSDKVersion,configureExitOnOverlayClick:A,eventEmitFn:B.emit.bind(B),ulEvents:Mn,viewDocument:C==null?void 0:C.document,viewWindow:C,tabTitle:document.title,startingQuestionIdx:(y=window.UserLeap.config)==null?void 0:y.startingQuestionIdx,styleNonce:window.UserLeap.styleNonce},window.UserLeap._config);(F=window.UserLeap.config)!=null&&F.startingQuestionIdx&&(window.UserLeap.config={...window.UserLeap.config,startingQuestionIdx:null}),window.UserLeap.customStyles&&(x.customStyles=window.UserLeap.customStyles),C&&(C.__cfg=x);function D(){const M=document.createElement("script");return window.UserLeap.nonce&&M.setAttribute("nonce",window.UserLeap.nonce),M.id=pi,M}const P=window.UserLeap.viewSDKURL?window.UserLeap.viewSDKURL:x.path,V=document.getElementById(pi);V&&V.remove();const S=D(),$=()=>{window.UserLeap.container&&Object.assign(window.UserLeap.container.style,{display:"flex"})};return x.installationMethod===Ne.Npm?(kl.configure(x),b&&window.UserLeap.container&&$()):P&&(S.src=P,b&&S.addEventListener("load",()=>{window.UserLeap.container&&$()}),C==null||C.addEventListener("error",M=>{M.target instanceof HTMLScriptElement&&M.target.src===P&&window.UserLeap.reportError("loadFrameScript",new Error("Frame script failed to load"))},{capture:!0,once:!0})),_==null||_.appendChild(S),{success:!0,surveyState:"ready"}};function Gl(e){if(window.UserLeap.useMobileStyling!==void 0)return window.UserLeap.useMobileStyling;const t=window.UserLeap.windowDimensions&&window.UserLeap.windowDimensions.width||document.body.clientWidth;return jn(e)||t>10&&t<bi}function jn(e){return Nl.includes(e[fe.Platform])}function Kl(e){let t=e.length;for(;t;){const n=Math.floor(Math.random()*t);t-=1;const r=e[t];e[t]=e[n],e[n]=r}}function Zl(e){if(!e)return;window.UserLeap._config=e,e.mute&&window.UserLeap._queue.pause();const{interactiveEvents:t,pageUrlEvents:n,dismissOnPageChange:r}=e;t&&Kl(t),(t||n||r)&&(Wl(),gt())}async function je(e,t,n=0,r=!1){var i,s;t.headers=Object.assign(at(window.UserLeap),t.headers);const o=await he(e,t,n,r);if(o.ok){const a=(i=o.headers)==null?void 0:i.get("Authorization"),c=a?a.split(" "):void 0,d=c&&c.length===2?c[1]:void 0,l=(s=o.headers)==null?void 0:s.get(fe.VisitorID);d&&l&&(l!==window.UserLeap.visitorId||window.UserLeap.token!==d)&&(ne("token",d),ne("vid",l),B.emit(O.VisitorIDUpdated,{visitorId:l}),window.UserLeap.token=d,window.UserLeap.visitorId=l)}return o.json&&o.json.logMessage&&console.warn(`[Sprig] ${o.json.logMessage}`),o}async function Yl(e){var t;!((t=e==null?void 0:e.json)!=null&&t.delay)||(window.UserLeap.delayingSurvey=!0,await yt(e.json.delay),window.UserLeap.delayingSurvey=!1)}const Ql=function(e){if(!window.UserLeap)return;const t=async(r={})=>{var h,g,v,w,_;const{userId:o,anonymousId:i,metadata:s={},properties:a,showSurveyCallback:c}=r;let{eventName:d}=r;if(window.UserLeap.debugMode&&d!==Pn&&console.info("[DEBUG] Sprig track",r),e.mode==="test")return;const l=window.UserLeap.localStorageAvailable&&(h=localStorage.getItem(ee.Preview))!=null?h:void 0;if(e.requireUserIdForTracking&&!window.UserLeap.userId&&!o){const C="[Sprig] - Skipping tracking without userId";return console.warn(C),{success:!1,message:C,surveyState:"no survey"}}if(!d||d.trim().length===0){d=d?String(d):"";const C="[Sprig] - Invalid event name "+d;return console.warn(C),{success:!1,message:C,surveyState:"no survey"}}const m=window.location.href;if(s.url||(s.url=m),ne("trackStartUrl",m),(v=(g=window.UserLeap)==null?void 0:g._config)!=null&&v.optimizelyEnabled){const C=at(window.UserLeap);jn(C)||Nt.getAndSetWebOptimizelyExperiments(),s.optimizelyExperiments=Object.assign({},Nt.getAllOptimizelyExperiments())}(_=(w=window.UserLeap)==null?void 0:w._config)!=null&&_.launchDarklyEnabled&&(s.launchDarklyFlags=Un.getAllLaunchDarklyVariations()),o&&(window.UserLeap.userId=o),i&&(window.UserLeap.partnerAnonymousId=i),a&&(s.eventProperties=a);const p=window.UserLeap.delayingSurvey?await je(we("1",[ze],"events/batch"),{body:JSON.stringify({events:[{event:d,metadata:s}],previewKey:l}),method:"POST"},0,!0):await je(we("1",[ze],"events"),{body:JSON.stringify({event:d,metadata:s,previewKey:l}),method:"POST"},0,!0);if(!p.ok){const C="[Sprig] (ERR-421) Failed to track event";return p.reportError&&(console.warn(C,p.error),p.error&&window.UserLeap.reportError("track",p.error)),{success:!1,message:C,error:p.error,surveyState:"no survey"}}o&&ne("uid",o),i&&ne("aid",i);const f=p.json;return f.invalidPreviewKey&&window.UserLeap.localStorageAvailable&&localStorage.removeItem(ee.Preview),await Yl(p),Vl(f.eventId,m)?vi(f,c):{success:!1,message:"Study should not be displayed after page navigation",surveyState:"no survey"}},n={async displaySurvey(r){return console.warn("[Sprig] displaySurvey should only be used to debug your studies; not intended for production usage."),window.UserLeap("dismissActiveSurvey",xe.Override),Rn({surveyId:r},!0)},_previewSurvey(r){window.UserLeap("dismissActiveSurvey",xe.Override),Rn({surveyTemplateId:r},!1)},_reviewSurvey(r){window.UserLeap("dismissActiveSurvey",xe.Override),Rn({surveyId:r},!1)},previewSurvey(r){n._previewSurvey(r)},reviewSurvey(r){n._reviewSurvey(r)},mute(){window.UserLeap._queue.pause()},unmute(){window.UserLeap._queue.unpause()},setVisitorToken(){console.warn("[Sprig] setVisitorToken is deprecated.")},dismissActiveSurvey(r=xe.API){B.emit(O.SurveyWillClose,{name:O.SurveyWillClose,initiator:r})},async setAttribute(r,o){if(!r||!o&&o!==0){const i="[Sprig] - Disregarding empty attribute / value provided";return console.warn(i),{success:!1,message:i}}return this.setAttributes({[r]:o})},async setAttributes(r){if(r==null||Object.keys(r).length===0){const o="[Sprig] - Disregarding empty attributes provided";return console.warn(o),{success:!1,message:o}}return this.identifyAndSetAttributes({attributes:r})},async identifyAndSetAttributes(r){if(window.UserLeap.debugMode&&console.info("[DEBUG] Sprig identifyAndSetAttributes",r),e.mode==="test")return;if(r===null||typeof r!="object"||!(r.userId||r.anonymousId||r.attributes)){const d="[Sprig] - Disregarding empty payload provided";return console.warn(d),{success:!1,message:d}}const{userId:o,anonymousId:i,attributes:s}=r;if(e.requireUserIdForTracking&&!window.UserLeap.userId&&!o){const d="[Sprig] - Skipping tracking without userId";return console.warn(d),{success:!1,message:d}}if(!s&&(!o||window.UserLeap.userId===o)&&(!i||window.UserLeap.partnerAnonymousId===i))return{success:!0};const a={};o&&(a.userId=window.UserLeap.userId=o),i&&(a.partnerAnonymousId=window.UserLeap.partnerAnonymousId=i);let c;return s?(s.email&&!Object.prototype.hasOwnProperty.call(s,ht)&&(s[ht]=s.email,delete s.email),c=await je(we("1",[Re,ze],"attributes"),{body:JSON.stringify(s),method:"PUT"}),!c.ok&&c.reportError&&(console.warn("[Sprig] (ERR-432) identifyAndSetAttributes failed",c.error),c.error&&window.UserLeap.reportError("identifyAndSetAttributes",c.error))):c=await je(we("1",[Re,ze]),{body:JSON.stringify(a),method:"PUT"}),s&&s[ht]&&(window.UserLeap.email=s[ht]),c.ok&&(o&&ne("uid",o),i&&ne("aid",i)),{success:!!c.ok}},async removeAttributes(r){if(window.UserLeap.debugMode&&console.info("[DEBUG] Sprig removeAttributes",r),e.mode==="test")return;if(r==null||r.length===0){const i="[Sprig] - Disregarding empty attributes provided";return console.warn(i),{success:!1,message:i}}if(e.requireUserIdForTracking&&!window.UserLeap.userId){const i="[Sprig] - Skipping tracking without userId";return console.warn(i),{success:!1,message:i}}const o=await je(we("1",[Re,ze],"attributes"),{body:JSON.stringify({delete:r}),method:"DELETE"});return!o.ok&&o.reportError&&(console.warn("[Sprig] (ERR-433) Remove attributes failed",o.error),o.error&&window.UserLeap.reportError("removeAttributes",o.error)),{success:!!o.ok}},async addSurveyListener(r){B.on(O.SurveyLifeCycle,r)},async removeSurveyListener(r){B.removeListener(O.SurveyLifeCycle,r)},async addListener(r,o){B.on(r,o)},async removeListener(r,o){B.removeListener(r,o)},async removeAllListeners(){B.removeAllListeners()},setVisitorAttribute(r,o){return console.warn("[Sprig] setVisitorAttribute is deprecated. Please use setAttribute"),n.setAttribute(r,o)},async setEmail(r){return n.setAttribute(ht,r)},async setVisitorEmail(r){return console.warn("[Sprig] setVisitorEmail is deprecated. Please use setEmail"),n.setEmail(r)},async setUserId(r){if(window.UserLeap.debugMode&&console.info("[DEBUG] Sprig setUserId",r),r==null){const s=`[Sprig] - Invalid userId ${r}`;return console.warn(s),{success:!1,message:s}}if(e.mode==="test"||r===window.UserLeap.userId)return;window.UserLeap.userId=r;const o=window.UserLeap.visitorId,i=await je(we("1",[Re,ze]),{body:JSON.stringify({userId:r}),method:"PUT"});if(!i.ok){i.reportError&&(console.warn("[Sprig] (ERR-420) Failed to set user id",i.error),i.error&&window.UserLeap.reportError("setUserId",i.error));return}o!==window.UserLeap.visitorId&&sr(),ne("uid",r)},async setPartnerAnonymousId(r){if(window.UserLeap.debugMode&&console.info("[DEBUG] Sprig setPartnerAnonymousId",r),r==null){const o=`[Sprig] - Invalid partnerAnonymousId ${r}`;return console.warn(o),{success:!1,message:o}}return window.UserLeap.partnerAnonymousId=r,ne("aid",r),{success:!0}},async track(r,o,i={},s=void 0){return t({eventName:r,properties:o,metadata:i,showSurveyCallback:s})},async identifyAndTrack(r){return await t(r)},applyStyles(r){if(window.UserLeap.customStyles=r,window.UserLeap.container){const o=window.UserLeap.container.children[0].contentDocument;if(o){const i=o.getElementById(k.CustomStyle);i?i.textContent=r:Bn(o,r,window.UserLeap.styleNonce)}}},setWindowDimensions(r,o){var c,d;const i=typeof r=="string"?parseInt(r,10):r,s=typeof o=="string"?parseInt(o,10):o;if(!isNaN(i)&&!isNaN(s)&&(window.UserLeap.windowDimensions={width:i,height:s}),!window.UserLeap.frameId)return;const a=document.getElementById(window.UserLeap.frameId);!a||(window.UserLeap.useMobileStyling&&((c=window.UserLeap.windowDimensions)!=null&&c.width&&(a.style.width=`${window.UserLeap.windowDimensions.width}px`),(d=window.UserLeap.windowDimensions)!=null&&d.height&&(a.style.maxHeight=`${window.UserLeap.windowDimensions.height-20}px`),a.contentDocument&&(a.style.height=String(Fn(a.contentDocument))+"px")),B.emit(O.SurveyDimensions,{name:O.SurveyDimensions,contentFrameWidth:a.clientWidth,contentFrameHeight:a.clientHeight}))},logoutUser(){window.UserLeap.debugMode&&console.info("[DEBUG] Sprig logout"),window.UserLeap.visitorId=null,window.UserLeap.userId=null,window.UserLeap.partnerAnonymousId=null,window.UserLeap.token=null,window.UserLeap.email=null,window.UserLeap.localStorageAvailable&&(localStorage.removeItem(ee.Credentials),localStorage.removeItem(ee.PageViews)),window.UserLeap._queue.isPaused()&&window.UserLeap._queue.empty(),gi(),sr(),window.UserLeap._queue.unpause()},teardown(){$l(),window.UserLeap("dismissActiveSurvey",xe.API),delete window.UserLeap,delete window.Sprig,delete window._Sprig},integrateOptimizely(r){var i,s;if(!((s=(i=window.UserLeap)==null?void 0:i._config)!=null&&s.optimizelyEnabled)){console.warn("[SPRIG] Optimizely integration is currently not enabled for your product.");return}const o=JSON.parse(r);Nt.setOptimizelyExperiment(o)},importLaunchDarklyData(r){var o,i;if(!((i=(o=window.UserLeap)==null?void 0:o._config)!=null&&i.launchDarklyEnabled)){console.warn("[SPRIG] LaunchDarkly integration is currently not enabled for your product.");return}Un.setLDFlagsVariations(r)}};Object.assign(window.UserLeap,n)};async function Jl(e){const t=at(window.UserLeap);let n=await he(we("1",[Re],"config"),{headers:t});const r="TypeError";if(window.UserLeap.error=n.error,!n.ok&&n.error&&n.error.name===r&&(window.UserLeap._API_URL="https://api.sprig.com",window.UserLeap.reportError("sprigDomainRequest",n.error),n=await he(we("1",[Re],"config"),{headers:t})),!n.ok)return n.reportError&&(console.warn("[Sprig] (ERR-422) Failed to load configuration",n.error),n.error&&window.UserLeap.reportError("applyRemoteConfig",n.error)),$t("Disabled: failed to fetch configuration"),e;const o=n.json;return o!=null&&o.disabled?($t(`Disabled: ${o.disabled}`),{disabled:o.disabled}):Object.assign({},o,e)}async function Xl(e,t,n={}){const r=window.__cfg&&window.__cfg.mode,o=Dn(),i=window.UserLeap.envId,s=window.document.documentElement,a={mode:r,screenWidth:window.screen.width,screenHeight:window.screen.height,clientWidth:s.clientWidth,clientHeight:s.clientHeight,location:window.location.href,language:window.navigator.language,...n},c={action:e,err:{message:t.message,stack:t.stack},meta:a,vid:o,envId:i};(await je(we("1",null,"errors"),{method:"POST",headers:{[fe.Error]:window.btoa(`userleap-${Date.now()}-error`)},body:JSON.stringify(c)},0,!0)).ok||console.warn("[Sprig] (ERR-444) Failed to report error to API",t)}function ec(e={}){const t=new URLSearchParams(window.location.search).get("sprigPreviewKey"),n=zl();window.UserLeap.localStorageAvailable=n,n&&t&&localStorage.setItem(ee.Preview,t),window.UserLeap.UPDATES=Mn;async function r(){if(window.UserLeap.loaded)return;if(window.UserLeap.reportError=Xl,window.UserLeap.loaded=!0,window.UserLeap._config=Object.assign({},e,window.UserLeap.config),window.UserLeap.delayingSurvey=!1,window.UserLeap._config&&typeof window.UserLeap._config=="object")for(const c in window.UserLeap._config)window.UserLeap[c]=window.UserLeap._config[c];if(!window.UserLeap.envId)if(window.UserLeap.appId)window.UserLeap.envId=window.UserLeap.appId;else throw new Error("Missing Environment id");window.UserLeap.debugMode&&console.info("[DEBUG] Sprig debug mode enabled");const o=window.UserLeap.sampleRate;if(o)if(!n)window.UserLeap.debugMode&&console.info("[DEBUG] Sprig cannot sample users without localStorage permissions");else{let c=qe("sampled");if(c===null&&(c=Math.random()<o,ne("sampled",c)),!c)return}else n&&qe("sampled")!==null&&ne("sampled",null);window.UserLeap._API_URL||(window.UserLeap._API_URL="https://api.sprig.com");const i=[...window.UserLeap._queue];window.UserLeap._queue=new Al(window.UserLeap,[]),window.UserLeap._queue.pause();for(let c=0;c<i.length;c++)window.UserLeap._queue.push(i[c]);const s=qe("token");s?(window.UserLeap.token=s,window.UserLeap.visitorId=qe("vid"),window.UserLeap.userId=qe("uid"),window.UserLeap.partnerAnonymousId=qe("aid")):(window.UserLeap.localStorageAvailable&&localStorage.removeItem(ee.Credentials),gi());const a=await Jl(e);gs(window.document,a.maxReplayDurationSeconds,window.UserLeap.replayNonce,window.UserLeap.maxInflightReplayRequests,a.replaySettings),Ql(a),await Zl(a),window.UserLeap._queue.unpause(),B.emit(O.SDKReady),B.emit(O.VisitorIDUpdated,{visitorId:window.UserLeap.visitorId})}document.readyState==="complete"?r():window.attachEvent?window.attachEvent("onload",r):window.addEventListener("load",r,!1)}const tc="sprig-web-view-sdk";let _i;_i={path:`https://cdn.sprig.com/${tc}-v2.23.0.js`},ec(_i)});
